---
Date Range: 2025-04-16 to 2025-04-23
Generated: 2025-04-24T03:40:41.453Z
---

# You wouldn't steal a font

*Source: <https://fedi.rib.gay/notes/a6xqityngfubsz0f>*
*Published: 2025-04-23T19:40:43.000Z*

Please turn on your JavaScript

![](/static-assets/splash.png?1745466042343)Loading...

---

# 14 Advanced Python Features

*Source: <https://blog.edward-li.com/tech/advanced-python-features/>*
*Published: 2025-04-23T11:36:07.000Z*

[

](/)

[

# Edward Li's Blog

](/)

*   [](#)
*   [Blog Home](/)
*   [More Tech Articles](/tech)

* * *

# 14 Advanced Python Features

2025-04-14

[tech](/tech)

[python](/tags/python)

Python is one of the [most widely adopted programming languages](https://survey.stackoverflow.co/2024/technology#most-popular-technologies) in the world. Yet, because of it’s ease and simplicity to just “get _something_ working”, it’s also one of the most underappreciated.

If you search for [`Top 10 Advanced Python Tricks`](https://www.google.com/search?q=Top+10+Advanced+Python+Tricks) on Google or any other search engine, you’ll find tons of blogs or LinkedIn articles going over trivial (but still useful) things like `generators` or `tuples`.

_**However**_, as someone who’s written Python for the past 12 years, I’ve come across a lot of really interesting, underrated, unique, or (as some might say) “un-pythonic” tricks to _really_ level up what Python can do.

That’s why I decided to compile the top 14 of said features alongside examples and additional resources if you want to dive deeper into any of them.

> These tips & tricks were originally featured as part of a 14-day series on X/Twitter between March 1st and March 14th (pi-day, hence why there are 14 topics in the article).
> 
> All X/Twitter links will also be accompanied with a Nitter counterpart. Nitter is a privacy-abiding open source Twitter frontend. Learn more about the project [here](https://github.com/zedeus/nitter).

# Table of Contents

*   [1\. Typing Overloads](#1-typing-overloads)
*   [2\. Keyword-only and Positional-only Arguments](#2-keyword-only-and-positional-only-arguments)
*   [3\. Future Annotations](#3-future-annotations)
*   [4\. Generics](#4-generics)
*   [5\. Protocols](#5-protocols)
*   [6\. Context Managers](#6-context-managers)
*   [7\. Structural Pattern Matching](#7-structural-pattern-matching)
*   [8\. Python Slots](#8-python-slots)
*   [9\. Python Nitpicks](#9-python-nitpicks)
*   [10\. Advanced f-string String Formatting](#10-advanced-f-string-string-formatting)
*   [11\. Cache / lru\_cache](#11-cache--lru_cache)
*   [12\. Python Futures](#12-python-futures)
*   [13\. Proxy Properties](#13-proxy-properties)
*   [14\. Metaclasses](#14-metaclasses)

# 1\. Typing Overloads

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1895937864527192320) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1895937864527192320)**

**`@overload`** is a decorator from Python’s `typing` module that lets you define multiple signatures for the same function. Each overload tells the type checker exactly what types to expect when specific parameters are passed in.

For example, the code below dictates that _only_ `list[str]` can be returned if `mode=split`, and _only_ `str` can be returned if `mode=upper`. (The `Literal` type also forces mode to be either one of `split` or `upper`)

    from typing import Literal, overload
    
    @overload
    def transform(data: str, mode: Literal["split"]) -> list[str]:
        ...
    
    @overload
    def transform(data: str, mode: Literal["upper"]) -> str:
        ...
    
    def transform(data: str, mode: Literal["split", "upper"]) -> list[str] | str:
        if mode == "split":
            return data.split()
        else:
            return data.upper()
    
    split_words = transform("hello world", "split")  # Return type is list[str]
    split_words[0]  # Type checker is happy
    
    upper_words = transform("hello world", "upper")  # Return type is str
    upper_words.lower()  # Type checker is happy
    
    upper_words.append("!")  # Cannot access attribute "append" for "str"
    

Overloads can do more than just change return type based on arguments! In another example, we use typing overloads to ensure that either one of `id` OR `username` are passed in, but _**never both**_.

    @overload
    def get_user(id: int = ..., username: None = None) -> User:
        ...
    
    @overload
    def get_user(id: None = None, username: str = ...) -> User:
        ...
    
    def get_user(id: int | None = None, username: str | None = None) -> User:
        ...
    
    get_user(id=1)  # Works!
    get_user(username="John")  # Works!
    get_user(id=1, username="John")  # No overloads for "get_user" match the provided arguments
    

> The `...` is a special value often used in overloads to indicate that a parameter is optional, but still requires a value.

**✨ Quick bonus trick:** As you probably saw, Python also has support for **String Literals**. These help assert that only specific string values can be passed to a parameter, giving you even more type safety. Think of them like a lightweight form of Enums!

    def set_color(color: Literal["red", "blue", "green"]) -> None:
        ...
    
    set_color("red")
    set_color("blue")
    set_color("green")
    set_color("fuchsia")  # Argument of type "Literal['fuchsia']" cannot be assigned to parameter "color"
    

### Additional Resources

*   [Python Type Hints: How to use `@overload`](https://adamj.eu/tech/2021/05/29/python-type-hints-how-to-use-overload/)
*   [PEP 3124 – Overloading, Generic Functions, Interfaces, and Adaptation](https://peps.python.org/pep-3124/)
*   [Python Docs - Overloads](https://docs.python.org/3/library/typing.html#overload)
*   [PEP 586 – Literal Types](https://peps.python.org/pep-0586/)

# 2\. Keyword-only and Positional-only Arguments

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1896257050147246306) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1896257050147246306)**

By default, both required parameters and optional parameters can be assigned with both positional and keyword syntax. However, what if you _don’t_ want that to happen? **Keyword-only and Positional-only args** let you control that.

    def foo(a, b, /, c, d, *, e, f):
    	#         ^        ^
    	# Ever seen these before?
    	...
    

**`*` (asterisk)** marks keyword-only parameters. Arguments _after_ `*` _must_ be passed as keyword arguments.

    #   KW+POS | KW ONLY
    #       vv | vv
    def foo(a, *, b):
        ...
    
    # == ALLOWED ==
    foo(a=1, b=2)  # All keyword
    foo(1, b=2)  # Half positional, half keyword
    
    # == NOT ALLOWED ==
    foo(1, 2)  # Cannot use positional for keyword-only parameter
    #      ^
    

**`/` (forward slash)** marks positional-only parameters. Arguments _before_ `/` _must_ be passed positionally and cannot be used as keyword arguments.

    # POS ONLY | KW POS
    #       vv | vv
    def bar(a, /, b):
        ...
    
    # == ALLOWED ==
    bar(1, 2)  # All positional
    bar(1, b=2)  # Half positional, half keyword
    
    # == NOT ALLOWED ==
    bar(a=1, b=2)  # Cannot use keyword for positional-only parameter
    #   ^
    

Keyword-only and Positional-only arguments are especially helpful for API developers to enforce how their arguments may be used and passed in.

### Additional Resources

*   [Using Positional-Only And Keyword-Only Arguments in Python](https://thepythoncodingbook.com/2022/12/11/positional-only-and-keyword-only-arguments-in-python/)
*   [Stack Overflow: Why use positional-only parameters in Python 3.8+?](https://stackoverflow.com/questions/58477827/why-use-positional-only-parameters-in-python-3-8)
*   [PEP 3102 – Keyword-Only Arguments](https://peps.python.org/pep-3102/)
*   [PEP 570 – Python Positional-Only Parameters](https://peps.python.org/pep-0570/)

# 3\. Future Annotations

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1896667340777091212) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1896667340777091212)**

A quick history lesson into Python’s typing:

> This is less of a “Python Feature” and more of a history lesson into Python’s type system, and what `from __future__ import annotations` does if you ever encounter it in production code.

_Python’s typing system started off as a hack_. Function annotation syntax was first introduced with [PEP 3107](https://peps.python.org/pep-3107/) back in Python 3.0 as purely an extra way to decorate functions with no actual type-checking functionality.

Proper specifications for type annotations were later added in Python 3.5 through [PEP 484](https://peps.python.org/pep-0484/), but they were designed to be evaluated at bound / definition time. This worked great for simple cases, but it increasingly caused headaches with one type of problem: **forward references**.

This meant that forward references (using a type before it gets defined) required falling back to string literals, making the code less elegant and more error-prone.

    # This won't work
    class Foo:
        def action(self) -> Foo:
            # The `-> Foo` return annotation is evaluated immediately during definition,
            # but the class `Foo` is not yet fully defined at that point,
            # causing a NameError during type checking.
            ...
    

    # This is the workaround -> Using string types
    class Bar:
        def action(self) -> "Bar":
            # Workaround with string literals, but ugly and error-prone
            ...
    

Introduced as a PEP (Python Enhancement Proposal), [PEP 563: Postponed Evaluation of Annotations](https://peps.python.org/pep-0563/) aimed to fix this by changing when type annotations were evaluated. Instead of evaluating annotations at definition time, PEP 563 “_string-ifies_” types behind the scenes and postpones evaluation until they’re actually needed, typically during static analysis. This allows for cleaner forward references without explicitly defining string literals and reduces the runtime overhead of type annotations.

    from __future__ import annotations
    
    class Foo:
        def bar(self) -> Foo:  # Works now!
            ...
    

**So what was the problem?**

For type checkers, this change is largely transparent. But because PEP 563 implements this by essentially treating all types as strings behind the scenes, anything that relies on accessing return types at runtime (i.e., ORMs, serialization libraries, validators, dependency injectors, etc.) will have compatibility issues with the new setup.

That’s why even after ten years after the initial proposal, modern Python (3.13 as of writing this) still relies on the same hacked-together type system introduced in Python 3.5.

    # ===== Regular Python Typing =====
    def foobar() -> int:
        return 1
    
    ret_type = foobar.__annotations__.get("return")
    ret_type
    # Returns: <class 'int'>
    new_int = ret_type()
    

    # ===== With Postponed Evaluation =====
    from __future__ import annotations
    
    def foobar() -> int:
        return 1
    
    ret_type = foobar.__annotations__.get("return")
    ret_type
    # "int" (str)
    new_int = ret_type()  # TypeError: 'str' object is not callable
    

Recently, [PEP 649](https://peps.python.org/pep-0649/) proposes a new method to handle Python function and class annotations through deferred, or “lazy,” evaluation. Instead of evaluating annotations at the time of function or class definition, as is traditionally done, this approach delays their computation until they are actually accessed.

This is achieved by compiling the annotation expressions into a separate function, stored in a special `__annotate__` attribute. When the `__annotations__` attribute is accessed for the first time, this function is invoked to compute and cache the annotations, making them readily available for subsequent accesses.

    # Example code from the PEP 649 proposal
    
    class function:
        # __annotations__ on a function object is already a
        # "data descriptor" in Python, we're just changing
        # what it does
        @property
        def __annotations__(self):
            return self.__annotate__()
    
    # ...
    
    def annotate_foo():
        return {'x': int, 'y': MyType, 'return': float}
    
    def foo(x = 3, y = "abc"):
        ...
    
    foo.__annotate__ = annotate_foo
    
    class MyType:
       ...
    
    foo_y_annotation = foo.__annotations__['y']
    

This deferred evaluation strategy addresses issues like forward references and circular dependencies, as annotations are only evaluated when needed. Moreover, it enhances performance by avoiding the immediate computation of annotations that might not be used, and maintains full semantic information, supporting introspection and runtime type-checking tools.

**✨ Bonus Fact:** Since Python 3.11, Python now supports a “Self” type ([PEP 673](https://peps.python.org/pep-0673/)) that allows for proper typing of methods that return instances of their own class, solving this particular example of self-referential return types.

    from typing import Self
    
    class Foo:
        def bar(self) -> Self:
            ...
    

### Additional Resources

*   [A History Of Annotations](https://peps.python.org/pep-0649/#a-history-of-annotations)
*   [Python, Type Hints, and Future Annotations](https://blog.derlin.ch/python-type-hints-and-future-annotations)
*   [`__future__` — Future Statement Definitions](https://docs.python.org/3/library/__future__.html)
*   [PEP 484 – Type Hints](https://peps.python.org/pep-0484/)
*   [PEP 563 – Postponed Evaluation of Annotations](https://peps.python.org/pep-0563/)
*   [PEP 649 – Deferred Evaluation Of Annotations Using Descriptors](https://peps.python.org/pep-0649/)
*   [PEP 749 – Implementing PEP 649](https://peps.python.org/pep-0749/)

# 4\. Generics

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1896994839516020825) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1896994839516020825)**

Did you know that Python has **Generics**? In fact, [since Python 3.12](https://docs.python.org/3/whatsnew/3.12.html), a newer, sleeker, and sexier syntax for Generics was introduced.

    class KVStore[K: str | int, V]:
        def __init__(self) -> None:
            self.store: dict[K, V] = {}
    
        def get(self, key: K) -> V:
            return self.store[key]
    
        def set(self, key: K, value: V) -> None:
            self.store[key] = value
    
    kv = KVStore[str, int]()
    kv.set("one", 1)
    kv.set("two", 2)
    kv.set("three", 3)
    

Python 3.5 initially introduced Generics through the `TypeVar` syntax. However, [PEP 695](https://peps.python.org/pep-0695/) for Python 3.12 revamped type annotations with native syntax for generics, type aliases, and more.

    # OLD SYNTAX - Python 3.5 to 3.11
    from typing import Generic, TypeVar
    
    UnBounded = TypeVar("UnBounded")
    Bounded = TypeVar("Bounded", bound=int)
    Constrained = TypeVar("Constrained", int, float)
    
    class Foo(Generic[UnBounded, Bounded, Constrained]):
        def __init__(self, x: UnBounded, y: Bounded, z: Constrained) -> None:
            self.x = x
            self.y = y
            self.z = z
    

    # NEW SYNTAX - Python 3.12+
    class Foo[UnBounded, Bounded: int, Constrained: int | float]:
        def __init__(self, x: UnBounded, y: Bounded, z: Constrained) -> None:
            self.x = x
            self.y = y
            self.z = z
    

This change also introduces an even more powerful version of **variadic generics**. Meaning you can have an arbitrary number of type parameters for complex data structures and operations.

    class Tuple[*Ts]:
        def __init__(self, *args: *Ts) -> None:
            self.values = args
    
    # Works with any number of types!
    pair = Tuple[str, int]("hello", 42)
    triple = Tuple[str, int, bool]("world", 100, True)
    

Finally, as part of the 3.12 typing changes, Python also introduced a new concise syntax for type aliases!

    # OLD SYNTAX - Python 3.5 to 3.9
    from typing import NewType
    Vector = NewType("Vector", list[float])
    

    # OLD-ish SYNTAX - Python 3.10 to 3.11
    from typing import TypeAlias
    Vector: TypeAlias = list[float]
    

    # NEW SYNTAX - Python 3.12+
    type Vector = list[float]
    

### Additional Resources

*   [Blog on Python 3.12 Generics](https://arjancodes.com/blog/python-generics-syntax/)
*   [Python 3.12 Preview: Static Typing Improvements](https://realpython.com/python312-typing/)
*   [Python Docs - Generics](https://typing.python.org/en/latest/spec/generics.html)
*   [PEP 695 – Type Parameter Syntax](https://peps.python.org/pep-0695/)

# 5\. Protocols

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1897373856475836829) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1897373856475836829)**

One of Python’s major features (and also major complaints) is its support for [**Duck Typing**](https://realpython.com/duck-typing-python/). There’s a saying that goes:

“If it walks like a duck, swims like a duck, and quacks like a duck, then it probably is a duck.”

However, that raises the question: _How do you **type** duck typing?_

    class Duck:
        def quack(self): print('Quack!')
    
    class Person:
        def quack(self): print("I'm quacking!")
    
    class Dog:
        def bark(self): print('Woof!')
    
    def run_quack(obj):
        obj.quack()
    
    run_quack(Duck())  # Works!
    run_quack(Person())  # Works!
    run_quack(Dog())  # Fails with AttributeError
    

That’s where **Protocols** come in. Protocols (also known as **Structural Subtyping**) are typing classes in Python defining the structure or behavior that classes can follow **without** the use of interfaces or inheritance.

    from typing import Protocol
    
    class Quackable(Protocol):
        def quack(self) -> None:
            ...  # The ellipsis indicates this is just a method signature
    
    class Duck:
        def quack(self): print('Quack!')
    
    class Dog:
        def bark(self): print('Woof!')
    
    def run_quack(obj: Quackable):
        obj.quack()
    
    run_quack(Duck())  # Works!
    run_quack(Dog())  # Fails during TYPE CHECKING (not runtime)
    

In essence, Protocols check what your object _**can**_ do, not what it _**is**_. They simply state that as long as an object implements certain methods or behaviors, it qualifies, regardless of its actual type or inheritance.

**✨ Additional quick tip:** Add the `@runtime_checkable` decorator if you want `isinstance()` checks to work alongside your Protocols!

    @runtime_checkable
    class Drawable(Protocol):
        def draw(self) -> None:
            ...
    

### Additional Resources

*   [Python Protocols: Leveraging Structural Subtyping](https://realpython.com/python-protocol/)
*   [MyPy: Protocols and structural subtyping](https://mypy.readthedocs.io/en/stable/protocols.html)
*   [Python Docs - Protocols](https://typing.python.org/en/latest/spec/protocol.html)
*   [PEP 544 – Protocols: Structural subtyping](https://peps.python.org/pep-0544/)

# 6\. Context Managers

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1897714940297068624) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1897714940297068624)**

**Context Managers** are objects that define the methods: `__enter__()` and `__exit__()`. The `__enter__()` method runs when you enter the `with` block, and the `__exit__()` method runs when you leave it (even if an exception occurs).

**`Contextlib`** simplifies this process by wrapping all that boilerplate code in a single easy-to-use decorator.

    # OLD SYNTAX - Traditional OOP-style context manager
    class retry:
        def __enter__(self):
            print("Entering Context")
    
        def __exit__(self, exc_type, exc_val, exc_tb):
            print("Exiting Context")
    

    # NEW SYNTAX - New contextlib-based context manager
    import contextlib
    
    @contextlib.contextmanager
    def retry():
        print("Entering Context")
        yield
        print("Exiting Context")
    

To create your own, write a function with the `@contextlib.contextmanager` decorator. Add setup code before `yield`, cleanup code after it. Any variables on yield will be passed in as additional context. That’s it.

The `yield` statement instructs the context manager to pause your function and lets content within the `with` block run.

    import contextlib
    
    @contextlib.contextmanager
    def context():
        # Setup code here
        setup()
        yield (...)  # Any variables you want to be passed to the with block
        # Teardown code here
        takedown()
    

Overall, this is a much more concise and readable way of creating and using context managers in Python.

### Additional Resources

*   [Context Managers and Python’s with Statement](https://realpython.com/python-with-statement/)
*   [Python Tips: Context Manager](https://book.pythontips.com/en/latest/context_managers.html)
*   [Python Docs: `contextlib` — Utilities for with-statement contexts](https://docs.python.org/3/library/contextlib.html)

# 7\. Structural Pattern Matching

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1898065958578929801) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1898065958578929801)**

Introduced in [Python 3.10](https://docs.python.org/3/whatsnew/3.10.html), **Structural Pattern Matching** gives Python developers a powerful alternative to traditional conditional logic. At its most basic, the syntax looks like this:

    match value:
        case pattern1:
            # code if value matches pattern1
        case pattern2:
            # code if value matches pattern2
        case _:
            # wildcard case (default)
    

The real power comes with **destructuring**! Match patterns break down complex data structures and extract values in a single step.

    # Destructuring and matching tuples
    match point:
        case (0, 0):
            return "Origin"
        case (0, y):
            return f"Y-axis at {y}"
        case (x, 0):
            return f"X-axis at {x}"
        case (x, y):
            return f"Point at ({x}, {y})"
    

    # Using OR pattern (|) to match multiple patterns
    match day:
        case ("Monday"
              | "Tuesday"
              | "Wednesday"
              | "Thursday"
              | "Friday"):
            return "Weekday"
        case "Saturday" | "Sunday":
            return "Weekend"
    

    # Guard clauses with inline 'if' statements
    match temperature:
        case temp if temp < 0:
            return "Freezing"
        case temp if temp < 20:
            return "Cold"
        case temp if temp < 30:
            return "Warm"
        case _:
            return "Hot"
    

    # Capture entire collections using asterisk (*)
    match numbers:
        case [f]:
            return f"First: {f}"
        case [f, l]:
            return f"First: {f}, Last: {l}"
        case [f, *m, l]:
            return f"First: {f}, Middle: {m}, Last: {l}"
        case []:
            return "Empty list"
    

You can also combine match-case with other Python features like **[walrus operators](https://realpython.com/python-walrus-operator/)** to create even more powerful patterns.

    # Check if a packet is valid or not
    packet: list[int] = [0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07]
    
    match packet:
        case [c1, c2, *data, footer] if (  # Deconstruct packet into header, data, and footer
            (checksum := c1 + c2) == sum(data) and  # Check that the checksum is correct
            len(data) == footer  # Check that the data length is correct
        ):
            print(f"Packet received: {data} (Checksum: {checksum})")
        case [c1, c2, *data]:  # Failure case where structure is correct but checksum is wrong
            print(f"Packet received: {data} (Checksum Failed)")
        case [_, *__]:  # Failure case where packet is too short
            print("Invalid packet length")
        case []:  # Failure case where packet is empty
            print("Empty packet")
        case _:  # Failure case where packet is invalid
            print("Invalid packet")
    

### Additional Resources

*   [Structural Pattern Matching in Python](https://realpython.com/structural-pattern-matching/)
*   [Structural pattern matching in Python 3.10](https://benhoyt.com/writings/python-pattern-matching/)
*   [Good StackOverflow Thread](https://stackoverflow.com/questions/70815197/how-to-do-structural-pattern-matching-in-python-3-10-with-a-type-to-match)
*   [Python Docs: The match statement](https://docs.python.org/3/reference/compound_stmts.html#match)
*   [PEP 634 – Structural Pattern Matching: Specification](https://peps.python.org/pep-0634/)
*   [PEP 636 – Structural Pattern Matching: Tutorial](https://peps.python.org/pep-0636/)

# 8\. Python Slots

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1898596367045640193) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1898596367045640193)**

**Slots** are a way to potentially speed up the creation and access of any Python class.

**TLDR:** They define a fixed set of attributes for classes, optimizing and speeding up accesses during runtime.

    class Person:
        __slots__ = ('name', 'age')
    
        def __init__(self, name, age):
            self.name = name
            self.age = age
    

Under the hood, Python classes store instance attributes in an internal dictionary called `__dict__`, meaning a hash table lookup is required each time you want to access a value.

In contrast, `__slots__` uses an array-like structure where attributes can be looked up in true O(1) time, bringing a minor overall speed bump to Python.

    # Without __slots__
    class FooBar:
        def __init__(self):
            self.a = 1
            self.b = 2
            self.c = 3
    
    f = FooBar()
    print(f.__dict__)  # {'a': 1, 'b': 2, 'c': 3}
    

    # With __slots__
    class FooBar:
        __slots__ = ('a', 'b', 'c')
    
        def __init__(self):
            self.a = 1
            self.b = 2
            self.c = 3
    
    f = FooBar()
    print(f.__dict__)  # AttributeError
    print(f.__slots__)  # ('a', 'b', 'c')
    

There is still debate about whether `__slots__` is worth using, as it complicates class definitions with very marginal or no performance benefits at all. However, it is a useful tool to have in your arsenal if you ever need it.

### Additional Resources

*   [Using Slots - Python Wiki](https://wiki.python.org/moin/UsingSlots)
*   [Don’t forget about `__slots__` in Python!](https://medium.com/@apps.merkurev/dont-forget-about-slots-in-python-c397f414c490)
*   [StackOverflow - Usage of `__slots__`](https://stackoverflow.com/questions/472000/usage-of-slots)

# 9\. Python Nitpicks

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1898934432939290658) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1898934432939290658)**

> This is not a Python “feature” or “tip” per se, but instead a handful of quick syntax tips to really clean up your Python codebase.
> 
> As someone who’s seen a lot of Python code.

## 9.1 For-else statements

If you ever need to check if a for loop completes without a break, **for-else statements** are a great way to accomplish this **without** using a temporary variable.

    # ===== Don't write this =====
    found_server = False  # Keep track of whether we found a server
    for server in servers:
        if server.check_availability():
            primary_server = server
            found_server = True  # Set the flag to True
            break
    if not found_server:
        # Use the backup server if no server was found
        primary_server = backup_server
    
    # Continue execution with whatever server we found
    deploy_application(primary_server)
    

    # ===== Write this instead =====
    for server in servers:
        if server.check_availability():
            primary_server = server
            break
    else:
        # Use the backup server if no server was found
        primary_server = backup_server
    
    # Continue execution with whatever server we found
    deploy_application(primary_server)
    

## 9.2 Walrus Operator

If you need to define and evaluate a variable all in one expression, the **Walrus Operator** (new in Python 3.8 with [PEP 572](https://peps.python.org/pep-0572/)) is a quick way to accomplish just that.

> Walrus operators are really useful for using a value right after checking if it is **`not None`**!

    # ===== Don't write this =====
    response = get_user_input()
    if response:
        print('You pressed:', response)
    else:
        print('You pressed nothing')
    

    # ===== Write this instead =====
    if response := get_user_input():
        print('You pressed:', response)
    else:
        print('You pressed nothing')
    

## 9.3 Short Circuit Evaluation

**Short-circuit Evaluation** is a shortcut for getting the “next available” or “next truthy” value in a list of expressions. It turns out you can simply chain `or` statements!

    # ===== Don't write this =====
    username, full_name, first_name = get_user_info()
    
    if username is not None:
        display_name = username
    elif full_name is not None:
        display_name = full_name
    elif first_name is not None:
        display_name = first_name
    else:
        display_name = "Anonymous"
    

    # ===== Write this instead =====
    username, full_name, first_name = get_user_info()
    
    display_name = username or full_name or first_name or "Anonymous"
    

## 9.4 Operator Chaining

Finally, Python lets you **chain comparison operators** together to shorten up integer range comparisons, making them more readable than the equivalent boolean expressions.

    # ===== Don't write this =====
    if 0 < x and x < 10:
        print("x is between 0 and 10")
    

    # ===== Write this instead =====
    if 0 < x < 10:  # Instead of if 0 < x and x < 10
        print("x is between 0 and 10")
    

### Additional Resources

*   [`for/else` - Python Tips](https://book.pythontips.com/en/latest/for_-_else.html)
*   [The Walrus Operator: Python’s Assignment Expressions](https://realpython.com/python-walrus-operator/)
*   [PEP 572 – Assignment Expressions](https://peps.python.org/pep-0572/)
*   [Using the “or” Boolean Operator in Python](https://realpython.com/python-or-operator/#default-values-for-variables)
*   [Chaining Comparison Operators](https://mathspp.com/blog/pydonts/chaining-comparison-operators)

# 10\. Advanced f-string String Formatting

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1899162302131122430) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1899162302131122430)**

Python’s **f-strings** are no secret by now. Introduced in Python 3.6 with [PEP 498](https://peps.python.org/pep-0498/), they are a better, cleaner, faster, and safer method of interpolating variables, objects, and expressions into strings.

But did you know there is more to f-strings than just inserting variables? There exists a hidden formatting syntax called the **Format Mini-Language** that allows you to have much greater control over string formatting.

    print(f"{' [ Run Status ] ':=^50}")
    print(f"[{time:%H:%M:%S}] Training Run {run_id=} status: {progress:.1%}")
    print(f"Summary: {total_samples:,} samples processed")
    print(f"Accuracy: {accuracy:.4f} | Loss: {loss:#.3g}")
    print(f"Memory: {memory / 1e9:+.2f} GB")
    

**Output:**

    =================== [ Run Status ] ===================
    [11:16:37] Training Run run_id=42 status: 87.4%
    Summary: 12,345,678 samples processed
    Accuracy: 0.9876 | Loss: 0.0123
    Memory: +2.75 GB
    

You can do things like enable debug expressions, apply number formatting (similar to `str.format`), add string padding, format datetime objects, and more! All within f-string format specifiers.

## Regular f-strings

    print(f"Hello {item}!")
    

    Hello World!
    

## Debug Expressions

    print(f"{name=}, {age=}")
    

    name='Claude', age=3
    

## Number Formatting

    print(f"Pi: {pi:.2f}")
    print(f"Avogadro: {avogadro:.2e}")
    print(f"Big Number: {big_num:,}")
    print(f"Hex: {num:#0x}")
    print(f"Number: {num:09}")
    

    Pi: 3.14
    Avogadro: 6.02e+23
    Big Number: 1,000,000
    Hex: 0x1a4
    Number: 000000420
    

## String Padding

    print(f"Left: |{word:<10}|")
    print(f"Right: |{word:>10}|")
    print(f"Center: |{word:^10}|")
    print(f"Center *: |{word:*^10}|")
    

    Left: |Python    |
    Right: |    Python|
    Center: |  Python  |
    Center *: |**Python**|
    

## Date Formatting

    print(f"Date: {now:%Y-%m-%d}")
    print(f"Time: {now:%H:%M:%S}")
    

    Date: 2025-03-10
    Time: 14:30:59
    

## Percentage Formatting

    print(f"Progress: {progress:.1%}")
    

    Progress: 75.0%
    

### Additional Resources

*   [Python’s F-String for String Interpolation and Formatting](https://realpython.com/python-f-strings/)
*   [Python’s Format Mini-Language for Tidy Strings](https://realpython.com/python-format-mini-language/)
*   [Python Docs - Input and Output](https://docs.python.org/3/tutorial/inputoutput.html)
*   [PEP 498 – Literal String Interpolation](https://peps.python.org/pep-0498/)

# 11\. Cache / lru\_cache

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1899571802873135208) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1899571802873135208)**

You can use the built-in **`@cache`** decorator to dramatically speed up recursive functions and expensive calculations! (which superseded `@lru_cache` in Python 3.9!)

    from functools import cache
    
    @cache
    def fib(n):
        return n if n < 2 else fib(n-1) + fib(n-2)
    

Since Python 3.2, `@lru_cache` was introduced as part of the `functools` module for quick & clean function memoization. Starting with Python 3.9, `@cache` was added for the same effect with less code. `lru_cache` still exists if you want explicit control of the cache size.

    FIB_CACHE = {}
    
    # With Manual Caching :(
    def fib(n):
        if n in FIB_CACHE:
            return FIB_CACHE[n]
        if n <= 2:
            return 1
        FIB_CACHE[n] = fib(n - 1) + fib(n - 2)
        return FIB_CACHE[n]
    

    from functools import lru_cache
    
    # Same code with lru_cache :)
    @lru_cache(maxsize=None)
    def fib(n):
        return n if n < 2 else fib(n-1) + fib(n-2)
    

    from functools import cache
    
    # Same code with new Python 3.9's cache :D
    @cache
    def fib(n):
        return n if n < 2 else fib(n-1) + fib(n-2)
    

### Additional Resources

*   [Python Cache: Two Simple Methods](https://www.datacamp.com/tutorial/python-cache-introduction)
*   [(outdated) Caching in Python Using the LRU Cache Strategy](https://realpython.com/lru-cache-python/)
*   [Python Docs - `@functools.cache`](https://docs.python.org/3/library/functools.html#functools.cache)
*   [Python Docs - `@functools.lru_cache`](https://docs.python.org/3/library/functools.html#functools.lru_cache)

# 12\. Python Futures

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1899900763977228374) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1899900763977228374)**

Did you know that Python has native `Promise`\-like concurrency control?

    from concurrent.futures import Future
    
    # Manually create a Future Object
    future = Future()
    
    # Set its result whenever you want
    future.set_result("Hello from the future!")
    
    # Get the result
    print(future.result())  # "Hello from the future!"
    

Python’s **`concurrent.futures`** module gives you direct control over async operations, just like JS Promises. For example, they let you attach callbacks that run when the result is ready (just like JS’s `.then()`).

    from concurrent.futures import Future
    
    future = Future()
    
    # Add callbacks BEFORE or AFTER completion!
    future.add_done_callback(lambda f: print(f"Got: {f.result()}"))
    
    future.set_result("Async result")
    # Prints: "Got: Async result"
    
    future.add_done_callback(lambda f: print(f"After: {f.result()}"))
    # Prints: "After: Async result"
    

Python Futures also come with primitives to handle exceptions, set timeouts, or stop tasks completely.

    from concurrent.futures import Future
    import time, threading
    
    # Create and manage a future manually
    future = Future()
    
    # Background task function
    def background_task():
        time.sleep(2)
        future.set_result("Done!")
    
    thread = threading.Thread(target=background_task)
    thread.daemon = True
    thread.start()
    
    # Try all control operations
    print(f"Cancelled: {future.cancel()}")  # Likely False if started
    
    try:
        # Wait at most 0.5 seconds
        result = future.result(timeout=0.5)
    except TimeoutError:
        print("Timed out!")
    
    # Create failed future
    err_future = Future()
    err_future.set_exception(ValueError("Failed"))
    print(f"Has error: {bool(err_future.exception())}")
    

Just like modern JS, the `asyncio` module has its own Future that works seamlessly with Python’s `async/await` syntax:

    import asyncio
    
    async def main():
        future = asyncio.Future()
    
        # Set result after delay
        asyncio.create_task(set_after_delay(future))
    
        # Await just like a JS Promise!
        result = await future
        print(result)  # "Worth the wait!"
    
    async def set_after_delay(future):
        await asyncio.sleep(1)
        future.set_result("Worth the wait!")
    
    asyncio.run(main())
    

Finally, for CPU or I/O bound tasks, Python’s `ThreadPoolExecutor` can automatically create and manage futures for you.

    from concurrent.futures import ThreadPoolExecutor
    import time
    
    def slow_task():
        time.sleep(1)
        return "Done!"
    
    with ThreadPoolExecutor() as executor:
        # Returns a Future immediately
        future = executor.submit(slow_task)
    
        # Do other work while waiting...
        print("Working...")
    
        # Get result when needed
        print(future.result())
    

### Additional Resources

*   [Introduction to `concurrent.futures` in Python](https://medium.com/@smrati.katiyar/introduction-to-concurrent-futures-in-python-009fe1d4592c)
*   [Adventures in Python with `concurrent.futures`](https://alexwlchan.net/2019/adventures-with-concurrent-futures/)
*   [Python Docs - Futures](https://docs.python.org/3/library/asyncio-future.html)
*   [Python Docs - `concurrent.futures`](https://docs.python.org/3/library/concurrent.futures.html)

# 13\. Proxy Properties

> **[Original X/Twitter Thread](https://x.com/edwardjxli/status/1900316544066007332) | [Nitter Mirror](https://nitter.hydranet.dev/edwardjxli/status/1900316544066007332)**

Did you know you can make class attributes act as **BOTH** methods **AND** properties?!? _This isn’t a built-in feature of Python_, but instead a demonstration of what you can do with clever use of Python’s dunder (magic) methods and descriptors.

> (Note that this is very much an example implementation and should not be used in production)

    from typing import Callable, Generic, TypeVar, ParamSpec, Self
    
    P = ParamSpec("P")
    R = TypeVar("R")
    T = TypeVar("T")
    
    class ProxyProperty(Generic[P, R]):
        func: Callable[P, R]
        instance: object
    
        def __init__(self, func: Callable[P, R]) -> None:
            self.func = func
    
        def __get__(self, instance: object, _=None) -> Self:
            self.instance = instance
            return self
    
        def __call__(self, *args: P.args, **kwargs: P.kwargs) -> R:
            return self.func(self.instance, *args, **kwargs)
    
        def __repr__(self) -> str:
            return self.func(self.instance)
    
    def proxy_property(func: Callable[P, R]) -> ProxyProperty[P, R]:
        return ProxyProperty(func)
    
    class Container:
        @proxy_property
        def value(self, val: int = 5) -> str:
            return f"The value is: {val}"
    
    # Example usage
    c = Container()
    print(c.value)      # Returns: The value is: 5
    print(c.value(7))   # Returns: The value is: 7
    

_How does this work under the hood?_ It comes down to Python’s **[Descriptor Protocol](https://docs.python.org/3/howto/descriptor.html)**:

1.  The `__get__` method transforms the `ProxyProperty` object into a **descriptor**.
    
2.  When you access `c.value`, Python calls `__get__` which returns `self` (the descriptor instance).
    
3.  The `__repr__` method handles property access (returning default values).
    
4.  The `__call__` method handles method calls with parameters.
    

This creates a dual-purpose attribute that can be both read directly AND called like a function!

The benefit of this class is that it allows you to create intuitive APIs where a property might need configuration, or properties that should have sensible defaults but still allow for customization.

> If you want to look at a proper production-ready implementation of **proxy properties**, check out Codegen’s implementation of `ProxyProperty` here: [codegen/src/codegen/sdk/\_proxy.py](https://github.com/codegen-sh/codegen/blob/590ce812c08d973d8f2c22795ab3e5055cea6b1e/src/codegen/sdk/_proxy.py#L5)

### Additional Resources

*   [Python Descriptors: An Introduction](https://realpython.com/python-descriptors/)
*   [Demystifying Python’s Descriptor Protocol](https://deepsource.com/blog/demystifying-python-descriptor-protocol)
*   [Descriptor Guide - Python Wiki](https://docs.python.org/3/howto/descriptor.html)
*   [Proxies and Wrappers](https://wrapt.readthedocs.io/en/latest/wrappers.html)

# 14\. Metaclasses

Finally, introducing one of Python’s most powerful yet mysterious features: **Metaclasses**

    class MyMetaclass(type):
        def __new__(cls, name, bases, namespace):
            # Magic happens here
            return super().__new__(cls, name, bases, namespace)
    
    class MyClass(metaclass=MyMetaclass):
        pass
    
    obj = MyClass()
    

Classes in Python aren’t just blueprints for objects. They’re objects too! And every object needs a class that created it. So what creates class objects? **Metaclasses**.

By default, Python uses the `type` metaclass to create all classes. For example, these two are equivalent to each other:

    # Create a MyClass object
    class MyClass:
        ...
    obj = MyClass()
    
    # Also creates a MyClass object
    obj2 = type("MyClass", (), {})
    

To break down what those arguments mean, here is an example that creates a class with an attribute `x` and a method `say_hi`, that also subclasses off `object`.

    # type(
    #     name,
    #     bases,
    #     attributes
    # )
    CustomClass = type(
        'CustomClass',
        (object,),
        {'x': 5, 'say_hi': lambda self: 'Hello!'}
    )
    
    obj = CustomClass()
    print(obj.x)  # 5
    print(obj.say_hi())  # Hello!
    

In essence, Metaclasses let you customize and modify these arguments during class creation. For example, here is a metaclass that doubles every integer attribute for a class:

    class DoubleAttrMeta(type):
        def __new__(cls, name, bases, namespace):
            new_namespace = {}
            for key, val in namespace.items():
                if isinstance(val, int):
                    val *= 2
                new_namespace[key] = val
            return super().__new__(cls, name, bases, new_namespace)
    
    class MyClass(metaclass=DoubleAttrMeta):
        x = 5
        y = 10
    
    print(MyClass.x)  # 10
    print(MyClass.y)  # 20
    

Here is another example of a metaclass that registers every class created into a registry.

    # ===== Metaclass Solution =====
    class RegisterMeta(type):
        registry = []
        def __new__(mcs, name, bases, attrs):
            cls = super().__new__(mcs, name, bases, attrs)
            mcs.registry.append(cls)
            return cls
    

_The problem is_, decorators could achieve this same goal without the use of black magic (and it’s often cleaner too).

    # ===== Decorator Solution =====
    def register(cls):
        registry.append(cls)
        return cls
    
    @register
    class MyClass:
        pass
    

And that kind of brings to light the biggest problem with metaclasses:

**Almost 100% of the time, you will never need to touch them.**

In your day-to-day development, 99% of your code won’t ever hit a use case where metaclasses could be useful. And of that 1%, 95% of those cases could just be solved with regular decorators, dunder methods, or just plain inheritance.

That’s why there is that one famous Python quote that goes:

Metaclasses are deeper magic than 99% of users should ever worry about. If you wonder whether you need them, you don’t. - Tim Peters

But if you are that 1% which has a unique enough problem that only metaclasses can solve, they are a powerful tool that lets you tinker with the internals of the Python object system.

> **As for some real-world examples of metaclasses:**
> 
> *   Python’s “ABC” implementation uses metaclasses to implement abstract classes.
> *   Python’s “Enum” implementation uses it to create enumeration types.
> *   A bunch of 3rd party libraries like Django, SQLAlchemy, Pydantic, and Pytest use metaclasses for a variety of purposes.

### Additional Resources

*   [Python Metaclasses](https://realpython.com/python-metaclasses/)
*   [What are Python Metaclasses?](https://sentry.io/answers/what-are-Python-metaclasses/)
*   [Demystifying Python Metaclasses](https://medium.com/@miguel.amezola/demystifying-python-metaclasses-understanding-and-harnessing-the-power-of-custom-class-creation-d7dff7b68de8)
*   [Re: The metaclass saga using Python](https://s3.dualstack.us-east-2.amazonaws.com/pythondotorg-assets/media/files/meta-vladimir.txt)

# Fin

**And that’s it folks!** 14 of some of the most interesting & underrated Python features that I’ve encountered in my Python career.

If you’ve made it this far, shoot me a quick message as to which ones you’ve seen before and which ones you haven’t! I’d love to hear from you.

Happy Python-ing, y’all 🐍!

Copyright © 2025 Edward Li | Powered by [Hydra](https://github.com/EdwardJXLi/hugo-theme-hydra) for [Hugo](https://gohugo.io/)

*   [Blogs](/)
*   [Posts](/posts)
*   [Tags](/tags)
*   [Home](https://edward-li.com/)

---

# Does using Rust really make your software safer?

*Source: <https://tweedegolf.nl/en/blog/152/does-using-rust-really-make-your-software-safer>*
*Published: 2025-04-23T12:16:04.000Z*

[.logo-a{fill:#48e070;}](/en "Home")

Rust services

*   [Explore Rust](/en/expertise/rust/explore-rust)
*   [Rust engineering](/en/expertise/rust-engineering)
*   [Rust training](/en/expertise/rust/training)

[Our people](/en/our-people)[Our work](/en/our-work)[Blog](/en/blog)[Contact](/en/contact)

Rust services

*   [Explore Rust](/en/expertise/rust/explore-rust)
*   [Rust engineering](/en/expertise/rust-engineering)
*   [Rust training](/en/expertise/rust/training)

[Our people](/en/our-people)[Our work](/en/our-work)[Blog](/en/blog)[Contact](/en/contact)

April 23, 2025

# Does using Rust really make your software safer?

[](/en/about/29/marc "Marc")

[Marc](/en/about/29/marc)

Systems software engineer

[research](/en/blog/research)[security](/en/blog/security)[why-rust](/en/blog/why-rust)[rust](/en/blog/rust)[c](/en/blog/c)

![Does using Rust really make your software safer?](/images/dns-experiment-main-image-1200.png)

**We keep saying that Rust is how we make software safer. In this blog, we'll tackle a real-world vulnerability, 'rewrite it in Rust', and show you the results of our empirical research, both as a high-level overview and a tech deep-dive.**

## A real-world critical vulnerability

In 2021, a vulnerability was discovered in the [Nucleus](https://www.cisa.gov/news-events/ics-advisories/icsa-21-103-04) _real-time operating system_, sold by Siemens. According to [security researchers](https://www.forescout.com/blog/forescout-and-jsof-disclose-new-dns-vulnerabilities-impacting-millions-of-enterprise-and-consumer-devices/):

> (...) more than **3 billion devices** use this real-time operating system, such as ultrasound machines, storage systems, critical systems for avionics and others.

In other words, this code had [many applications](https://en.wikipedia.org/wiki/Nucleus_RTOS#Products_using_Nucleus_RTOS), including ones where Bad Thingstm must not happen. So what went wrong?

Networked devices running on Nucleus need to deal with domain names such as `tweedegolf.nl` by interacting with a [DNS server](https://en.wikipedia.org/wiki/Domain_Name_System). The vulnerable part in Nucleus that read the responses sent by a DNS server worked fine in the _happy path_ scenario: real responses containing correct information were processed correctly.

But, it is possible to craft phoney "DNS responses" containing intentional "mistakes". Malicious hackers could use this to trick Nucleus into writing to memory locations that it really shouldn't.

With massive consequences: simply by overwriting a few sensitive bits, the attacker could get a device to crash. And remember that any program code _itself_ is also stored somewhere in memory, so a more clever attacker could even try to reprogram a device running Nucleus to do whatever they want.

Now don't worry! Nucleus has been patched, so we can all sleep safe and sound again.

### Why you should care

Except, lightning didn't just strike Nucleus. Four other networking libraries were also found to contain several similar problems. Collectively, these vulnerabilities were christened [NAME:WRECK](https://www.forescout.com/research-labs/namewreck/). This shows that _in general_ there is a problem with how this kind of code was written in the past.

We were informed about this case by our friends from security consultancy firm [Midnight Blue](https://www.midnightblue.nl/). The question they posed us: can you show how Rust would **prevent** this?

This blog will answer that question. In the first half we will provide a high-level answer that does not go into too much technical detail. The second half is aimed at C, C++ and/or Rust programmers and will take a deeper dive into the actual code of Nucleus and how you could write it in modern Rust.

Our claim is indeed that using Rust would have prevented this. This is not just as simple as saying "Rust is memory safe" (although it is). We'll go beyond that! We have performed a little engineering experiment which convinced us that, had modern Rust been used:

1.  Programmers would not have introduced these vulnerabilities.
2.  Any exploit attempt would have resulted in a recoverable error.
3.  The code would have been more thoroughly tested.
4.  Time and money would have been saved.

### Root causes

Why do such mistakes happen? As programmers we are often tempted to focus on details, but conceptually the answer is simple:

*   The tools used to write software don't help prevent mistakes, and in fact make it hard to detect them if they _have_ been made.
*   External input is implicitly trusted instead of being explicitly validated.

Now it's easy to point fingers and say "Ha! Those silly C programmers and their buffer overflows!". But let's not judge _too_ harshly: some of this code was written in greener days before security was in the collective consciousness. Why on earth would a DNS server send botched messages? And when Nucleus was first built in 1993, well, was there even a realistic alternative to C for writing a real-time operating system?

## How does Rust help, _in practice_?

Rust is a [memory-safe](https://en.wikipedia.org/wiki/Memory_safety) language. This means that under most circumstances, it is guaranteed that a program written in Rust will not read from or modify memory that it is not supposed to access.

But for decoding RFC1035-encoded domain names, we hypothesized that, besides automatically giving memory safety, Rust would have two additional advantages:

*   It is a more expressive algorithmic language, which means that an idiomatic Rust solution will contain fewer issues requiring special care than an idiomatic C solution.
*   It's very easy to write unit tests and fuzz tests, which will encourage programmers to more critically examine their code.

### The experiment

We decided to test our hypothesis using ourselves as guinea pigs. First, we wrote a description of RFC1035-style _DNS message_ encoding and presented this to several colleagues as [a programming exercise](https://github.com/tweedegolf/dns-challenge/), with the instructions to spend three to four hours on it. We gave this exercise to two interns and two staff members.

In the meantime, we analysed the `DNS_Unpack_Domain_Name` routine (as listed in the \[Forescout report\]) to build a suite of stress tests that exercise every problem it has. We also wrote a fuzzer that identified some additional common problems in DNS implementations. We kept all of this secret from the participants.

The problem statement was deliberately underspecified: it contained a link to RFC1035, but not a clear instruction to study it. The objective was to simulate a "let's code this on a Friday afternoon" situation with incomplete information, and some time pressure. Conditions in which bugs thrive.

(Just for fun, we also fed the exercise to ChatGPT to see what would happen. But that is a story for another time!)

### Results

Our stress test contained 6 _happy path_ tests (that Nucleus NET passes), and 12 _negative test cases_ that would cause a crash, erroneous result, or trigger an exploitable condition in the original Nucleus NET. Without going into any details, the table below tallies the results for all tests and compares them to the code from Nucleus NET.

A green mark means a passed test: given some input, the program produced a valid result. For the happy path tests this means that the input was decoded successfully; for the stress tests it means the input was rejected.

Orange means a "normal" test failure: the code either rejected a valid input, or decoded something that it should have rejected. Simple bugs, but not enough to lead to an exploit.

Red means the code failed in a more ominous way: for example hitting a run time abort (such as a [`panic!`](https://www.reddit.com/r/rust/comments/9q3jqn/how_is_rust_safe_when_panics_can_happen_out_of/) in Rust), getting stuck in an infinite loop, or writing to memory locations that should not be written to. In short, red means "exploitable".

implementation

happy path

stress tests

Nucleus NET

🟩🟩🟩🟩🟩🟩

🟧🟧🟥🟧🟥🟧🟥🟥🟧🟥🟥🟥

Engineer 1

🟩🟩🟧🟩🟩🟩

🟧🟧🟩🟧🟩🟧🟩🟩🟩🟩🟧🟩

Engineer 2

🟩🟩🟩🟩🟩🟩

🟩🟩🟩🟩🟩🟧🟩🟩🟩🟩🟩🟩

Engineer 3

🟩🟩🟩🟩🟩🟩

🟩🟩🟩🟩🟩🟧🟩🟩🟩🟩🟩🟩

Engineer 4

🟩🟩🟩🟩🟩🟩

🟩🟩🟩🟩🟩🟧🟩🟧🟩🟩🟧🟩

Some observations:

*   All engineers used fuzzing to test for _panic safety_, and as a result, no Rust implementation has a red mark.
*   The seventh stress test made Nucleus NET enter an infinite loop, enough by itself to cause a _denial of service_. Without being told, everyone caught this. Three engineers found it through fuzz-testing.
*   Most observed remaining 'simple bugs' were subtle violations of the RFC1035 specification, such as ignoring a length limit.
*   The sixth stress test was rather pedantic: it checks that a DNS decoder rejects an otherwise reasonable decoding based on a strict interpretation of the word "prior" in RFC1035.
*   In some test cases RFC1035 was not clear on what to do precisely. In those cases there were two reasonable outcomes that would earn a green mark.

### Evaluation

Let's revisit the four claims we made at the beginning:

1.  **Rust is less likely to have vulnerabilities**: Indeed no engineer introduced an arbitrary code execution vulnerability: nobody felt the need to use `unsafe` Rust.
2.  **Any exploit attempt would have resulted in a recoverable error**: All the solutions were [_panic safe_](https://www.reddit.com/r/rust/comments/9q3jqn/how_is_rust_safe_when_panics_can_happen_out_of/), i.e. they would never cause an abnormal termination of the software.
3.  **Rust code is more thoroughly tested**: All engineers wrote unit tests and fuzzed their code within the allotted time. Several engineers discovered a critical error this way.
4.  **Using Rust saves time and money** All these solutions were developed quickly. We've also taken a stab at a _proper_ C implementation (by an experienced C programmer), and even armed with the knowledge we gained through this experiment, it still took at least three times the amount of time to get a _secure_ version. This is not to mention, of course, [the amount of money wasted](https://deepsource.com/blog/exponential-cost-of-fixing-bugs) patching a vulnerability 20 years down the road, or the potential economic and/or social costs that might have resulted if these vulnerabilities had been actively exploited.

These findings will not be surprising to anybody who has written Rust, or who has researched software security. But we hope that these results will help you think about Rust as more than just "that programming language that has more restrictions".

At Tweede golf, we don't just use Rust because it _prevents us_ from making mistakes - we're also using it because it _enables us_ to write safer software, and being quick at the same time.

## The Deeper Dive

We can hear the programmers cry: show me some code! To learn about the Nucleus NET routine, we can of course recommend reading the \[Forescout report\], but we will also briefly illustrate the problem here.

Simplified somewhat, RFC1035 says that a domain name in a DNS message is encoded as a sequence of _labels_, each of which is preceded by a length byte. These labels concatenated together (and interspersed with a `.`) form the human-readable version of a domain name. A zero byte denotes the end of the domain name.

I.e. the domain name `google.com` can be represented as:

\\x06

g

o

o

g

l

e

\\x03

c

o

m

\\x00

A quick-and-dirty **C** function that decodes this format could be written as follows:

    uint8_t *unpack_dns(uint8_t *src) {
        char *buf, *dst;
        int len;
        
        buf = dst = malloc(strlen(src) + 1);
    
        while((len = *src++) != 0) {
            while(len--)
                *dst++ = *src++;
            *dst++ = '.';
        }
    
        dst[-1] = 0;
        return buf;
    }
    

(The above routine is actually inspired by the DNS decoding routine from Nut/OS, also used in embedded devices, which was the part of [yet another collection of vulnerabilities](https://www.forescout.com/research-labs/amnesia33/) in TCP/IP stacks - so this is realistic code!)

Take some time to spot the errors that can cause this routine to write to invalid memory locations. When you're ready...

**Click to reveal the errors:**  

**1.** An attacker can embed null bytes in parts of the "domain" name, making `strlen` report the wrong size and get `malloc` to allocate less memory than is actually needed.  
  
**2.** In the `while` loop, there is no check that `len` does not exceed the capacity of `buf`.  
  
**3.** The `dst[-1] = 0` near the end is problematic too: if `src` points to a null byte, this line will write to a memory location that lies _before_ the memory allocated by `malloc()`.

We leave it as an exercise to the reader to translate this to a Rust function, and observe that it's relatively straight-forward to get a big boost in safety:

    fn unpack_dns(mut src: &[u8]) -> Option<Vec<u8>> { todo!() }
    

The Nucleus NET code was slightly more complex than the above, since it also tried to deal with a _compression scheme_ described in RFC1035: if a length byte has its two upper bits set (i.e., it is `0xC0` or higher), that means that it and the byte following it combine to a 14-bit offset into the DNS message that contains the remainder of a domain name. This allows backward references. For example, assuming that at offset 14Ah in a DNS response we find:

#

14A

14B

14C

14D

14E

14F

150

151

152

153

154

..

\\x01

a

\\x03

n

e

t

\\x00

\\x01

b

\\xC1

\\x4D

Then offset 14Ah encodes `a.net`, and offset 152h encodes `b.net`.

It should be obvious that just blindly accepting any offset that the input contains can easily allow a decoder to access memory that should be out-of-bounds.

We would love to dive into what can go wrong in DNS implementations, but we would be wasting our time: [RFC9267](https://datatracker.ietf.org/doc/rfc9267/), published in 2022, does just that! It is highly readable and contains various examples of mistakes that have occurred in the wild.

We also have some criticisms on RFC1035 itself. For example, the encoding has room for encodings that are clearly useless. As an example, we would prefer if it spelled out clearly that a 14-bit offset is not allowed to jump directly to another offset (i.e "double jumping") or to a null-byte. In some stress tests, we used these useless encodings (since they made Nucleus NET crash in interesting ways), but would have accepted both a correctly decoded domain name, as well as an error condition as a correct answer. It's not even quite clear to us whether a completely empty domain name is a valid encoding or not.

### Vulnerable C code

Here, in all its detail, is the Nucleus NET code (as it was prior to v5.2, which has patched it) as printed in the [Forescout report](https://www.forescout.com/resources/namewreck-breaking-and-fixing-dns-implementations/). We have edited the types for clarity and added some comments:

    int DNS_Unpack_Domain_Name(uint8_t *dst, uint8_t *src, uint8_t *buf_begin) {
        int16_t size;
        int     i, retval = 0;
        uint8_t *savesrc;
    
        savesrc = src;
    
        while(*src) {
            size = *src;
    
            while((size & 0xC0) == 0xC0) {
                if(!retval) {
                    retval = src - savesrc + 2;
                }
    
                src++;
                src = &buf_begin[(size & 0x3F) * 256 + *src];       /* ! */
                size = *src;
            }
    
            src++;
    
            for(i=0; i < (size & 0x3F); i++) {                      /* ! */
                *dst++ = *src++;                                    
            }                                             
    
            *dst++ = '.';                                           
        }
        *(--dst) = 0;                                               /* ! */
        src++;
    
        if(!retval) {
            retval = src - savesrc;
        }
    
        return retval;
    }
    

Let's list some problems:

**The expression `&buf_begin[(size & 0x3F) * 256 + *src];` has multiple problems:**

*   First, it simply accepts whatever offset the input provides and proceeds from that memory location. Whee! 🎢
*   Second, this very same line can make us go to a memory offset already visited, causing the aforementioned infinite loop.
*   Third, in case this line makes `src` point to a memory location containing a null byte, it will be _skipped over_, an empty domain name part will be written for good measure, and the code will bravely soldier on decoding whatever comes next.

**There also two things wrong with the `for`\-loop:**

*   First, like in our example above, there's no bound check at all that the result will fit in the memory pointed to by `dst`, or that it will adhere to the maximum length for domain names specified by RFC1035 (which is 255 bytes).
*   Second, the expression `size & 0x3F` in the condition of the `for` loop only masks the top two bits of the length byte, but doesn't actually check it for validity. So an invalid length indicator like 65 will be read like 1, and we're at the mercy of the input beyond this point.

**If `*src` points to null byte, this has the same bug as our quick-and-dirty implementation above.** In that case `*(--dst) = 0` near the end of the function is likely to write to memory that is reserved for the memory allocation system.

### What this routine can look like in Rust

As an amalgam of all solutions by our engineers, we have come up with the following 'exemplary' solution to the problem:

    pub fn decode_dns_name<'a>(mut input: &'a [u8], mut backlog: &'a [u8]) -> Option<Vec<u8>> {
        let mut result = Vec::with_capacity(256);
    
        loop {
            match usize::from(*input.first()?) {
                0 => break,
    
                prefix @ ..=0x3F if result.len() + prefix <= 255 => {
                    let part;
                    (part, input) = input[1..].split_at_checked(prefix)?;
    
                    result.extend_from_slice(part);
                    result.push(b'.');
                }
    
                0xC0.. => {
                    let (offset_bytes, _) = input.split_first_chunk()?;
                    let offset = u16::from_be_bytes(*offset_bytes) & !0xC000;
    
                    (backlog, input) = backlog.split_at_checked(usize::from(offset))?;
                }
    
                _ => return None,
            }
        }
    
        result.pop()?;
        Some(result)
    }
    

If there are embedded programmers out there who are now foaming at the mouth, laughing at us for _allocating a vector_; It's quite easy to replace `Vec` here with `heapless::Vec<u8, 256>`. Try it! In fact this solution becomes simpler as it will no longer need the `if` guard in the second arm of the `match` expression!

Of course we are biased, but we also think this routine much more clearly expresses what is being done.

(For a Rust implementation actually used in practice, you can also have a look at the [`smoltcp` source code](https://github.com/smoltcp-rs/smoltcp/blob/3988338971a90e813ebdf809f64fde588ce20735/src/wire/dns.rs#L164-L211). The function signature is slightly different, and there are some stylistic differences, but the logical structure is pretty similar.)

## Conclusion

The claims that C-code is memory unsafe, that there is actually harmful memory-unsafe code out there, and that Rust could fix this, are nothing new. There is even proof out there, [straight from big tech](https://security.googleblog.com/2024/09/eliminating-memory-safety-vulnerabilities-Android.html). But we were challenged to do our own experiment, and despite our engineers receiving very limited time and instructions, the resulting Rust code did indeed avoid the memory safety related vulnerabilities. If you want, you can even [try it yourself](https://github.com/tweedegolf/dns-challenge/).

We keep saying that Rust is how we make software safer. Hopefully either the overview or the technical deep-dive gave you some insight into why we keep saying this, and how that works.

(our services)

## Make your software safer with Rust

Get help from the experts!

*   Improve security
*   Lower life-time security costs
*   Reduce time-to-market  
    [Work with us!](https://tweedegolf.nl/en/contact)

[](/en/about/29/marc "Marc")

[Marc](/en/about/29/marc)

Systems software engineer

[marc@tweedegolf.com](mailto:marc@tweedegolf.com)

[research](/en/blog/research)[security](/en/blog/security)[why-rust](/en/blog/why-rust)[rust](/en/blog/rust)[c](/en/blog/c)

## Stay up-to-date

Stay up-to-date with our work and blog posts?

[](https://bsky.app/profile/tweedegolf.bsky.social "Bluesky")[](https://nl.linkedin.com/company/tweede-golf-software-engineering "LinkedIn")[](https://github.com/tweedegolf "GitHub")[](https://fosstodon.org/@tweedegolf "Mastodon")[](https://tweedegolf.nl/feed.xml "RSS")

## Related articles

**April 29, 2022**

### [Introducing Rust in security research](/en/blog/71/introducing-rust-in-security-research)

When iHub's Bernard van Gastel asked us to help them start with Rust, we were somewhat surprised by their bold step but absolutely happy to assist. In this article we'll describe how we went about designing a workshop for the iHub team.

[research](/en/blog/research)[security](/en/blog/security)[rust](/en/blog/rust)

[Read article](/en/blog/71/introducing-rust-in-security-research)

**July 15, 2024**

### [Mix in C with Rust: A taste of C in your Rust](/en/blog/132/a-taste-of-c-in-your-rust)

Can't wait to learn how to call C code from your Rust project after reading my previous posts about [Rust interop in general](https://tweedegolf.nl/en/blog/123/mix-in-rust) and [calling Rust from C](https://tweedegolf.nl/en/blog/124/mix-in-rust-with-c)? Good! If you haven't read those yet, please do, because I'm going to assume you have in this article. We've seen the basics of Rust's FFI, and have experimented with calling Rust from C. Going the other way around, you'll walk into much the same challenges.

[development](/en/blog/development)[interop](/en/blog/interop)[rust](/en/blog/rust)[c](/en/blog/c)

[Read article](/en/blog/132/a-taste-of-c-in-your-rust)

**July 9, 2024**

### [Mix in Rust with C: Delegating FFI definitions to Diplomat](/en/blog/131/mix-in-rust-delegating-ffi-definitions-to-diplomat)

The other day I came across [Diplomat](https://github.com/rust-diplomat/diplomat), an opinionated tool that makes a lot of choices for you. If you've read [my previous post in this series](https://tweedegolf.nl/en/blog/124/mix-in-rust-with-c), you'll have seen that that can be quite valuable. If you haven't read the previous article yet, do so before continuing to read this one, as it'll help you appreciate the concepts in this post, and it introduces the example as well.

[development](/en/blog/development)[interop](/en/blog/interop)[rust](/en/blog/rust)[c](/en/blog/c)

[Read article](/en/blog/131/mix-in-rust-delegating-ffi-definitions-to-diplomat)

[About Tweede golf](/en/about)[Project Pendulum](/en/pendulum)[Open-source work](/en/open-source)[Rust interop guide](/en/interop)[Embedded World 2025](/en/embedded-world)[Privacy statement](/en/privacy)[Terms](https://tweedegolf.nl/images/tweede-golf-general-terms-2-2.pdf)

#### Tweede golf

**Contact**

*   [+31 24 30 10 484](tel:+31243010484)
*   [info@tweedegolf.nl](mailto:info@tweedegolf.nl)

**Adres**

*   Castellastraat 26
*   6512 EX Nijmegen
*   The Netherlands

[](https://bsky.app/profile/tweedegolf.bsky.social "Bluesky")[](https://nl.linkedin.com/company/tweede-golf-software-engineering "LinkedIn")[](https://github.com/tweedegolf "GitHub")[](https://fosstodon.org/@tweedegolf "Mastodon")[](https://tweedegolf.nl/feed.xml "RSS")

**KvK** 09202176

**BTW** NL820951183B01

**IBAN** NL27ABNA0551876433

**© 2025** tweede golf | 4fae49

if (window.location.host === 'tweedegolf.nl') { var \_paq = window.\_paq = window.\_paq || \[\]; \_paq.push(\['setDoNotTrack', true\]); \_paq.push(\['enableLinkTracking'\]); (function () { \_paq.push(\['setTrackerUrl', 'https://matomo.tweede.golf/matomo.php'\]); \_paq.push(\['setSiteId', '1'\]); })(); }

---

# How a 20 year old bug in GTA San Andreas surfaced in Windows 11 24H2

*Source: <https://cookieplmonster.github.io/2025/04/23/gta-san-andreas-win11-24h2-bug/>*
*Published: 2025-04-23T14:47:45.000Z*

 [![Logo image](/assets/img/avatar.jpg) Silent’s Blog](/)

[](#)

*   [About](/about/)
*   [Links](/links/)
*   [Mods & Patches](/mods/)
*   [Portfolio](/portfolio/)
*   [Updates](/updates/)
*   [Search](/search/ "Search")
*   [Categories](/categories/ "Categories")
*   [](# "Toggle Light/Dark Mode")

# How a 20 year old bug in GTA San Andreas surfaced in Windows 11 24H2

April 23, 2025

14 min. to read

*   [Introduction](#introduction)
*   [Investigating the bug](#investigating-the-bug)
    *   [What is broken?](#what-is-broken)
    *   [But why and how?](#but-why-and-how)
*   [Here be dragons – the true root cause](#here-be-dragons--the-true-root-cause)
    *   [Diving deeper](#diving-deeper)
    *   [Whose Stack Is It Anyway?](#whose-stack-is-it-anyway)
    *   [What are the odds this only broke now? Darn Windows 11!](#what-are-the-odds-this-only-broke-now-darn-windows-11)
*   [I want this fixed in my game!](#i-want-this-fixed-in-my-game)
*   [Final word](#final-word)

# Introduction[](#introduction)

On the [SilentPatch GitHub issue tracker](https://github.com/CookiePLMonster/SilentPatch/issues/172), I received a rather specific bug report:

> ### Skimmer airplane doesn’t exist in Windows 11 24H2
> 
> When I upgraded my windows to version 24H2, the Skimmer plane disappear completely from the game. It can’t be spawn using trainer nor it can’t be found anywhere on it’s normal spawn points. I’m using both my modded copy (which is before the update, is completely fine) and vanilla copy with only silentpatch (I tried the 2018, 2020 and the most recent version of silentpatch) and the plane still won’t exist.

If this was the first time I had heard about it, I’d likely consider it dubious and suspect there are more things at play, and it’s not specifically Windows 11 24H2. However, on GTAForums, I’ve been receiving comments about this exact issue since November last year. Some of them said SilentPatch causes this issue, others however stated the same happens on a completely unmodded game:

> Apparently the skimmer cant spawn when playing on Windows 11 24h2 update, hope this bug gets fixed.
> 
> EDIT: So I think I confirmed it, I set up a VM with Windows 11 23h2 and the damn plane spawns fine, and updating that same VM to 24h2 breaks the skimmer, why would a small feature update in 2024 break a random plane in a 2005 game is anyone’s guess.

> After the latest Silent patch update there is no Skimmer in the game and when I try to spawn it with RZL-Trainer or Cheat Menu by Grinch, the game freezes and I have to close it via Task Manager.

> \[…\] I was forced to update to 24H2, and now after the update, I have the same problem with the Skimmer in GTA SA as others. This means that mods or anything else are not causing the issue, the problem appeared after the latest Windows update.

* * *

My home PC is still on Windows 10 22H2, while my work machine is on Windows 11 23H2, and, to no surprise, neither machine reproduced the issue – Skimmer spawned on the water just fine, creating one via script and putting CJ in a driver’s seat worked too.

That said, I also asked a few people who upgraded to 24H2 to test this on their machines and they **all** hit this bug. Attempts to debug “remotely” by giving instructions over the chat didn’t go anywhere, so I set up a 24H2 virtual machine on my own. I copied the game over to the machine, set it up for remote debugging from the host OS, headed to the usual place the Skimmer spawns, and sure enough, it wasn’t there. All other planes and boats still spawned fine, only this one vehicle did not:

[![](/assets/img/posts/sa-win11-24h2-bug/screens/thumb/gta_sa_SqUlKDKCRs.jpg)](/assets/img/posts/sa-win11-24h2-bug/screens/gta_sa_SqUlKDKCRs.jpg)

Skimmer is gone.

[![](/assets/img/posts/sa-win11-24h2-bug/screens/thumb/gta_sa_qnldPBAKRl.jpg)](/assets/img/posts/sa-win11-24h2-bug/screens/gta_sa_qnldPBAKRl.jpg)

Other planes are still here, though.

I then used the script to spawn a Skimmer and put CJ inside it, just to be launched `1.0287648030984853e+0031` = **10.3 nonillion meters**, or **10.3 octillion kilometers**, or **1.087 quadrillion light-years** up in the sky 😆

[![](/assets/img/posts/sa-win11-24h2-bug/screens/thumb/gta_sa_5KOLUPPHLe.jpg)](/assets/img/posts/sa-win11-24h2-bug/screens/gta_sa_5KOLUPPHLe.jpg)

Scientists claim to have discovered a ‘new color’ no one has seen before.

With SilentPatch installed, the game freezes shortly after launching the player up, as the game code gets stuck in a loop. Without SilentPatch, the game doesn’t freeze, but instead, it succumbs to a famous “burn-in effect” known to occur when the camera gets launched into infinity or close to it. Funny enough, you can still kind of make out the shape of the plane even though the animations give up completely to the inaccuracies of the floating point values:

[![](/assets/img/posts/sa-win11-24h2-bug/screens/thumb/gta_sa_GXULFRni6Y.jpg)](/assets/img/posts/sa-win11-24h2-bug/screens/gta_sa_GXULFRni6Y.jpg)

[![](/assets/img/posts/sa-win11-24h2-bug/screens/thumb/gta_sa_qQUqnmyhV6.jpg)](/assets/img/posts/sa-win11-24h2-bug/screens/gta_sa_qQUqnmyhV6.jpg)

# Investigating the bug[](#investigating-the-bug)

## What is broken?[](#what-is-broken)

But, enough messing around; now I knew it was a real bug and I needed to figure out the root cause. At this point it wasn’t possible to say whether the game was at fault, or if I was really dealing with an API bug introduced in 24H2, as looking at how many games have issues with this OS version, it could go either way.

I didn’t have much to go with, but the fact the game froze with SilentPatch installed provided me with a good starting point. Upon entering the seaplane, the game froze in a very small loop in `CPlane::PreRender`, attempting to normalize the rotor blade angle to the 0-360 degree range:

    this->m_fBladeAngle = CTimer::ms_fTimeStep * this->m_fBladeSpeed + this->m_fBladeAngle;
    while (this->m_fBladeAngle > 6.2831855)
    {
      this->m_fBladeAngle = this->m_fBladeAngle - 6.2831855;
    }
    

In the debugged session, `this->m_fBladeSpeed` was `3.73340132e+29`. This value is obviously enormous, big enough to make decrementing the value by `6.2831855` entirely ineffective due to the difference in floating point exponents of these two values.[1](#fn:fp-explanation) But why is the blade speed so ridiculously high? The blade speed is derived from the following formula:

    this->m_fBladeSpeed = (v34 - this->m_fBladeSpeed) * CTimer::ms_fTimeStep / 100.0 + this->m_fBladeSpeed;
    

where `v34` is **proportional to the plane’s altitude**. This matches the initial findings – as mentioned earlier, the “burn-in effect” traditionally happens when the camera is very far away from the map center, or at a great height.

What caused the plane to shoot so high up? There are two possibilities:

1.  The plane spawns high up in the sky already.
2.  The plane spawns at ground level and then shoots up in the next frame.

As for this test, I was spawning the Skimmer myself with a test script, so I could start from the function used in the game’s SCM (script) interpreter, named `CCarCtrl::CreateCarForScript`. This function spawns a vehicle with a specified ID at the provided coordinates, and those come from my test script, so I know they are correct. However, this function transforms the supplied Z coordinate slightly:

    if (posZ <= 100.0)
    {
      posZ = CWorld::FindGroundZForCoord(posX, posY);
    }
    posZ += newVehicle->GetDistanceFromCentreOfMassToBaseOfModel();
    

`CEntity::GetDistanceFromCentreOfMassToBaseOfModel` contains multiple code paths, but the one used in this case simply gets the negated maximum Z value of the model’s bounding box:

    return -CModelInfo::ms_modelInfoPtrs[this->m_wModelIndex]->pColModel->bbox.sup.z;
    

At this point, I expected this value to be incorrect, so I peeked into Skimmer’s bounding box values just to find out that the maximum Z value is indeed corrupted:

    - *(RwBBox**)0x00B2AC48	RwBBox *
      - sup	RwV3d
          x	-5.39924574	float
          y	-6.77431822	float
          z	-4.30747210e+33	float
      - inf	RwV3d
          x	5.42313004	float
          y	4.02343750	float
          z	1.87021971	float
    

If all the components of the bounding box were corrupted, I would have suspected some memory corruption, like another code writing past boundaries and overwriting these values, but it’s specifically `sup.z` that is corrupted that is neither the first nor the last field in the bounding box. Once again, two possibilities came to my mind:

1.  The collision file is read incorrectly and some fields remain uninitialized, or read unrelated data instead of the bounding box? Highly unlikely, but not impossible given that this issue could potentially have been an OS bug.
2.  The bounding box is read correctly, but then it’s updated with an outrageously incorrect value.

A data breakpoint set up at `pColModel` reveals that at the time of the initial setup, the bounding box is correct, and the value of the Z coordinate is completely reasonable:

    - *(RwBBox**)0x00B2AC48	RwBBox *
      - sup	RwV3d
        x	-5.39924574	float
        y	-6.77431822	float
        z	-2.21952772	float
      - inf	RwV3d
        x	5.42313004	float
        y	4.02343750	float
        z	1.87021971	float
    

Turns out, the first time a vehicle with a specific model is spawned, the game sets up the suspension in a function `SetupSuspensionLines`, and updates the Z coordinate of the bounding box to reflect the car’s natural suspension height:

    if (pSuspensionLines[0].p1.z < colModel->bbox.sup.z)
    {
      colModel->bbox.sup.z = pSuspensionLines[0].p1.z;
    }
    

This is where things went wrong first. The suspension lines are computed using a combination of values from `handling.cfg` and the wheel scale parameter coming from `vehicles.ide`:

    for (int i = 0; i < 4; i++)
    {
      CVector posn;
      modelInfo->GetWheelPosn(i, posn);
    
      posn.z += pHandling->fSuspensionUpperLimit;
      colModel->lines[i].p0 = posn;
    
      float wheelScale = i != 0 && i != 2 ? modelInfo->m_frontWheelScale : modelInfo->m_rearWheelScale;
    
      posn.z += pHandling->fSuspensionLowerLimit - pHandling->fSuspensionUpperLimit;
      posn.z -= wheelScale / 2.0;
      colModel->lines[i].p1 = posn;
    }
    

Since I knew `colModel->lines[0].p1` is corrupted, this meant either `pHandling->fSuspensionLowerLimit`, `pHandling->fSuspensionUpperLimit`, or `wheelScale` were bogus. Skimmer’s `handling.cfg` values didn’t seem any different to any other plane in the game, but then I spotted something interesting in `vehicles.ide`. Skimmer’s line looks like this:

    460, 	skimmer,	skimmer, 	plane,		SEAPLANE,	SKIMMER,	null,	ignore,		5,	0,	0
    

Compare this line to any other plane in the game, in this example Rustler:

    476, 	rustler, 	rustler, 	plane, 		RUSTLER, 	RUSTLER,	rustler, ignore,		10,	0,	0,		-1, 0.6, 0.3,		-1
    

The line is shorter and it’s missing the last four parameters, moreover, **two of the missing parameters are the front and rear wheel scale!** This is normal for boats, but Skimmer is **the only** plane to omit these parameters.

Does re-adding those parameters fix the seaplane? Unsurprisingly, it does!

[![](/assets/img/posts/sa-win11-24h2-bug/screens/thumb/gta_sa_3hbE1KfRUe.jpg)](/assets/img/posts/sa-win11-24h2-bug/screens/gta_sa_3hbE1KfRUe.jpg)

## But why and how?[](#but-why-and-how)

I have a likely explanation for why Rockstar made this specific mistake in the data to begin with – in Vice City, Skimmer was defined as a **boat**, and therefore did not have those values defined by design! When in San Andreas they changed Skimmer’s vehicle type to a **plane**, someone forgot to add those now-required extra parameters. Since this game seldom verifies the completeness of its data, this mistake simply slipped under the radar.

Problem solved? Not quite yet, as for SilentPatch, I need to fix it from the code. A peek into the pseudocode of `CFileLoader::LoadVehicleObject` reveals the true nature of this bug: the game assumes all parameters are always present in the definition line and it doesn’t default any but two parameters, nor it checks the return value of `sscanf`, and so in the case of all boats and Skimmer, those parameters remained uninitialized:

    void CFileLoader::LoadVehicleObject(const char* line)
    {
      int objID = -1;
      char modelName[24];
      char texName[24];
      char type[8];
      char handlingID[16];
      char gameName[32];
      char anims[16];
      char vehClass[16];
      int frq;
      int flags;
      int comprules;
      int wheelModelID; // Uninitialized!
      float frontWheelScale, rearWheelScale; // Uninitialized!
      int wheelUpgradeClass = -1; // Funny enough, this one IS initialized
    
      int TxdSlot = CTxdStore::FindTxdSlot("vehicle");
      if (TxdSlot == -1)
      {
        TxdSlot = CTxdStore::AddTxdSlot("vehicle");
      }
      sscanf(line, "%d %s %s %s %s %s %s %s %d %d %x %d %f %f %d", &objID, modelName, texName, type, handlingID,
            gameName, anims, vehClass, &frq, &flags, &comprules, &wheelModelID, &frontWheelScale, &rearWheelScale,
            &wheelUpgradeClass);
    
      // More processing here...
    }
    

Given the symptoms, those uninitialized values must have evaluated to small, valid floating point values all the way until now, whereas with Windows 11 24H2 they got out of hand and tripped the bounding box calculations.

In SilentPatch, the fix is easy – I wrap this call to `sscanf` and provide reasonable defaults for the final four parameters:

    static int (*orgSscanf)(const char* s, const char* format, ...);
    static int sscanf_Defaults(const char* s, const char* format, int* objID, char* modelName, char* texName, char* type,
          char* handlingID, char* gameName, char* anims, char* vehClass, int* frequency, int* flags, int* comprules,
          int* wheelModelID, float* frontWheelSize, float* rearWheelSize, int* wheelUpgradeClass)
    {
      *wheelModelID = -1;
      // Why 0.7 and not 1.0, I'll explain later
      *frontWheelSize = 0.7;
      *rearWheelSize = 0.7;
      *wheelUpgradeClass = -1;
    
      return orgSscanf(s, format, objID, modelName, texName, type, handlingID, gameName, anims, vehClass,
                      frequency, flags, comprules, wheelModelID, frontWheelSize, rearWheelSize, wheelUpgradeClass);
    }
    

[Fixed!](https://github.com/CookiePLMonster/SilentPatch/commit/881aded7237067202025934796cc2313104cba8c) Another compatibility win for the patch.

* * *

If this was a regular bug, I would’ve ended the post right here. However, in the case of this rabbit hole, the discovery of this fix only raised more questions – why did this break only now? What made the game work fine despite of this issue for over twenty years, before a new update to Windows 11 suddenly challenged this status quo?

**Finally, is this somehow caused by a problem in Windows 11 24H2, or is this just an unfortunate coincidence, stars aligning just right?**

# Here be dragons – the true root cause[](#here-be-dragons--the-true-root-cause)

## Diving deeper[](#diving-deeper)

At this point, the working theory was that the uninitialized local variables in `CFileLoader::LoadVehicleObject` happened to have reasonable values until _something_ changed in Windows 11 24H2, and those values became “unreasonable”. What I knew could **not** be the cause was the CRT (and thus, the `sscanf` call) – San Andreas uses a statically compiled CRT, and therefore any OS-level hotfixes wouldn’t apply to it. However, considering the plethora of security enhancements in Windows 11, I couldn’t rule out that one of those enhancements, for example, **Kernel-mode Hardware-enforced Stack Protection**, ends up scrambling the stack in a way the game’s bugged function doesn’t like.

I set up an experiment where I broke into a debugger before a `sscanf` call when parsing Skimmer’s line (vehicle ID 460) specifically, and the observed variable values supported that claim. On my Windows 10 machine, they happened to be both `0.7`:

    frontWheelSize  0x01779f14 {0.699999988}
    rearWheelSize   0x01779f10 {0.699999988}
    

while on the Win11 24H2 VM, they are huge, similar in order of magnitude to the wrong values observed in the bounding box earlier. The stack pointer has also shifted by 4 bytes for some reason, but that is unlikely to be related – and it’s likely caused by some changes to the thread startup boilerplate inside `kernel32.dll`:

    frontWheelSize  0x01779f18 {7.84421263e+33}
    rearWheelSize   0x01779f14 {4.54809690e-38}
    

This got me curious - `0.7` is a bit “too good” of a value to be a result of interpreting random garbage from the stack as a floating point; what’s more likely is that it’s an actual floating point value that was sitting on the stack in exactly the right spot. I then inspected `vehicles.ide` for TopFun – the vehicle defined directly before Skimmer. Sure enough, its wheel scale is `0.7`!

    459,	topfun,		topfun,		car,		TOPFUN,		TOPFUN,		van,	ignore,		1,	0,	0,		-1, 0.7, 0.7,		-1
    

`vehicles.ide` is parsed in order, in a function working similarly to this (pseudocode):

    void CFileLoader::LoadObjectTypes(const char* filename)
    {
      // Open the file...
    
      while ((line = fgets(file)) != NULL)
      {
        // Parse the section indicators...
        switch (section)
        {
          // Different sections...
        case SECTION_CARS:
          LoadVehicleObject(line);
          break;
        }
      }
    }
    

Seems like the code somehow persisted the stale wheel scale values, so Skimmer ends up getting the same wheel scales as Topfun. I set up another experiment to verify this claim:

1.  Set up a breakpoint before `sscanf` again, but this time before Topfun’s line (vehicle ID 459) gets parsed.
2.  Set up write breakpoints on `frontWheelScale` and `rearWheelScale`.
3.  Resume execution until the game gets to parsing the next vehicle definition.

Windows 10 verified my claim – **nothing wrote to these two stack values between the calls to `CFileLoader::LoadVehicleObject`, so the function’s effective behavior was to preserve (albeit, unintentionally) the wheel scale values between the consecutive calls!**

Repeating the same exercise on Windows 11 24H2 triggered the write breakpoint! However, it wasn’t anywhere close to any security feature: the stack values were overwritten by… `LeaveCriticalSection` inside `fgets`:

    >	ntdll.dll!_RtlpAbFindLockEntry@4()	Unknown
     	ntdll.dll!_RtlAbPostRelease@8()	Unknown
     	ntdll.dll!_RtlLeaveCriticalSection@4()	Unknown
     	gta_sa.exe!fgets()	Unknown
    

Seems like a change in Windows 11 24H2 modified the way [Critical Section Objects](https://learn.microsoft.com/en-us/windows/win32/sync/critical-section-objects) work internally, and the new code unlocking the critical section uses more stack space than the old one. I ran one more experiment, comparing the changes to the stack space that happened after `sscanf` inside `LoadVehicleObject`, until the next invocation of this function. Changed values are highlighted in red:

[![](/assets/img/posts/sa-win11-24h2-bug/stack-win10.jpg)](/assets/img/posts/sa-win11-24h2-bug/stack-win10.jpg)

On Windows 10, the stack values didn’t change much between the calls. In fact, you can spot the two values of `0x3F449BA6` = `0.768` (highlighted on the screenshot). They correspond to Landstalker’s wheel scales.

[![](/assets/img/posts/sa-win11-24h2-bug/stack-win11.jpg)](/assets/img/posts/sa-win11-24h2-bug/stack-win11.jpg)

On Windows 11 24H2, more stack space was modified by a new implementation of Critical Sections. The wheel scales are nowhere to be found, as they were overwritten!

This is the exact proof I needed – notice that in the Windows 10 run, some of the local variables are even still visible to the human eye (like the `normal` vehicle class), while in Windows 11, they are completely gone. It’s also worth pointing out that even in Windows 10, **the very next local variable** after the wheel scales has been overwritten by `LeaveCriticalSection`, which means the game was **4 bytes away** from hitting this exact bug years earlier! The luck at display here is insane.

## Whose Stack Is It Anyway?[](#whose-stack-is-it-anyway)

To illustrate why the game got away with this bug for so long, I need to show how the stack changes across calls. Let’s say the stack looks like this after the call to `LoadVehicleObject`. **Emphasis** on the local variables we’re interested in:

return address from `LoadObjectTypes`

local variables of `LoadObjectTypes`…

return address from `LoadVehicleObject`

local variables of `LoadVehicleObject`…

**frontWheelScale**

**rearWheelScale**

more local variables…

The call to `fgets`, and consequently `LeaveCriticalSection`, that follows the call to `LoadVehicleObject`, reuses the stack space previously occupied by that function, as the lifetime of the function stack is limited to the duration of the function itself and once the function is done, this space is up for grabs again. On Windows 10, the stack looked like this once `fgets` and `LeaveCriticalSection` returned:

return address from `LoadObjectTypes`

local variables of `LoadObjectTypes`…

return address from `fgets`

local variables of `fgets`…

return address from `LeaveCriticalSection`

local variables of `LeaveCriticalSection`…

**frontWheelScale**

**rearWheelScale**

more local variables…

Highlighted parts overwrite what used to be the stack space of `LoadVehicleObject`, but notice how it doesn’t reach the area of the stack where the wheel scales resided. In Windows 11 24H2, `LeaveCriticalSection` uses more stack space, so the stack space instead looks more like this:

return address from `LoadObjectTypes`

local variables of `LoadObjectTypes`…

return address from `fgets`

local variables of `fgets`…

return address from `LeaveCriticalSection`

local variables of `LeaveCriticalSection`…

**frontWheelScale is overwritten!**

**rearWheelScale is overwritten!**

more local variables…

Parts of the stack highlighted in red are now also scrambled when in the past they were left intact; those parts include the wheel scales read by the previous call to `LoadVehicleObject`! This in turn exposes the bug caused by those variables being uninitialized, and since `sscanf` can’t read those values from Skimmer’s `vehicles.ide` definition, they are kept as-is in garbage form, and propagate further to the vehicle’s data.

## What are the odds this only broke now? Darn Windows 11![](#what-are-the-odds-this-only-broke-now-darn-windows-11)

I want to make it clear: **all these findings prove that the bug is NOT an issue with Windows 11 24H2, as things like the way the stack is used by internal WinAPI functions are not contractual and they may change at any time, with no prior notice**. The real issue here is the game relying on undefined behavior (uninitialized local variables), and to be honest, I’m shocked that the game didn’t hit this bug on so many OS versions, although as I pointed out earlier, it was extremely close. San Andreas still supported Windows 98, which means it got away with this bug in **at least** a dozen different Windows versions **and** many more releases of Wine!

…or, did it? I found it hard to believe that the game would never hit this issue on any of the many, many platforms it released on, so I looked into the binary files of some other releases. While this bug was **not** fixed in the official 1.01 PC patch, it **was** fixed in the original Xbox release, where a “reasonable default” of `1.0` was added to the code, much like in my fix. This fix was then “inherited” by many future versions of San Andreas, including:

*   Steam 3.0, newsteam, and RGL, as they were all based on the Xbox branch of the code.
*   Any releases from War Drum Studios, including Android, X360, and PS3.
*   The Definitive Edition.

However, unlike Rockstar, I decided to use the wheel scale of `0.7` instead of `1.0` as a default, for multiple reasons:

1.  This is the effective wheel scale Skimmer had on PC (and possibly PS2) until now since that’s the wheel scale of Topfun.
2.  Two other non-boat vehicles that float on water, Sea Sparrow and Vortex, both have a wheel scale of `0.7`.
3.  Many cars in the game have a wheel scale of `0.7`.

# I want this fixed in my game![](#i-want-this-fixed-in-my-game)

The code fix will be included in [the next SilentPatch hotfix](https://github.com/CookiePLMonster/SilentPatch/milestone/3), but for now, you may easily fix it yourself by editing `vehicles.ide`:

1.  In your San Andreas directory, open `data\vehicles.ide` with Notepad.
2.  Scroll down to Skimmer’s line beginning with `460, skimmer`.
3.  Replace the original line with:
    
        460, 	skimmer,	skimmer, 	plane,		SEAPLANE,	SKIMMER,	null,	ignore,		5,	0,	0,		-1, 0.7, 0.7,		-1
        
    
4.  Save the file.

# Final word[](#final-word)

This was the most interesting bug I’ve encountered for a while. I initially had a hard time believing that a bug like this would directly tie to a specific OS release, but I was proven completely wrong. At the end of the day, it was a simple bug in San Andreas and this function should have never worked right, and yet, at least on PC it hid itself for two decades.

This is an interesting lesson in compatibility: even changes to the stack layout of the internal implementations can have compatibility implications if an application is bugged and unintentionally relies on a specific behavior. This is also not the first time I encountered issues like this: regular visitors might remember [Bully: Scholarship Edition](/mods/bully/) which famously broke on Windows 10, for very similar reasons. Just like in this case, Bully should have never worked properly to begin with, but instead, it got away with making incorrect assumptions for years, before changes in Windows 10 finally made it run out of luck.

Yet again, we are reminded to:

*   **Validate your input data** – San Andreas was notoriously bad at this, and ultimately this was the main reason why an incomplete config line remained unnoticed.
*   **Not ignore the compilation warnings** – this code most likely threw a warning in the original code that was either ignored or disabled!

In the end, the GTA players are lucky: in many other games, issues like this would’ve remained unfixed and they’d become a folk legend. Thankfully, GTAs are moddable and well understood, so we can act upon problems like this and ensure the game stays functional for many more years to come.

* * *

1.  In other words, due to the way floating point values are represented, subtracting a small floating point value from a huge floating point value might not change the result at all. [↩](#fnref:fp-explanation)
    

Share

*   [](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcookieplmonster.github.io%2F2025%2F04%2F23%2Fgta-san-andreas-win11-24h2-bug%2F%3Futm_source%3DFacebook%26utm_medium%3Dsocial%26utm_campaign%3DShare%2BButton "Share on Facebook")
*   [](https://x.com/intent/post?text=How+a+20+year+old+bug+in+GTA+San+Andreas+surfaced+in+Windows+11+24H2+%7C+Silent%27s+Blog&url=https%3A%2F%2Fcookieplmonster.github.io%2F2025%2F04%2F23%2Fgta-san-andreas-win11-24h2-bug%2F%3Futm_source%3DTwitter%26utm_medium%3Dsocial%26utm_campaign%3DShare%2BButton "Share on X/Twitter")
*   [](https://www.reddit.com/submit?url=https%3A%2F%2Fcookieplmonster.github.io%2F2025%2F04%2F23%2Fgta-san-andreas-win11-24h2-bug%2F%3Futm_source%3DReddit%26utm_medium%3Dsocial%26utm_campaign%3DShare%2BButton&title=How+a+20+year+old+bug+in+GTA+San+Andreas+surfaced+in+Windows+11+24H2&type=LINK "Share on Reddit")
*   [](https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fcookieplmonster.github.io%2F2025%2F04%2F23%2Fgta-san-andreas-win11-24h2-bug%2F%3Futm_source%3DHacker%2BNews%26utm_medium%3Dsocial%26utm_campaign%3DShare%2BButton&t=How%20a%2020%20year%20old%20bug%20in%20GTA%20San%20Andreas%20surfaced%20in%20Windows%2011%2024H2 "Share on Hacker News")

Category [Articles](/categories/#Articles)

Please enable JavaScript to view comments.

Previous post

[Solving the mystery of Need for Speed: Underground’s Magazine 22 with SilentPatch](/2025/03/12/need-for-speed-underground-magazine-22-silentpatch/)

Powered by [Jekyll](https://jekyllrb.com/) with [Type on Strap](https://github.com/sylhare/Type-on-Strap)

*   [](https://cookieplmonster.github.io/feed.xml "Follow RSS feed")
*   [](mailto:zdanio95@gmail.com "Email")
*   [](https://github.com/CookiePLMonster "Follow on GitHub")
*   [](https://steamcommunity.com/id/CookiePLMonster "Follow on Steam")
*   [](https://x.com/__silent_ "Follow on X/Twitter")
*   [](https://cookieplmonster.bsky.social/ "Follow on Bluesky")
*   [](https://mastodon.gamedev.place/@cookie "Follow on Mastodon")
*   [](https://www.youtube.com/@CookiePLMonster "Follow on YouTube")

*   [Become a patron](https://www.patreon.com/bePatron?u=32437453 "Become a patron")
*   [Become a sponsor](https://github.com/sponsors/CookiePLMonster "Become a sponsor")
*   [Support on Ko-fi](https://ko-fi.com/CookiePLMonster "Support on Ko-fi")
*   [Support via PayPal](https://paypal.me/AdrianZdanowicz/0usd "Support via PayPal")

---

# What is cosh(List(Bool))? Or beyond algebra: analysis of data types

*Source: <https://nikitadanilov.github.io/aodt.html>*
*Published: 2025-04-23T15:13:13.000Z*

\\( \\def\\List{\\operatorname{List}} \\) \\( \\def\\integer{\\operatorname{integer}} \\) \\( \\def\\nat{\\operatorname{nat}} \\) \\( \\def\\Bool{\\operatorname{Bool}} \\) \\( \\def\\Punct{\\operatorname{Punct}} \\) \\( \\def\\BT{\\operatorname{BT}} \\) \\( \\def\\B{\\operatorname{B}} \\) \\( \\def\\T{\\operatorname{T}} \\) \\( \\def\\R{\\operatorname{R}} \\) \\( \\def\\Set{\\operatorname{Set}} \\) \\( \\def\\Bag{\\operatorname{Bag}} \\) \\( \\def\\Ring{\\operatorname{Ring}} \\) \\( \\def\\plug{\\operatorname{plug}} \\) \\( \\def\\Zipper{\\operatorname{Zipper}} \\) \\( \\def\\cosh{\\operatorname{cosh}} \\) \\( \\def\\sinh{\\operatorname{sinh}} \\) \\( \\def\\ch{\\operatorname{ch}} \\) \\( \\def\\sh{\\operatorname{sh}} \\) \\( \\def\\d{\\partial} \\)

What is cosh(List(Bool))? Or beyond algebra: analysis of data types.

There is that curious idea that you can think of a [type](https://en.wikipedia.org/wiki/Data_type) in a programming language as a kind of [algebraic object](https://en.wikipedia.org/wiki/Algebraic_data_type). Take (homogeneous) lists for example. A list of integers is either an empty list (_i.e._, `nil`) or a pair of an integer (the head of the list) and another list (the tail of the list). You can symbolically write this as

$$\\List(\\integer) = 1 + \\integer \\cdot \\List(\\integer)$$

Here \\(1\\) is the _unit type_ with one element, it does not matter what this element is exactly. \\(A + B\\) is a [_disjoint sum_](https://en.wikipedia.org/wiki/Disjoint_union) of \\(A\\) and \\(B\\). It is a [tagged union](https://en.wikipedia.org/wiki/Tagged_union) type, whose values are values of \\(A\\) or \\(B\\) marked as such. \\(A \\cdot B\\) is the [product type](https://en.wikipedia.org/wiki/Product_type). Its values are pairs of values of \\(A\\) and \\(B\\).

The underlying mathematical machinery includes "polynomial functors", "monads", "Lambek's theorem", etc. You can stop digging when you reach "Knaster-Tarski theorem" and "Beck's tripleability condition".   

In general, we have

$$\\List(x) = 1 + x \\cdot \\List(x)$$

In Haskell this is written as

    data List x = Nil | Cons x (List x)

Similarly, a binary tree with values of type \\(x\\) at the nodes can be written as

$$\\BT(x) = 1 + x\\cdot \\BT(x) \\cdot \\BT(x)$$

That is, a binary tree is either empty or a triple of the root, the left sub-tree and the right sub-tree. If we are only interested in the "shapes" of the binary trees we need

$$\\B = \\BT(1) = 1 + \\B^2$$

Nothing too controversial so far. Now, apply some trivial algebra:

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\List(x) &\\;=\\;& 1 + x \\cdot \\List(x) \\\\ \\List(x) - x \\cdot \\List(x) &\\;=\\;& 1 \\\\ \\List(x) \\cdot (1 - x) &\\;=\\;& 1 \\\\ \\List(x) &\\;=\\;& \\frac{1}{1 - x} \\\\ \\List(x) &\\;=\\;& 1 + x + x^2 + x^3 + \\cdots \\end{array}$$

Going from \\(\\List(x) - x \\cdot \\List(x)\\) to \\(\\List(x) \\cdot (1 - x)\\) in the middle step arguably makes _some_ sense: product of sets and types distributes over sum, much like it does for integers. But the rest is difficult to justify or even interpret. What is the difference of types or their infinite series?

The last equation, however, is perfectly valid: an element of \\(\\List(x)\\) is either `nil`, or a singleton element of \\(x\\), or a pair of elements of \\(x\\) or a triple, _etc_. This is somewhat similar to the cavalier methods of eighteenth-century mathematicians like Euler and the Bernoulli brothers, who would boldly go where no series converged before and through a sequence of meaningless intermediate steps arrive to a correct result.

One can apply all kinds of usual algebraic transformations to \\(\\List(x) = (1 - x)^{-1}\\). For example,

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}l@{\\quad}} \\List(a + b) &\\;=\\;& \\frac{1}{1 - a - b} \\\\ &\\;=\\;& \\frac{1}{1 - a}\\cdot\\frac{1}{1 - \\frac{b}{1 - a}} \\\\ &\\;=\\;& \\List(a)\\cdot\\List(\\frac{b}{1 - a}) \\\\ &\\;=\\;& \\List(a)\\cdot\\List(b\\cdot\\List(a)) \\end{array}$$

This corresponds to the regular expressions identity \\((a|b)^\* = a^\*(ba^\*)^\*\\).

Apply the same trick to binary trees:

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}l@{\\quad}} \\BT &\\;=\\;& 1 + \\BT^2 \\cdot x & \\\\ \\BT^2 \\cdot x - \\BT + 1 &\\;=\\;& 0 & \\text{(Solve the quadratic equation.)} \\\\ \\BT &\\;=\\;& \\frac{1\\pm\\sqrt{1-4\\cdot x}}{2\\cdot x} & \\text{(Use binomial theorem)} \\\\ \\sqrt{1-4\\cdot x} &\\;=\\;& \\sum\_{k=0}^\\infty \\binom{\\tfrac12}{k}(-4\\cdot x)^k & \\\\ \\BT(x) &\\;=\\;& 1 + x + 2\\cdot x^2 + 5\\cdot x^3 + 14\\cdot x^4 + 42\\cdot x^5 + \\cdots & \\\\ &\\;=\\;& \\sum\_{n=0}^\\infty C\_n\\cdot x^n, & \\end{array}$$

Where \\(C\_n=\\frac{1}{n+1}\\binom{2\\cdot n}{n}\\)—the \\(n\\)-th [Catalan number](https://en.wikipedia.org/wiki/Catalan_number), that is the number of binary trees with \\(n\\) nodes. To understand the last series we need to decide what \\(n\\cdot x\\) is, where \\(n\\) is a non-negative integer and \\(x\\) is a type. Two natural interpretations are

$$n \\cdot x = x + x + \\cdots = \\sum\_0^{n - 1} x$$

and

$$n \\cdot x = \\{0, \\ldots, n - 1\\} \\cdot x$$

which both mean the same: an element of \\(n\\cdot x\\) is an element of \\(x\\) marked with one of \\(n\\) "branches", and this is the same as a pair \\((i, t)\\) where \\(0 <= i < n\\) and \\(t\\) is an element of \\(x\\).

The final series then shows that a binary tree is either an empty tree (\\(1\\)) or an \\(n\\)-tuple of \\(x\\)-es associated with one of \\(C\_n\\) shapes of binary trees with \\(n\\) nodes. It worked again!

Now, watch carefully. Take simple unmarked binary trees: \\(\\B = \\BT(1) = 1 + \\B^2\\). In this case, we can "calculate" the solution exactly:

$$\\B^2 - \\B + 1 = 0$$

hence

$$\\B = \\frac{1 \\pm \\sqrt{1 - 4}}{2} = \\frac{1}{2} \\pm i\\cdot\\frac{3}{2} = e^{\\pm i\\cdot\\frac{\\pi}{3}}$$

Both solutions are sixth-degree roots of \\(1\\): \\(\\B^6 = 1\\). OK, this is still completely meaningless, right? Yes, but it also means that \\(\\B^7 = \\B\\), which --if correct-- would imply that there is a bijection between the set of all binary trees and the set of all 7-tuples of binary trees. Haha, clearly impossible... Actually, it's a more or less well-known [fact](https://arxiv.org/pdf/math/9405205).

A note is in order. All "sets" and "types" that we talked about so far are at most countably infinite so, of course, there exists a bijection between \\(\\B\\) and \\(\\B^7\\) simply because both of these sets are countable. What is interesting, and what the paper linked to above explicitly establishes, is that there is as they call it "a very explicit" bijection between these sets, that is a "structural" bijection that does not look arbitrarily deep into its argument trees. For example, in a functional programming language, such a bijection can be coded through pattern matching _without_ recursion.

Here is another neat example. A [rose tree](https://en.wikipedia.org/wiki/Rose_tree) is a kind of tree datatype where a node has an arbitrary list of children:

$$\\R(x) = x\\cdot\\List(\\R(x))$$

Substituting \\(\\List(x) = (1 - x)^{-1}\\) we get

$$\\R(x) = \\frac{x}{1 - R(x)}$$

or

$$\\R^2(x) - \\R(x) + x = 0$$

Hence \\(\\R = \\R(1)\\) is defined by the same equation as \\(\\B = \\BT(1)\\): \\(\\R^2 - \\R + 1 = 0\\). So, there must be a bijection between \\(\\R\\) and \\(\\B\\), and of course there is: one of the first things LISP hackers realised in the late 1950s is that an arbitrary tree can be encoded with [cons](https://en.wikipedia.org/wiki/Cons) cells.

Mathematically, this means that instead of "initial algebras" we treat types as "final co-algebras".   

All this is, by the way, is equally applicable to infinite datatypes (that is, streams, branching transition systems, _etc_.)

That was pure algebra, there is nothing "analytical" here. Analysis historically started with the notion of derivative. And sure, you can define and [calculate derivatives](https://www.cs.le.ac.uk/people/ma139/docs/derivative.pdf) of data type constructors like \\(\\List\\) and \\(\\BT\\). These derivatives are generalisations of [zipper](https://en.wikipedia.org/wiki/Zipper_\(data_structure\))\-like structures: they represent "holes" in the data-type, that can be filled by an instance of the type-parameter.

For example, suppose you have a list \\((x\_0, \\ldots, x\_k, \\ldots, x\_{n - 1})\\) of type \\(\\List(x)\\) then a hole is obtained by cutting out the element \\(x\_k\\) that is \\((x\_0, \\ldots, x\_{k-1}, \\blacksquare, x\_{k+1}, \\ldots, x\_{n - 1})\\) and is fully determined by the part of the list to the left of the hole \\((x\_0, \\ldots, x\_{k - 1})\\) and the part to the right \\((x\_{k+1}, \\ldots, x\_{n - 1})\\). Both of these can be arbitrary lists (including empty), so a hole is determined by a pair of lists and we would expect \\(\\d \\List(x) = \\List^2(x)\\). But Euler would have told us this immediately, because \\(\\List(x) = (1 - x)^{-1}\\) hence

$$\\d \\List(x) = \\d (1 - x)^{-1} = (1 - x)^{-2} = \\List^2(x)$$

In general the derivative of a type constructor (of a "function" analytically speaking) \\(T(x)\\) comes with a "very explicit" surjective function

$$\\plug : \\d T(x) \\cdot x \\to T(x)$$

injective on each of its arguments, and has the usual properties of a derivative, among others:

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\d (A + B) &\\;=\\;& \\d A + \\d B \\\\ \\d (A \\cdot B) &\\;=\\;& \\d A \\cdot B + A \\cdot \\d B \\\\ \\d\_x A(B(x)) &\\;=\\;& \\d\_B A(B) \\cdot \\d\_x B(x) \\\\ \\d x &\\;=\\;& 1 \\\\ \\d x^n &\\;=\\;& n\\cdot x^{n-1} \\\\ \\d n &\\;=\\;& 0 \\end{array}$$

For binary trees we get

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\d \\BT(x) &\\;=\\;& \\d (1 + x\\cdot \\BT^2(x)) \\\\ &\\;=\\;& 0 + \\BT^2(x) + 2\\cdot x\\cdot \\BT(x) \\cdot \\d \\BT(x) \\\\ &\\;=\\;& \\BT^2(x) / (1 - 2\\cdot x\\cdot \\BT(x)) \\\\ &\\;=\\;& \\BT^2(x) \\cdot \\List(2\\cdot x\\cdot \\BT(x)) \\\\ &\\;=\\;& \\BT^2(x) \\cdot \\Zipper\_2(x) \\end{array}$$

Here \\(\\Zipper\_2(x) = \\List(2\\cdot x\\cdot \\BT(x))\\) is the [classical Huet's zipper](https://www.st.cs.uni-saarland.de/edu/seminare/2005/advanced-fp/docs/huet-zipper.pdf) for binary trees. We have an additional \\(\\BT^2(x)\\) multiplier, because Huet's zipper plugs an entire sub-tree, that is, it's a \\(\\BT(x)\\)-sized hole, whereas our derivative is an \\(x\\)-sized hole.

For \\(n\\)-ary trees \\(\\T = 1 + x\\cdot \\T^n(x)\\) we similarly have

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\d \\T(x) &\\;=\\;& \\d (1 + x\\cdot \\T^n(x)) \\\\ &\\;=\\;& 0 + \\T^n(x) + n\\cdot x\\cdot \\T^{n-1}(x) \\cdot \\d \\T(x) \\\\ &\\;=\\;& \\T^n(x) / (1 - n\\cdot x\\cdot \\T^{n -1}(x)) \\\\ &\\;=\\;& \\T^n(x) \\cdot \\List(n\\cdot x\\cdot \\T^{n - 1}(x)) \\\\ &\\;=\\;& \\T^n(x) \\cdot \\Zipper\_n(x) \\end{array}$$

At this point we have basic type constructors for arrays (\\(x^n\\)), lists and variously shaped trees, which we can combine and compute their derivatives. We can also try constructors with multiple type parameters (_e.g._, trees with different types at the leaves and internal nodes) and verify that the usual partial-differentiation rules apply. But your inner Euler must be jumping up and down: much more is possible!

Indeed it is. Recall the "[graded](https://en.wikipedia.org/wiki/Graded_structure)" representation of \\(\\List(x)\\):

$$\\List(x) = 1 + x + x^2 + x^3 + \\cdots$$

This formula says that there is one (i.e, \\(|x|^0\\)) list of length \\(0\\), one list (of length \\(1\\)) for each element of \\(x\\), one list for each ordered pair of elements of \\(x\\), for each ordered triple, _etc_. What if we forget the order of \\(n\\)-tuples? Then, by identifying each of the possible \\(n!\\) permutations, we would get, instead of lists with \\(n\\) elements, [multisets](https://en.wikipedia.org/wiki/Multiset) (bags) with \\(n\\) elements.

$$\\Bag(x) = \\frac{1}{0!} + \\frac{x}{1!} + \\frac{x^2}{2!} + \\cdots + \\frac{x^k}{k!} + \\cdots = e^x$$

\[[0](https://link.springer.com/chapter/10.1007/BFb0072514)\] 

Formally we move from polynomial functors to "analytic functors" introduced by A. Joyal.   

This counting argument, taken literally, does not hold water. For one thing, it implies that every term in \\(e^x\\) series is an integer (hint: there are no \\(n!\\) \\(n\\)-tuples belonging to the same class as \\((t, t, \\ldots, t)\\)). But it drives the intuition in the right direction and \\(\\Bag(x)\\) does have the same properties as the exponent. Before we demonstrate this, let's look at another example.

A list of \\(n\\) elements is one of \\(|x|^n\\) \\(n\\)-tuples of elements of \\(x\\). A bag with \\(n\\) elements is one of such tuples, considered up to a permutation. A _set_ with \\(n\\) elements is an \\(n\\)-tuple of _different_ elements considered up to a permutation. Hence, where for lists and bags we have \\(x^n\\), sets have \\(x\\cdot(x - 1)\\cdot\\cdots\\cdot(x - n + 1)\\) by the standard combinatorial argument: there are \\(x\\) options for the first element, \\(x - 1\\) options for the second element and so on.

That is,

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\Set(x) &\\;=\\;& 1 + \\frac{x}{1!} + \\frac{x\\cdot(x - 1)}{2!} + \\frac{x\\cdot(x - 1)\\cdot(x - 2)}{3!} + \\cdots + \\frac{x\\cdot(x - 1)\\cdot\\cdots\\cdot(x - k + 1)}{k!} + \\cdots \\\\ &\\;=\\;& (1 + 1)^x \\;\\;\\;\\;\\text{(By binomial)} \\\\ &\\;=\\;& 2^x \\end{array}$$

OK, we have \\(\\Bag(x) = e^x\\) and \\(\\Set(x) = 2^x\\). The latter makes sense from the cardinality point of view: there are \\(2^x\\) subsets of set \\(x\\) (even when \\(x\\) is infinite). Moreover, both \\(\\Set\\) and \\(\\Bag\\) satisfy the basic exponential identity \\(\\alpha^{x + y} = \\alpha^x\\cdot\\alpha^y\\). Indeed a bag of integers and Booleans can be uniquely and unambiguously separated into the bag of integers and the bag of Booleans, that can be poured back together to produce the original bag, and the same for sets. This does not work for lists: you can separate a list of integers and Booleans into two lists, but there is no way to restore the original list from the parts. This provides a roundabout argument, if you ever need one, that function \\((1 - x)^{-1}\\) does not have form \\(\\alpha^x\\) for any \\(\\alpha\\).

Next, \\(\\alpha^x\\) is the type of functions from \\(x\\) to \\(\\alpha\\), \\(\\alpha^x = \[x \\to \\alpha\]\\). For sets this means that an element of \\(\\Set(x)\\), say \\(U\\), can be thought of as the [characteristic function](https://en.wikipedia.org/wiki/Indicator_function) \\(U : x \\to \\{0, 1\\}\\)

$$U(t) = \\begin{cases} 1, & t \\in U,\\\\ 0, & t \\notin U. \\end{cases}$$

For \\(\\Bag(x)\\) we want to identify a bag \\(V\\) with a function \\(V : x \\to e\\). What is \\(e\\)? By an easy sleight of hand we get:

$$e = e^1 = \\Bag(1) = \\{ 0, 1, \\ldots \\} = \\nat$$

(Because for the one-element unit type \\(1\\), a bag from \\(\\Bag(1)\\) is fully determined by the (non-negative) number of times the only element of \\(1\\) is present in the bag.)

Hence, we have \\(\\Bag(x) = \\nat^x = \[x \\to \\nat\]\\), which looks surprisingly reasonable: a bag of \\(x\\)-es can be identified with the function that for each element of \\(x\\) gives the number of occurrences of this element in the bag. (Finite) bags are technically "[free commutative monoids](https://en.wikipedia.org/wiki/Free_monoid#The_free_commutative_monoid)" generated by \\(x\\).

Moreover, the most famous property of \\(e^x\\) is that it is its own derivative, so we would expect

$$\\d \\Bag(x) = \\Bag(x)$$

And it is: if you take a bag and make a hole in it, by removing one of its elements, you get nothing more and nothing less than another bag. The "plug" function \\(\\plug : \\Bag(x)\\cdot x \\to \\Bag(x)\\) is just multiset union:

$$\\plug (V, t) = V \\cup \\{t\\},$$

which is clearly "very explicit" and possesses the required properties of injectivity and surjectivity. This works neither for lists, trees and arrays (because you have to specify where the new element is to be added) nor for sets (because if you add an element already in the set, the plug-map is not injective).

The central rôle of \\(e^x\\) in analysis indicates that perhaps it is multiset, rather than list, that is the most important datastructure.

If we try to calculate the derivative of \\(\\Set(x)\\) we would get \\(\\d\\Set(x) = \\d(2^x) = \\d e^{\\ln(2)\\cdot x} = \\ln(2)\\cdot 2^x = \\ln(2)\\cdot\\Set(x)\\), of which we cannot make much sense (yet!), but we can calculate

$$\\Bag(\\d\\Set(x)) = e^{\\d\\Set(x)} = e^{\\ln(2)\\cdot\\Set(x)} = 2^{Set(x)} = \\Set(\\Set(x))$$

Nice. Whatever the derivative of \\(\\Set(x)\\) is, a bag of them is a set of sets of \\(x\\).

Thinking about a type constructor \\(T(x) = \\sum\_{i>0} a\_i\\cdot x^i\\) as an non-empty (\\(i > 0\\)) container, we can consider its [pointed](https://en.wikipedia.org/wiki/Pointed_set) version, where a particular element in the container is marked:

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\Punct(T(x)) &\\;=\\;& \\sum\_{i>0} i\\cdot a\_i\\cdot x^i \\\\ &\\;=\\;& x\\cdot \\sum\_{i>0} i\\cdot a\_i\\cdot x^{i-1} \\\\ &\\;=\\;& x\\cdot \\sum\_{i>0} a\_i\\cdot \\d x^i \\\\ &\\;=\\;& x\\cdot \\d \\sum\_{i>0} a\_i\\cdot x^i \\\\ &\\;=\\;& x\\cdot \\d T(x) \\end{array}$$

This has clear intuitive explanation: if you cut a hole in a container and kept the removed element aside, you, in effect, marked the removed element.

When I first studied these functions long time ago, they used to be called \\(\\sh\\) and \\(\\ch\\), pronounced roughly "shine" and "coshine". The inexorable march of progress...   

The next logical step is to try to recall as many Taylor expansions as one can to see what types they correspond to. Start with the easy ones: hyperbolic functions

$$\\cosh(x) = 1 + \\frac{x^2}{2!} + \\frac{x^4}{4!} + \\cdots$$

and

$$\\sinh(x) = x + \\frac{x^3}{3!} + \\frac{x^5}{5!} + \\cdots$$

\\(\\cosh(x)\\) is the type of bags of \\(x\\) with an even number of elements and \\(\\sinh(x)\\) is the type of bags of \\(x\\) with an odd number of elements. Of course, \\(\\cosh\\) and \\(\\sinh\\) happen to be [an even and an odd function](https://en.wikipedia.org/wiki/Even_and_odd_functions) respectively. So to answer the question in the title: \\(\\cosh(\\List(\\Bool))\\) is the type of bags of even number of lists of Booleans. It is easy to check that all usual hyperbolic trigonometry identities hold.

We can also write down a general function type \\(\[ x \\to (1 + y) \]\\):

$$\[ x \\to (1 + y) \] = (1 + y)^x = 1 + y\\cdot x + y^2\\cdot\\frac{x\\cdot(x - 1)}{2!} + y^3\\cdot\\frac{x\\cdot(x-1)\\cdot(x-2)}{3!} + \\cdots$$

Combinatorial interpretation(s) (there are at least two of them!) are left to the curious reader.

We have by now seen the series with the terms of the form \\(n\_k\\cdot x^k\\) (\\(n\_k \\in \\nat\\)) corresponding to various tree-list types, the series with the terms \\(n\_k\\cdot\\frac{x^k}{k!}\\) corresponding to function-exponent types. What about "logarithm"-like series with terms of the form \\(n\_k\\cdot\\frac{x^k}{k}\\)? Similarly to the exponential case, we try to interpret them as types where groups of \\(n\\) \\(n\\)-tuples are identified. The obvious candidates for such groups are all possible _rotations_ of an \\(n\\)-tuple. The learned name for \\(n\\)-tuples identified up to a rotation is "an (aperiodic) [necklace](https://en.wikipedia.org/wiki/Necklace_\(combinatorics\)#Aperiodic_necklaces)", we will call it a ring. The type of non-empty rings of elements of \\(x\\) is given by

$$\\Ring(x) = x + \\frac{x^2}{2} + \\frac{x^3}{3} + \\cdots$$

Compare with:

$$\\begin{array}{r@{\\;}c@{\\;}l@{\\quad}} \\ln(1 + x) &\\;=\\;& x - \\frac{x^2}{2} + \\frac{x^3}{3} - \\frac{x^4}{4} + \\cdots \\\\ \\ln(1 - x) &\\;=\\;& - x - \\frac{x^2}{2} - \\frac{x^3}{3} - \\frac{x^4}{4} - \\cdots \\\\ - \\ln(1 - x) &\\;=\\;& x + \\frac{x^2}{2} + \\frac{x^3}{3} + \\frac{x^4}{4} + \\cdots \\\\ &\\;=\\;& \\Ring(x) \\end{array}$$

Now comes the cool part:

$$\\Bag(\\Ring(x)) = e^{\\Ring(x)} = e^{- \\ln(1 - x)} = (1 - x)^{-1} = \\List(x)$$

We are led to believe that for any type there is a "very explicit" bijection between bags of rings and lists. That is, it is possible to decompose any list to a multiset of rings (containing the same elements, because _nothing_ about \\(x\\) is given) in such a way that the original list can be unambiguously recovered from the multiset.

Sounds pretty far-fetched? It is called [Chen–Fox–Lyndon theorem](https://en.wikipedia.org/wiki/Monoid_factorisation#Chen%E2%80%93Fox%E2%80%93Lyndon_theorem), by the way. This theorem has a curious history. The most accessible exposition is in De Bruijn, Klarner, [Multisets of aperiodic cycles](https://pure.tue.nl/ws/files/1674487/597568.pdf) (1982). The "[Lyndon words](https://en.wikipedia.org/wiki/Lyndon_word)" term is after Lyndon, [On Burnside's Problem](https://www.ams.org/journals/tran/1954-077-02/S0002-9947-1954-0064049-X/S0002-9947-1954-0064049-X.pdf) (1954). The original result is in Ширшов, [Подалгебры свободных лиевых алгебр](https://www.mathnet.ru/links/b8bccc0594081ab6fad538ff3448ac8f/sm5381.pdf) (1953), where it is used to estimate dimensions of sub-algebras of free Lie algebras. See also I.57 (p. 85) in [Analytic Combinatorics](https://algo.inria.fr/flajolet/Publications/book.pdf) by Flajolet and Sedgewick.

If you are still not convinced that \\(\\Ring(x) = -\\ln(1 - x)\\), consider

$$\\d\\Ring(x) = -\\d\\ln(1 - x) = (1 - x)^{-1} = \\List(x)$$

If you cut a hole in a ring, you get a list!

We still have no interpretation for alternating series like \\(\\ln(1 + x) = x - x^2/2 + x^3/3 - x^4/4 + \\cdots\\). Fortunately, our good old friend \\(\\List(x) = (1 - x)^{-1}\\) gives us

$$\\List(2) = -1$$

which, together with the [inclusion–exclusion principle](https://en.wikipedia.org/wiki/Inclusion%E2%80%93exclusion_principle), can be used to concoct plausibly looking explanations of types like \\(\\sin(x) = x - x^3/3! + x^5/5! + \\cdots\\), _etc_.

Of course, (almost) all here can be made formal and rigorous. Types under \\(+\\) and \\(\\cdot\\) form a [semiring](https://en.wikipedia.org/wiki/Semiring). The additive structure can be extended to an abelian group by the [Grothendieck group](https://en.wikipedia.org/wiki/Grothendieck_group) construction. The [field of fractions](https://en.wikipedia.org/wiki/Field_of_fractions) can be built. [Puiseux](https://en.wikipedia.org/wiki/Puiseux_series) and [Levi-Civita](https://en.wikipedia.org/wiki/Levi-Civita_field) series in this field provide "analysis" without the baggage of limits and topology.

But they definitely had more fun back in the eighteenth century. Can we, instead of talking about "[fibre bundles](https://en.wikipedia.org/wiki/Fiber_bundle) over \\(\\Ring(\\lambda t.t\\cdot x)\\)", dream of Möbius strips of streams?

< [blog](series_blog.html) >   < [timeline](series_timeline.html) >

---

# Nine Reasons to Use OSH

*Source: <https://oils.pub/osh.html>*
*Published: 2025-04-22T20:47:37.000Z*

[Why Sponsor Oils?](/why-sponsor.html) | [oils.pub](/)

# Nine Reasons to Use OSH

body { font-family: sans-serif; } p, h2, h3 { text-align: center; } h2, h3 { padding-top: 3em; padding-bottom: 1em; } ul { margin: 0 auto; width: 75%; } table { margin: 0 auto; width: 75%; } .table-text { text-align: center; } .number { color: grey }

OSH is part of the [Oils](/) project.

It's a modern, compatible implementation of Unix shell.

It's focused on **scripting**, and has interactive features.

Why use it?

Table of Contents

[If You Know Shell ...](#if-you-know-shell)

[(1)  It Runs Existing Shell Scripts](#1-it-runs-existing-shell-scripts)

[(2)  You Get Precise Error Messages](#2-you-get-precise-error-messages)

[(3)  Learn and Debug with Pretty Printing](#3-learn-and-debug-with-pretty-printing)

[(4)  Strict Mode Improves Shell Scripts](#4-strict-mode-improves-shell-scripts)

[(5)  More Features of the Oils Runtime](#5-more-features-of-the-oils-runtime)

[If You Build Systems ...](#if-you-build-systems)

[(6)  OSH is Small, With Few Dependencies](#6-osh-is-small-with-few-dependencies)

[(7)  You Can Build a GUI on Top Of It](#7-you-can-build-a-gui-on-top-of-it)

[More Reasons](#more-reasons)

[(8)  You Can Upgrade to YSH](#8-you-can-upgrade-to-ysh)

[(9)  You Can Contribute](#9-you-can-contribute)

[Links](#links)

## If You Know Shell ...

### (1)  It Runs Existing Shell Scripts

POSIX Shell

    name=world
    echo "hello $name"  # => hello world
    

And Bash

    if [[ name =~ ^A.*Z$ ]]; then
      echo matched
    fi
    

Run `osh myscript.sh`, or change the `#!` line

For **nine years**, OSH has become more and more compatible!

(If you don't want a compatible shell, you may like [YSH](ysh.html))

### (2)  You Get Precise Error Messages

Other shells don't point to the error token:

      echo "hello $nme"
                  ^~~~  # precise!
    example.sh:3: fatal: Undefined variable 'nme'
    

### (3)  Learn and Debug with Pretty Printing

What's inside this string?

![](image/pretty-print-string.png)

What's inside this bash data structure?

![](image/pretty-print-assoc.png)

Use the `=` keyword to find out

It helps you learn what shell does, and what your programs do

### (4)  Strict Mode Improves Shell Scripts

Opt in to this mode to avoid code with mistakes:

    shopt --set strict:all  # Enable more than a dozen checks
    

An error that's flagged:

        if shell-func; then
        ^~
    demo/home-page.sh:9: errexit was disabled for this construct
    
        if shell-func; then
           ^~~~~~~~~~
    demo/home-page.sh:9: fatal: Can't run functions or procs while errexit is disabled (OILS-ERR-301)
    

`OILS-ERR-301` is a section in the [Oils Error Catalog](//oils.pub/release/latest/doc/error-catalog.html#OILS-ERR-301), which suggests ways to improve your code

With strict mode, your scripts **still run** under other shells

(Strict mode is complementary to [ShellCheck](https://www.shellcheck.net/))

### (5)  More Features of the Oils Runtime

OSH and [YSH](ysh.html) live in the same `oils-for-unix` binary

We are polishing:

*   The small OSH Standard Library, with
    *   **Task files** - automate everything, remember what you learned
    *   **Test Framework** - test code written in _other_ languages, not just shell!
*   Tracing and Profiling
*   The Interactive Shell

(in progress)

## If You Build Systems ...

### (6)  OSH is Small, With Few Dependencies

To build it, you need only a C++ compiler and ~30 seconds

To run it, you need only a POSIX system! And ~2MB of disk space

Optional dependencies [are documented](//oils.pub/release/latest/doc/portability.html) (GNU readline, libc extensions, ...)

### (7)  You Can Build a GUI on Top Of It

We created a [headless shell protocol](https://www.oilshell.org/blog/2023/12/screencasts.html#headless-protocol-oils-web_shell) to **divorce** the shell and the terminal

We'd like others to be creative with it!

## More Reasons

### (8)  You Can Upgrade to [YSH](ysh.html)

YSH is the ultimate glue language

It's like shell + Python + JSON + YAML, put together seamlessly

It's for one machine, or many machines (the cloud)

    shopt --set ysh:upgrade  # One line to start using YSH!
    
    echo hi
    

(It's also valid to use OSH forever!)

### (9)  You Can Contribute

*   If you know Python, you can add features and fix bugs, according to your needs
*   Our code [is small](https://www.oilshell.org/blog/2024/09/line-counts.html), because it's written in high-level DSLs
    *   It's statically typed, via [MyPy](https://mypy-lang.org)
*   OSH is faster than shells written in C on [many benchmarks](//oils.pub/release/latest/quality.html)
    *   It's also memory-safe

## Links

[Latest Release](https://oils.pub/release/latest/) and [Published Docs](https://oils.pub/release/latest/doc/published.html)

Oils Reference > [OSH Table of Contents](https://oils.pub/release/latest/doc/ref/toc-osh.html)

Ask Questions on [Zulip](https://oilshell.zulipchat.com/) or [Github](https://github.com/oils-for-unix/oils)

---

# MinC - OpenBSD-flavored cygwin-alike for running UNIX-y things on Windows

*Source: <https://minc.commandlinerevolution.nl/english/home.html>*
*Published: 2025-04-23T19:55:55.000Z*

# MinC Is Not Cygwin

[nederlands](../index.html) | **english** | [screenshots](../english/screen-shots.html) | [source](../source/)

Welcome to the MinC home page. MinC is a Unix emulator for Windows, based on the OpenBSD operating system. MinC was written to help children at vocational education learn Linux without the hassle of virtualization. It runs on all versions of Windows, except Win95 and Win98.

MinC is a tiny kernel which runs on Windows. The rest of the software was taken verbatim from OpenBSD, version 6.1. This means that by installing MinC, you run OpenBSD on your Windows machine at native speed.

![Puffy, the OpenBSD mascotte](../_images/ppuf1000X907_small.png "Puffy")

## Install

To install MinC you no longer have to copy it "by hand". You can now use the new installation wizard. Download the current version by clicking the link: [minc-6.1.exe](../minc-6.1.exe) (20Mb).

![](../_images/Installer-1.0_10.png)

After installation you will see a new icon called **Console** on your Desktop. This starts the MinC terminal.

## Use

The current MinC realease contains the following functions:

*   All Unix standard commands, like: ls, du, ps, df, find, grep, awk, mkdir, chmod, chown, wc, top, diff, etc.
*   Editing: less, vi, nano, hexedit
*   Compression: unzip, gzip, bzip2, xz
*   Networking: route, ifconfig, ping, ftp, ssh, scp, telnet, wget, curl, lynx, mutt, BitchX
*   Development: vim, git, ImageMagick

Services and daemons, like Apache (httpd), Sendmail and sshd are not yet available, but will be released as soon as possible.

If you like to compile code for MinC, you can install the toolchain: [buildtools-6.1.exe](../buildtools-6.1.exe) The package contains BSD libc, GNU binutils, GNU cc, GNU make, vim and git.

## Donate

Writing the kernel took a lot of time. To help me finish MinC, you can make a donation via PayPal. Any amount is welcome.

     ![](https://www.paypal.com/en_NL/i/scr/pixel.gif)

Let me know if you wish to have a particular software included in the next release. Send an e-mail to dboland@xs4all.nl.

## Antivirus

MinC works well with antivirus software, such as the built-in **Windows Defender** or **Kaspersky**.

In some cases you need to temporarily disable antivirus before downloading and installing ([Kaspersky](https://support.kaspersky.com/KIS/21.2/en-US/70886.htm "How to pause and resume computer protection")). After that, MinC works fine.

In other cases, MinC installs well, but the antivirus does not let you run its programs. You need to exclude the MinC root directory from scanning ([f-secure](https://help.f-secure.com/product.html#home/total-windows/latest/en/allow_program_on_sys_control_blocklist_to_run-latest-en "Allowing blocked applications")).

## Visual Studio

MinC can be integrated into **MS Visual Studio Code** as a terminal. Put following snippet in your personal settings.json file:

"terminal.integrated.profiles.windows": {
   "MinC": {
      "path": "C:\\\\MinC\\\\sbin\\\\bsd.exe"
   }
}

If you installed MinC at another location, make sure the underlined part is correct.

---

# C++26: more constexpr in the core language

*Source: <https://www.sandordargo.com/blog/2025/04/23/cpp26-constexpr-language-changes>*
*Published: 2025-04-23T19:12:52.000Z*

[Comments](https://lobste.rs/s/t1lbrg/c_26_more_constexpr_core_language)

---

# CheerpJ 4.0: WebAssembly JVM for the browser, now with Java 11 and JNI support

*Source: <https://labs.leaningtech.com/blog/cheerpj-4.0>*
*Published: 2025-04-23T15:02:31.000Z*

astro-island,astro-slot,astro-static-slot{display:contents}(()=>{var i=t=>{let e=async()=>{await(await t())()};"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,200)};(self.Astro||(self.Astro={})).idle=i;window.dispatchEvent(new Event("astro:idle"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i\[o\]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let\[l,e\]=t;return l in i?i\[l\](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map((\[l,e\])=>\[l,o(e)\]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island\[ssr\]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template\[data-astro-template\]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n\[r.getAttribute("data-astro-template")||"default"\]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n\[r.getAttribute("name")||"default"\]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=\` (export ${v})\`),console.error(\`\[hydrate\] Error parsing props for component ${s}\`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT\_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro\[c\]===void 0){window.addEventListener(\`astro:${c}\`,()=>this.start(),{once:!0});return}try{await Astro\[c\](async()=>{let n=this.getAttribute("renderer-url"),\[h,{default:p}\]=await Promise.all(\[import(this.getAttribute("component-url")),n?import(n):()=>()=>{}\]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h\[u\];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component\[f\]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(\`\[astro-island\] Error hydrating ${this.getAttribute("component-url")}\`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",\["props"\]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();

*   [Leaning Technologies](https://leaningtech.com/)

*   Technology
*   Resources
*   [](https://discord.leaningtech.com)
*   [](https://x.com/leaningtech)

*   Leaning Technologies
Leaning TechnologiesCheerpCheerpJCheerpXDeveloper HubBlogGitHub

*   [**Cheerp** C++ to Wasm/JS compiler](https://cheerp.io/)
*   [**CheerpJ** Java runtime for browsers](https://cheerpj.com/)
*   [**CheerpX** Virtual machines for the web](https://cheerpx.io/)

*   [Developer Hub](https://labs.leaningtech.com/)
*   [Blog](https://labs.leaningtech.com/blog)
*   [GitHub](https://github.com/leaningtech)

[Back to blog](/blog) ![](/_astro/CJ4-0-hero.0tumPrea_Z1y7Ei8.webp)

# CheerpJ 4.0: WebAssembly JVM for the browser, now with Java 11 and JNI support

[![](/_astro/alessandro.DYqlQ9Ey.jpeg)

Alessandro Pignotti

](https://twitter.com/alexpignotti)[![](/_astro/stefano.CXkrI6vP.jpeg)

Stefano De Rossi

](https://twitter.com/smmdr)

April 23, 2025

[X](https://twitter.com/intent/tweet?url=https://labs.leaningtech.com/blog/cheerpj-4.0.html&text=The latest release of our state-of-the-art Java runtime that runs completely in the browser via WebAssembly, is now available!
&via=leaningtech) [Facebook](https://www.facebook.com/sharer/sharer.php?u=https://labs.leaningtech.com/blog/cheerpj-4.0.html) [Y Combinator](http://news.ycombinator.com/submitlink?u=https://labs.leaningtech.com/blog/cheerpj-4.0.html&t=CheerpJ 4.0: WebAssembly JVM for the browser, now with Java 11 and JNI support) [LinkedIn](https://www.linkedin.com/sharing/share-offsite/?url=https://labs.leaningtech.com/blog/cheerpj-4.0.html) [Reddit](https://www.reddit.com/submit?url=https%3A%2F%2Flabs.leaningtech.com%2Fblog%2Fcheerpj-4.0.html&title=CheerpJ 4.0: WebAssembly JVM for the browser, now with Java 11 and JNI support) [Email](mailto:?subject=CheerpJ 4.0: WebAssembly JVM for the browser, now with Java 11 and JNI support&body=The latest release of our state-of-the-art Java runtime that runs completely in the browser via WebAssembly, is now available!
%0Ahttps://labs.leaningtech.com/blog/cheerpj-4.0.html) [WhatsApp](whatsapp://send?text=The%20latest%20release%20of%20our%20state-of-the-art%20Java%20runtime%20that%20runs%20completely%20in%20the%20browser%20via%20WebAssembly,%20is%20now%20available!%0A%20https://labs.leaningtech.com/blog/cheerpj-4.0.html)

Today we are happy to announce CheerpJ 4.0, the latest major release of CheerpJ, a Java Virtual Machine and OpenJDK distribution in WebAssembly, designed to run Java applications and libraries in the browser.

[Get started](https://cheerpj.com/docs/getting-started) [Join us on Discord](https://discord.leaningtech.com)

CheerpJ 4.0 is the first version to support both Java 8 and Java 11, an essential step along our [roadmap![](/icons/external-link.svg)](https://cheerpj.com/our-roadmap-for-modern-java-in-the-browser/) to bring modern Java to the browser. Support for Java 17- the next step along this path - is planned for later in the year as part of the CheerpJ 5.0 milestone. We expect to achieve LTS parity by the end of 2026.

In addition to Java 11 support, CheerpJ 4.0 also improves mobile usability, introduces support for WebAssembly JNI modules, and brings significant performance improvements.

In combination with [Library Mode![](/icons/external-link.svg)](https://cheerpj.com/docs/getting-started/Java-library), which provides very advanced JavaScript-Java interoperability, we believe CheerpJ is now closer than ever to our vision of making Java a first-class programming language for the Web.

## What can CheerpJ do?[![](/icons/heading-link.svg)](#what-can-cheerpj-do)

CheerpJ is a full WebAssembly-based JVM for the browser, and comes with a complete OpenJDK runtime, as well as a powerful emulation layer to provide file system access, general networking support and other OS-level features. It works fully client-side, via WebAssembly, JavaScript and HTML5 technologies. It is, in essence, a JavaScript library, with no server-side or cloud-based component of any sort.

CheerpJ is a complete, flexible Java platform for modern browsers. It is an extremely powerful tool, designed and tested to work at the scale of real-world, large enterprise applications. Here is an overview of what CheerpJ can be used for.

### Running large-scale Swing / AWT applications[![](/icons/heading-link.svg)](#running-large-scale-swing--awt-applications)

CheerpJ can run existing, full Java applications from unmodified JARs, with no recompilation or pre-processing, straight from bytecode. Obfuscated or encrypted JARs are supported irrespective of the obfuscator being used.

A complex Swing application running live. Use the bottom-right control button to try it fullscreen.

var demoDiv = document.getElementById("demodiv"); var demoFullscreen = document.getElementById("demofullscreen"); var demoNormal = document.getElementById("demonormal"); demoFullscreen.onclick = function() { demoDiv.requestFullscreen(); }; demoNormal.onclick = function() { document.exitFullscreen(); }; demoDiv.onfullscreenchange = function() { if(document.fullscreenElement) { demoNormal.classList.remove("hidden"); demoFullscreen.classList.add("hidden"); } else { demoFullscreen.classList.remove("hidden"); demoNormal.classList.add("hidden"); } };

Both AWT- and Swing-based applications are supported, including third-party Swing Look&Feels. Multiple applications, each with multiple windows, can run at the same time on the same page.

CheerpJ 4.0 introduces an unprecedented level of support for mobile devices, enabling for the first time to make complex Java applications available to users across phones and, especially, tablets.

Running a Java application is straightforward, requiring just three calls to the CheerpJ APIs (see our [Getting Started![](/icons/external-link.svg)](https://cheerpj.com/docs/getting-started/Java-app) guide for a fully worked example).

.ec.ec-urz4h{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji';font-size:0.9rem;line-height:1.65;text-size-adjust:none;-webkit-text-size-adjust:none}.ec.ec-urz4h \*:not(path){all:revert;box-sizing:border-box}.ec.ec-urz4h ::selection{background:#00000050;color:#80cbc4}.ec.ec-urz4h pre{display:flex;margin:0;padding:0;border:1.5px solid rgb(41, 37, 36);border-radius:calc(0.3rem + 1.5px);background:transparent;background-clip:padding-box}.ec.ec-urz4h pre:focus-visible{outline:3px solid #ffffff00;outline-offset:-3px}.ec.ec-urz4h pre > code{all:unset;display:block;flex:1 0 100%;padding:1rem 0;color:#eeffff;font-family:'IBM Plex Mono',Consolas,'Andale Mono WT','Andale Mono','Lucida Console','Lucida Sans Typewriter','DejaVu Sans Mono','Bitstream Vera Sans Mono','Liberation Mono','Nimbus Mono L',Monaco,'Courier New',Courier,monospace;font-size:0.85rem;line-height:1.65;--padding-inline:1.35rem}.ec.ec-urz4h pre ::selection{background:#61616150}.ec.ec-urz4h pre{overflow-x:auto}.ec.ec-urz4h pre::-webkit-scrollbar,.ec.ec-urz4h pre::-webkit-scrollbar-track{background-color:inherit;border-radius:calc(0.3rem + 1.5px);border-top-left-radius:0;border-top-right-radius:0}.ec.ec-urz4h pre::-webkit-scrollbar-thumb{background-color:#eeffff26;border:4px solid transparent;background-clip:content-box;border-radius:10px}.ec.ec-urz4h pre::-webkit-scrollbar-thumb:hover{background-color:#eeffff26}.ec.ec-urz4h .ec-line{--accent-margin:0rem;min-width:calc(100% - var(--accent-margin));padding-inline:var(--padding-inline);padding-inline-end:calc(2rem + var(--padding-inline));direction:ltr;unicode-bidi:isolate}.ec.ec-urz4h .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}.ec.ec-urz4h .ec-line.mark{--line-marker-bg-color:#264a8980;--line-marker-border-color:#5570b3d0}.ec.ec-urz4h .ec-line.ins{--line-marker-bg-color:#26561c80;--line-marker-border-color:#4e7e41d0}.ec.ec-urz4h .ec-line.ins::before{content:'+';color:#7eb070d0}.ec.ec-urz4h .ec-line.del{--line-marker-bg-color:#81322b80;--line-marker-border-color:#ae594fd0}.ec.ec-urz4h .ec-line.del::before{content:'-';color:#e68a7ed0}.ec.ec-urz4h .ec-line.mark,.ec.ec-urz4h .ec-line.ins,.ec.ec-urz4h .ec-line.del{--accent-margin:0rem;--accent-width:0.15rem;position:relative;background:var(--line-marker-bg-color);margin-inline-start:var(--accent-margin);border-inline-start:var(--accent-width) solid var(--line-marker-border-color);padding-inline-start:calc(1.35rem - var(--accent-margin) - var(--accent-width)) !important}.ec.ec-urz4h .ec-line.mark::before,.ec.ec-urz4h .ec-line.ins::before,.ec.ec-urz4h .ec-line.del::before{position:absolute;left:0.5rem}.ec.ec-urz4h .ec-line mark{--inline-marker-bg-color:#264a8980;--inline-marker-border-color:#5570b3d0}.ec.ec-urz4h .ec-line ins{--inline-marker-bg-color:#26561c80;--inline-marker-border-color:#4e7e41d0}.ec.ec-urz4h .ec-line del{--inline-marker-bg-color:#81322b80;--inline-marker-border-color:#ae594fd0}.ec.ec-urz4h .ec-line mark,.ec.ec-urz4h .ec-line ins,.ec.ec-urz4h .ec-line del{all:unset;display:inline-block;position:relative;--border:1.5px;--border-l:var(--border);--border-r:var(--border);--radius-l:0.2rem;--radius-r:0.2rem;margin-inline:0.025rem;padding-inline:0.15rem;border-radius:var(--radius-l) var(--radius-r) var(--radius-r) var(--radius-l);background:var(--inline-marker-bg-color);background-clip:padding-box}.ec.ec-urz4h .ec-line mark.open-start,.ec.ec-urz4h .ec-line ins.open-start,.ec.ec-urz4h .ec-line del.open-start{margin-inline-start:0;padding-inline-start:0;--border-l:0px;--radius-l:0}.ec.ec-urz4h .ec-line mark.open-end,.ec.ec-urz4h .ec-line ins.open-end,.ec.ec-urz4h .ec-line del.open-end{margin-inline-end:0;padding-inline-end:0;--border-r:0px;--radius-r:0}.ec.ec-urz4h .ec-line mark::before,.ec.ec-urz4h .ec-line ins::before,.ec.ec-urz4h .ec-line del::before{content:'';display:inline-block;position:absolute;inset:0;border-radius:var(--radius-l) var(--radius-r) var(--radius-r) var(--radius-l);border:var(--border) solid var(--inline-marker-border-color);border-inline-width:var(--border-l) var(--border-r);pointer-events:none}.ec.ec-urz4h .frame{all:unset;position:relative;display:block;--header-border-radius:calc(0.3rem + 1.5px);--button-spacing:0.4rem;--code-background:transparent;border-radius:var(--header-border-radius);box-shadow:0.1rem 0.1rem 0.2rem transparent}.ec.ec-urz4h .frame .header{display:none;z-index:1;position:relative;border:1.5px solid rgb(41, 37, 36);border-bottom:none;border-radius:var(--header-border-radius) var(--header-border-radius) 0 0}.ec.ec-urz4h .frame.has-title,.ec.ec-urz4h .frame.is-terminal{--button-spacing:2.4rem}.ec.ec-urz4h .frame.has-title pre,.ec.ec-urz4h .frame.has-title code,.ec.ec-urz4h .frame.is-terminal pre,.ec.ec-urz4h .frame.is-terminal code{border-top:none;border-top-left-radius:0;border-top-right-radius:0}.ec.ec-urz4h .frame .title:empty:before{content:'\\a0'}.ec.ec-urz4h .frame.has-title:not(.is-terminal) .title{position:relative;color:#ffffff;background:linear-gradient(to top, transparent 1.5px, transparent 1.5px),linear-gradient(transparent, transparent);background-clip:padding-box;background-repeat:no-repeat;margin-block-start:0;padding:0.25rem 1rem;border-radius:0.3rem 0.3rem 0 0;border:1.5px solid transparent;border-bottom:none}.ec.ec-urz4h .frame.has-title:not(.is-terminal) .header{border-color:rgb(41, 37, 36);display:flex;background:transparent;background-clip:padding-box}.ec.ec-urz4h .frame.has-title:not(.is-terminal) .header::before{padding-inline-start:0}.ec.ec-urz4h .frame.has-title:not(.is-terminal) .header::after{flex-grow:1}.ec.ec-urz4h .frame.has-title:not(.is-terminal) .header::before,.ec.ec-urz4h .frame.has-title:not(.is-terminal) .header::after{content:'';border-bottom:1.5px solid transparent}.ec.ec-urz4h .frame.is-terminal{--code-background:transparent}.ec.ec-urz4h .frame.is-terminal .header{display:flex;align-items:center;justify-content:center;padding-block:0.25rem;position:relative;font-weight:500;letter-spacing:0.025ch;color:#eeffff;background:transparent;background-clip:padding-box}.ec.ec-urz4h .frame.is-terminal .header::before{content:'';background-color:#eeffff;opacity:0.15;-webkit-mask-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 16' preserveAspectRatio='xMidYMid meet'%3E%3Ccircle cx='8' cy='8' r='8'/%3E%3Ccircle cx='30' cy='8' r='8'/%3E%3Ccircle cx='52' cy='8' r='8'/%3E%3C/svg%3E");-webkit-mask-repeat:no-repeat;mask-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 16' preserveAspectRatio='xMidYMid meet'%3E%3Ccircle cx='8' cy='8' r='8'/%3E%3Ccircle cx='30' cy='8' r='8'/%3E%3Ccircle cx='52' cy='8' r='8'/%3E%3C/svg%3E");mask-repeat:no-repeat;position:absolute;left:1rem;width:2.1rem;height:0.56rem;line-height:0}.ec.ec-urz4h .frame.is-terminal .header::after{content:'';position:absolute;inset:0;border-bottom:1.5px solid transparent}.ec.ec-urz4h .frame pre{background:var(--code-background);background-clip:padding-box}.ec.ec-urz4h .copy{display:flex;gap:0.25rem;flex-direction:row;position:absolute;inset-block-start:calc(1.5px + var(--button-spacing));inset-inline-end:calc(1.5px + 1rem / 2);direction:ltr;unicode-bidi:isolate}.ec.ec-urz4h .copy button{position:relative;align-self:flex-end;margin:0;padding:0;border:none;border-radius:0.2rem;z-index:1;cursor:pointer;transition-property:opacity, background, border-color;transition-duration:0.2s;transition-timing-function:cubic-bezier(0.25, 0.46, 0.45, 0.94);width:2.5rem;height:2.5rem;background:var(--code-background);opacity:0.75}.ec.ec-urz4h .copy button div{position:absolute;inset:0;border-radius:inherit;background:#eeffff;opacity:0;transition-property:inherit;transition-duration:inherit;transition-timing-function:inherit}.ec.ec-urz4h .copy button::before{content:'';position:absolute;inset:0;border-radius:inherit;border:1.5px solid #eeffff;opacity:0.4}.ec.ec-urz4h .copy button::after{content:'';background-color:#eeffff;-webkit-mask-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='1.75'%3E%3Cpath d='M3 19a2 2 0 0 1-1-2V2a2 2 0 0 1 1-1h13a2 2 0 0 1 2 1'/%3E%3Crect x='6' y='5' width='16' height='18' rx='1.5' ry='1.5'/%3E%3C/svg%3E");-webkit-mask-repeat:no-repeat;mask-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='1.75'%3E%3Cpath d='M3 19a2 2 0 0 1-1-2V2a2 2 0 0 1 1-1h13a2 2 0 0 1 2 1'/%3E%3Crect x='6' y='5' width='16' height='18' rx='1.5' ry='1.5'/%3E%3C/svg%3E");mask-repeat:no-repeat;position:absolute;inset:0;margin:0.475rem;line-height:0}.ec.ec-urz4h .copy button:hover,.ec.ec-urz4h .copy button:focus:focus-visible{opacity:1}.ec.ec-urz4h .copy button:hover div,.ec.ec-urz4h .copy button:focus:focus-visible div{opacity:0.2}.ec.ec-urz4h .copy button:active{opacity:1}.ec.ec-urz4h .copy button:active div{opacity:0.3}.ec.ec-urz4h .copy .feedback{--tooltip-arrow-size:0.35rem;--tooltip-bg:#687b4b;color:white;pointer-events:none;user-select:none;-webkit-user-select:none;position:relative;align-self:center;background-color:var(--tooltip-bg);z-index:99;padding:0.125rem 0.75rem;border-radius:0.2rem;margin-inline-end:var(--tooltip-arrow-size);opacity:0;transition-property:opacity, transform;transition-duration:0.2s;transition-timing-function:ease-in-out;transform:translate3d(0, 0.25rem, 0)}.ec.ec-urz4h .copy .feedback::after{position:absolute;content:'';top:calc(50% - var(--tooltip-arrow-size));inset-inline-end:calc(-2 \* (var(--tooltip-arrow-size) - 0.5px));border:var(--tooltip-arrow-size) solid transparent;border-inline-start-color:var(--tooltip-bg)}.ec.ec-urz4h .copy .feedback.show{opacity:1;transform:translate3d(0, 0, 0)}@media (hover: hover){.ec.ec-urz4h{}.ec.ec-urz4h .copy button{opacity:0;width:2rem;height:2rem}.ec.ec-urz4h .frame:hover .copy button:not(:hover),.ec.ec-urz4h .frame:focus-within :focus-visible ~ .copy button:not(:hover),.ec.ec-urz4h .frame .copy .feedback.show ~ button:not(:hover){opacity:0.75}}

    await cheerpjInit();cheerpjCreateDisplay(800, 600);await cheerpjRunJar("/app/my_application_archive.jar");

CheerpJ is built to run Java bytecode at scale, and is robust to very large applications. As a point of reference, our internal stress test is IntelliJ IDEA, an application comprising around 400MB of JAR files.

### Using Java libraries as part of Web Applications[![](/icons/heading-link.svg)](#using-java-libraries-as-part-of-web-applications)

CheerpJ makes it possible to use Java libraries from JavaScript using a natural and expressive `async`/`await` based approach, we call this feature _Library Mode_.

The following snippet of code should give an idea about this capability, by using the popular `iText` library to generate a PDF completely client-side in the browser.

    async function iTextExample() {  await cheerpjInit();  const lib = await cheerpjRunLibrary("/app/itextpdf-5.5.13.3.jar");  try {    const Document = await lib.com.itextpdf.text.Document;    const Paragraph = await lib.com.itextpdf.text.Paragraph;    const PdfWriter = await lib.com.itextpdf.text.pdf.PdfWriter;    const FileOutputStream = await lib.java.io.FileOutputStream;    const document = await new Document();    const writer = await PdfWriter.getInstance(      document,      await new FileOutputStream("/files/HelloIText.pdf")    );    await document.open();    await document.add(await new Paragraph("Hello World!"));    await document.close();    await writer.close();    const blob = await cjFileBlob("/files/HelloIText.pdf");    const url = URL.createObjectURL(blob);    pdfDisplay.data = url;  } catch (e) {    const IOException = await lib.java.io.IOException;    if (e instanceof IOException) console.log("I/O error");    else console.log("Unknown error: " + (await e.getMessage()));  }}

_Library Mode_ provides extensive access to Java, with these main features:

*   Creating new objects
*   Calling static and instance methods. Overloading is supported and the correct method is resolved taking into account the argument types.
*   Accessing static and instance fields, both for reading and for writing.
*   Handling Java exceptions from JavaScript (via regular `try`/`catch` blocks)

_Library Mode_ is a unique feature, which makes it possible to build a new generation of fully client-side Web applications that combine Web-native components with Java libraries to implement complex functionalities.

In more enterprise scenarios, this approach can be used to progressively migrate large-scale Java applications to native Web apps, by rewriting the UI while keeping all or part of the original business logic in Java. This can provide significant reduction of risk, costs, and timeline to large modernisation projects.

Check out our dedicated documentation for more information on [Library Mode![](/icons/external-link.svg)](https://cheerpj.com/docs/getting-started/Java-library)

### Running legacy Java Applets and Java Web Start[![](/icons/heading-link.svg)](#running-legacy-java-applets-and-java-web-start)

![CheerpJ extensions](/_astro/CJ4Extensions.Cijkii74_2rNw80.webp)

On top of the core CheerpJ technology we have built specialized browser extensions, [CheerpJ Applet Runner![](/icons/external-link.svg)](https://cheerpj.com/cheerpj-applet-runner/) and [CheerpJ JNLP Runner![](/icons/external-link.svg)](https://cheerpj.com/cheerpj-jnlp-runner/), to run applets and Java Web Start applications without any manual integration steps.

Both extensions are available for Chrome and Edge and have been very popular, with hundreds of thousands of users all over the world.

These tools are particularly suited for end-users who simply need to access legacy Java client applications on modern setups, and for organisations that are testing and evaluating CheerpJ.

## How does CheerpJ work[![](/icons/heading-link.svg)](#how-does-cheerpj-work)

![CheerpJ architecture](/_astro/cheerpj-3-deep-dive-arch.JcFRH2U8_1idtdw.webp)

CheerpJ is a Java Virtual Machine in WebAssembly for the browser, which JIT-compiles Java bytecode into JavaScript. It is a sophisticated tool with many moving parts, the main ones being:

*   A WebAssembly **JVM and Just-In-Time compiler for** Java bytecode. The code contained in class files is dynamically compiled and optimized. The JIT compiler supports advanced optimizations such as inlining and dynamic devirtualization.
*   A complete and unmodified build of **OpenJDK**.
*   **A virtualized system layer, including:**
    *   [Virtualized file systems![](/icons/external-link.svg)](https://cheerpj.com/docs/guides/File-System-support), providing access to assets over HTTP, local persistent R/W storage via IndexedDB and interaction with JavaScript data.
    *   [Virtualized networking![](/icons/external-link.svg)](https://cheerpj.com/docs/guides/Networking) support via Tailscale. Both server and client applications are supported.
    *   Seamless clipboard integration using the [Clipboard API![](/icons/external-link.svg)](https://cheerpj.com/docs/reference/cheerpjInit#clipboardmode).
    *   A window manager, to support multiple Java windows and multiple Java applications in the same Web page.

For more details about the design of CheerpJ, please refer to [the deep dive![](/icons/external-link.svg)](https://labs.leaningtech.com/blog/cheerpj-3-deep-dive) we published at the time of the initial CheerpJ 3.0 release. You can also read the [architecture page![](/icons/external-link.svg)](https://cheerpj.com/docs/explanation/architecture) in the CheerpJ documentation.

## Demo: Unmodified Minecraft in the browser[![](/icons/heading-link.svg)](#demo-unmodified-minecraft-in-the-browser)

To showcase the capabilities of CheerpJ, we created a side project named [Browsercraft![](/icons/external-link.svg)](https://browsercraft.cheerpj.com/), a web-based “embedding” of a historical Java version of Minecraft.

Contrary to other approaches you might have seen, Browsercraft is not based on decompilation or reverse engineering attempts. The original `client.jar` is fetched directly from Mojang servers on the end-user browser and runs unmodified. The LWJGL dependency, available from Maven, is also unmodified.

How LWJGL works in CheerpJ is particularly interesting, since it is only _superficially_ Java. Most of its value comes from JNI methods which provide direct access to each and every method exposed by OpenGL. These methods are written in C and automatically generated by the LWJGL build system from a declarative representation of the OpenGL API.

CheerpJ 4.0 introduces support for these scenarios via JNI WebAssembly modules, which are loaded and executed dynamically, similarly to what happens on native platforms via shared libraries. Browsercraft takes advantage of this capability for LWJGL native code and also for the [gl4es![](/icons/external-link.svg)](https://github.com/ptitSeb/gl4es/) library. This latter component provides a compatibility layer between OpenGL, used by Minecraft, and GLES as provided by WebGL.

By combining these WebAssembly modules and the unmodified JARs, CheerpJ can now correctly render Minecraft in the browser. It should be noted that Minecraft is a notoriously inefficient and resource intensive application, so we consider it to be a _stress test_ for CheerpJ. Nevertheless, thanks to recent improvements in our JIT compiler, the demo can now run with satisfactory performance on most mid range machines. The situation will further improve in the future thanks to more advanced optimizations currently planned, stay tuned.

## What’s next?[![](/icons/heading-link.svg)](#whats-next)

CheerpJ 4.0 greatly extends what can be achieved with CheerpJ, thanks to Java 11 support, WebAssembly JNI modules and improved support for mobile devices. The upcoming 5.0 release, scheduled for late 2025, will bring us even closer to running any modern Java application in the browser.

A few major updates we expect to ship soon are:

*   **Support for Java 17**: This will be introduced as part of CheerpJ 5.0. The implementation is already at the prototypical stage, and available on request to interested parties. We expect general availability of Java 17 before the end of 2025. Get in touch if you are interested in early access!
*   **Support for JavaFX / SWT**: WebAssembly JNI modules, as described above in the context of [Browsercraft](#demo-unmodified-minecraft-in-the-browser), will be a critical component to introduce support for _JavaFX_ and _SWT_. Similarly to LWJGL, these libraries are only superficially Java, with most of the logic being implemented as platform-specific, C and C++ code. We plan to compile all this code to WebAssembly, taking advantage of upcoming improvements to our C++ to WebAssembly and JavaScript compiler [Cheerp![](/icons/external-link.svg)](https://cheerp.io)
*   **General availability for JNI headers and libraries**: We compile WebAssembly JNI modules thanks to custom implementation of the JNI headers and libraries, specifically designed to work with the CheerpJ JVM. We plan to release these so that users may compile their own WebAssembly JNI modules. Thanks to this an even greater range of Java applications will be supported.

We believe that CheerpJ and WebAssembly will enable Java to become a first-class programming language for the Web, opening the door to a new generation of Web native Java-powered client applications. We hope you find these possibilities as exciting as we do.

## Licensing[![](/icons/heading-link.svg)](#licensing)

CheerpJ is commercial software, but it’s free to use for FOSS projects, personal projects and one-person companies. Affordable and transparent licensing apply to small businesses.

Enterprise licensing and support are available, with significant discounts for non-profit and educational institutions. For more information see [Licensing![](/icons/external-link.svg)](https://cheerpj.com/cheerpj-core/#compare-plans).

## Try it out and join the community[![](/icons/heading-link.svg)](#try-it-out-and-join-the-community)

CheerpJ is extensively documented, ranging from basic tutorials to the detailed API reference.

[Get started](https://cheerpj.com/docs/getting-started)

For questions, discussion, and support, join our [Discord![](/icons/external-link.svg)](https://discord.leaningtech.com). It’s an active community where both Leaning Technologies developers and experienced users can provide help.

Following the success of the second edition of the [WebVM Hackathon![](/icons/external-link.svg)](https://cheerpx.io/hackathon) earlier this year, we have decided to host the first [CheerpJ Hackathon![](/icons/external-link.svg)](https://cheerpj-the-hackathon.devpost.com). The event theme and precise dates are still being determined, but it will be a week-long competition to be held between September and October 2025, with a £500 prize awaiting the winning team. [Sign up now![](/icons/external-link.svg)](https://cheerpj-the-hackathon.devpost.com) to stay updated.

* * *

CheerpJ is a product built with passion and a lot of coffee by Leaning Technologies, an international team of WebAssembly hackers based in Amsterdam (NL) and Leeds (UK). We hope you’ll love it as much as we do.

[Star CheerpJ on GitHub](https://github.com/leaningtech/cheerpj-meta)

[Join us on Discord](https://discord.leaningtech.com)

1.  [Introduction](#introduction)
2.  [What can CheerpJ do?](#what-can-cheerpj-do)
    1.  [Running large-scale Swing / AWT applications](#running-large-scale-swing--awt-applications)
    2.  [Using Java libraries as part of Web Applications](#using-java-libraries-as-part-of-web-applications)
    3.  [Running legacy Java Applets and Java Web Start](#running-legacy-java-applets-and-java-web-start)
3.  [How does CheerpJ work](#how-does-cheerpj-work)
4.  [Demo: Unmodified Minecraft in the browser](#demo-unmodified-minecraft-in-the-browser)
5.  [What’s next?](#whats-next)
6.  [Licensing](#licensing)
7.  [Try it out and join the community](#try-it-out-and-join-the-community)

# The authors

[![](/_astro/alessandro.DYqlQ9Ey_Z1XoGES.webp)

Alessandro Pignotti

CTO @ Leaning Technologies



](https://twitter.com/alexpignotti)[![](/_astro/stefano.CXkrI6vP_1pcXPz.webp)

Stefano De Rossi

CEO @ Leaning Technologies



](https://twitter.com/smmdr)

# Related posts

*   [![](/_astro/webvm_claude_hero.CZIInCb7_Z1kxm5t.webp)
    
    ### Putting the Ghost in the Shell: integrating Claude Computer Use in WebVM
    
    ![](/_astro/alessandro.DYqlQ9Ey.jpeg)
    
    Alessandro Pignotti
    
    March 17, 2025
    
    ](/blog/webvm-claude)
*   [![](/_astro/CJ3-1-hero.DTomijlW_2j0hN3.webp)
    
    ### CheerpJ 3.1: JVM in WebAssembly and our roadmap for modern Java in the browser
    
    ![](/_astro/alessandro.DYqlQ9Ey.jpeg)![](/_astro/stefano.CXkrI6vP.jpeg)
    
    Alessandro Pignotti, Stefano De Rossi
    
    February 5, 2025
    
    ](/blog/cheerpj-3.1)
*   [![](/_astro/cheerpx1.0.BXrcvdDT_24RXGL.webp)
    
    ### CheerpX 1.0: High performance x86 virtualization in the browser via WebAssembly
    
    ![](/_astro/alessandro.DYqlQ9Ey.jpeg)
    
    Alessandro Pignotti
    
    December 4, 2024
    
    ](/blog/cx-10)

[![Leaning Technologies](/_astro/logotype-white.BhCrdQeW_Z21K1Ju.svg)](https://leaningtech.com)

![UK Business Tech Awards 2022 Finalist](/_astro/uk-business-tech-awards.CGdiVPBh_1pkrT.webp)![National Technology Awards 2022 Winner](/_astro/national-technology-awards.dzG5NBAj_fnd3v.webp)

### Technology

*   [Cheerp](https://cheerp.io)
*   [CheerpJ](https://cheerpj.com)
*   [CheerpX](https://cheerpx.io)
*   [CheerpX for Flash](https://leaningtech.com/cheerpx-for-flash)

### Browser extensions

*   [CheerpJ Applet Runner](https://cheerpj.com/cheerpj-applet-runner/)
*   [CheerpJ JNLP Runner](https://cheerpj.com/cheerpj-jnlp-runner/)

### Resources

*   [Documentation](https://labs.leaningtech.com/#ecosystem)
*   [Blog](https://labs.leaningtech.com/blog)
*   [GitHub](https://github.com/leaningtech)
*   [Contributing](https://labs.leaningtech.com/docs/contributing)

### Company

*   [About us](https://leaningtech.com/about-us/)
*   [News](https://leaningtech.com/news/)
*   [Partner program](https://leaningtech.com/partner-programs/)
*   [Privacy policy](https://leaningtech.com/privacy-policy/)
*   [Careers](https://leaningtech.freshteam.com/jobs)

[](https://discord.leaningtech.com)[](https://github.com/leaningtech)[](https://twitter.com/leaningtech)[](https://www.linkedin.com/company/leaning-technologies-ltd/)

© 2025 Leaning Technologies . All rights reserved.

Cheerp is a registered trademark of Leaning Technologies. The Cheerp, CheerpJ, and CheerpX logos are based on the HTML5 logo by [W3C](https://www.w3.org/) ([license](https://creativecommons.org/licenses/by/3.0/))

---

# Coding as Craft: Going Back to the Old Gym

*Source: <https://cekrem.github.io/posts/coding-as-craft-going-back-to-the-old-gym/>*
*Published: 2025-04-23T08:25:59.000Z*

[cekrem.github.io](https://cekrem.github.io/) 

*   [Hire me?](/hire/)
*   [About](/about/)
*   [Recommended Books](/posts/books-i-think-software-engineers-should-read)
*   [Podcast (🇳🇴)](https://creators.spotify.com/pod/show/disippel)
*   [Blog](/posts/)

# [Coding as Craft: Going Back to the Old Gym](https://cekrem.github.io/posts/coding-as-craft-going-back-to-the-old-gym/)

April 22, 2025 6-minute read

[AI](/tags/ai/) • [Coding](/tags/coding/) • [Craft](/tags/craft/) • [Clean Architecture](/tags/clean-architecture/) • [Career](/tags/career/) • [Programming](/tags/programming/)

Recently, [Shopify’s CEO Tobi Lütke shared his thoughts on AI’s role in coding](https://x.com/tobi/status/1909231499448401946), stating that “reflexive AI usage is now a baseline expectation at Shopify.” The gist of his message was that AI is revolutionizing how we work, and everybody should jump on board this train or risk being left behind. I’m paraphrasing a bit, but not much – check out the post for complete context and content.

This struck a chord with me, but not in the way he intended. In a Slack conversation with fellow Elm engineers, I found myself typing:

> Interesting timing. I just switched back to `vim` to get further away from AI interference in my coding. My last talk about AI had the subtitle “automate the boring parts” (inspired by that classic Python book), and that’s what it’s for for me.
> 
> Coding, however, is not the boring part, it’s my craft and I want to enjoy it and stay sharp. Sure, asking questions and discussing topics with an LLM if that’s all you’ve got at hand is fine. But “reflexive AI usage” sounds like a diagnosis I don’t want next to my name.
> 
> If people stop the occasional deadlock of grinding teeth, looking at a problem, crying, going for a walk, praying and screaming until suddenly it makes sense (and you learn something!), I’d call it severe regression, not progress.

The more I reflected on this exchange, as well as other comments from my betters, the more I realized it connects to something deeper about our relationship with technology and craft. It’s time to talk about going back to the old gym.

## The Rocky Balboa Principle [Link to heading](#the-rocky-balboa-principle)

In Rocky III, there’s a pivotal moment when Mickey confronts Rocky about how he’s lost his edge: “You used to be like supernatural, but the worst thing happened that can happen to any fighter: you got civilized!”

Mickey’s solution? “Let’s get outta here, back to the old gym!”

This scene has stayed with me because it captures something profound about mastery and skill development. The “old gym” represents the raw, essential conditions where real growth happens. It’s not comfortable. It’s not luxurious. But it’s where the authentic work gets done.

In the context of coding, our “old gym” is the mental space where we wrestle directly with problems, algorithms, and architectures without the cushion of AI generating solutions for us.

## AI as a Tool, Not a Replacement [Link to heading](#ai-as-a-tool-not-a-replacement)

Let me be clear: I’m not anti-AI. In fact, I find it incredibly useful – for the boring parts.

AI excels at:

*   Generating boilerplate code
*   Summarizing documentation
*   Explaining complex concepts
*   Helping debug tricky error messages
*   Drafting unit tests
*   Formatting data

But the core of programming – the thinking, the designing, the architectural decisions – these are the parts I want to preserve as my craft. These are the muscles I want to keep strong by training in the old gym.

## The Value of Cognitive Struggle [Link to heading](#the-value-of-cognitive-struggle)

There’s something irreplaceable about the process of wrestling with a difficult problem. That moment when you’re stuck, completely stuck, and you:

1.  Grind your teeth in frustration
2.  Step away from the computer
3.  Take a walk
4.  Pray to Jesus and/or cry your heart out
5.  Come back and try a different approach
6.  Repeat until… suddenly, it clicks

That “aha!” moment rewires your brain. It creates neural pathways that make you permanently better at what you do. It’s the coding equivalent of muscle memory, and it’s how we grow as engineers.

When we outsource this struggle to AI, we rob ourselves of these growth opportunities. We get solutions without understanding. We get code without craftsmanship.

AI can generate code, but it doesn’t (yet) understand the nuanced decisions that make systems truly maintainable and adaptable over time. It won’t design your domain layer with the care and consideration that comes from deep experience and hard-won knowledge. And again: whether it succeeds in the particular task at hand or not should not be your only concern if you care about your craft – whether you learn something should matter too!

To be clear, people have been Avoiding The Struggle™ long before LLMs took center stage. StackOverflow, Google, or even fellow engineers sitting at a desk nearby can be excellent tools robbing you of proper learning if abused. But the in-your-face constant availability and enormous scope of AI tools are just so much more vast and immense—that’s why I’m bringing it up specifically.

## Reflexive Usage vs. Intentional Collaboration [Link to heading](#reflexive-usage-vs-intentional-collaboration)

The phrase “reflexive AI usage” is what triggered my strongest reaction. “Reflexive” suggests unthinking, automatic reliance. It implies delegating not just tasks but judgment itself.

What I advocate instead is intentional collaboration with AI:

*   Use AI when/if it makes sense, not by default
*   Maintain critical thinking about its outputs
*   Understand what you’re integrating before you integrate it
*   Challenge its assumptions and review its code

This approach preserves your agency as a craftsperson while still leveraging the efficiency AI can bring.

## The Old Gym Workout Plan [Link to heading](#the-old-gym-workout-plan)

So what does “going back to the old gym” look like for coding in 2025? Here’s my approach:

1.  **Set boundaries for AI usage**: Define when you’ll use it and when you won’t. I use it for documentation, explanations, and occasional boilerplate – rarely for core algorithms or architecture. And I’m not using AI powered auto-complete!
    
2.  **Practice manual coding**: Regularly tackle problems without any AI assistance. Sites like Advent of Code, LeetCode, or even implementing small utilities from scratch keep those muscles strong. (AI is not the only issue – I’m specifically looking at you “just use an existing npm package for everything” junkies, and you poor “I’m lost without my fancy IDE” souls!).
    
3.  **Understand everything you use**: If AI generates code for you, don’t just paste it in. Study it. Understand it. Refactor it. Make it yours. Never, ever just accept copilot / cursor tab suggestions and carry on!
    
4.  **Embrace the struggle**: When stuck, resist the urge to immediately ask AI. Give yourself time to work through problems. The struggle is where growth happens.
    
5.  **Learn fundamentals deeply**: Strong knowledge of algorithms, data structures, and design patterns gives you the ability to evaluate AI-generated solutions critically. Rather than having the AI come up with the answers, discuss with it (if anything) and ask for relevant (human made!) resources to go deeper.
    

## Finding the Balance [Link to heading](#finding-the-balance)

This isn’t about rejecting progress or being a coding purist. It’s about maintaining the human element in a craft that’s increasingly automated.

Just as a chef might use a food processor for tedious prep work but would never dream of automating the creative aspects of recipe development and flavor balancing, we should use AI for what it’s good at while preserving the parts of coding that bring us joy and growth.

## Conclusion [Link to heading](#conclusion)

In a world pushing for “reflexive AI usage,” I’m advocating for something different: thoughtful, intentional collaboration with AI that preserves the essence of coding as a craft.

Like Rocky, we sometimes need to step away from the comfortable, civilized environment and return to the old gym – the place where real growth happens through struggle, persistence, and focused practice.

Because coding isn’t just about output. It’s about the journey of becoming better problem solvers, better thinkers, and better engineers. And some journeys can’t be outsourced, even to the most advanced AI.

Let’s use AI to automate the boring parts, but keep the craft in our own hands.

> “It ain’t about how hard you can hit. It’s about how hard you can get hit and keep moving forward.” – Rocky Balboa

form{display:flex;justify-content:center}

 Subscribe

location.pathname in{"":!0,"/":!0,"/hire/":!0,"/hire":!0}&&setTimeout(()=>{iFrameResize({log:!1,checkOrigin:!1},"#testimonialto-carousel-christian-ekrem-tag-all-light");const e=document.getElementById("testemonials");e.style.display="block",e.style.opacity=1,e.style.maxHeight="600px"},1e3)

© 2021 - 2025 Christian Ekrem

---

# Give it time

*Source: <https://ismaelcelis.com/posts/2025-04-give-it-time/>*
*Published: 2025-04-23T12:26:18.000Z*

[Ismael Celis](https://ismaelcelis.com/)

Apr 21, 2025 Ismael Celis 9 minutes read

# Give it time

Our experience of reality is based on the passage of time. Things begin and end, events happen one after the other. The world _changes_. And yet we model software as static object graphs frozen in time.

This sort of makes sense. While I’m used to going through my day as events in time (wake up, have breakfast, shower, _really_ wake up, etc), the act of _understanding_ feels like building a graph. When I plan for a new project, my mind jumps to try and form a picture of the current structure of the system. I try to understand how the different components interact with each other, and how they relate to the business domain. I think in hierarchies.

![Object graph](/images/2025/timelines/object-graph.svg)

A relational data model for a coffee shop

Then I use frameworks and programming paradigms that lean on this intuition. I model conceptual hierarchies as _associations_, and I think about domain entities as being _parents_ or _children_ of each other. I use statements like “a branch _has many_ orders”, “a line item _belongs to_ an order”.

These mental images exist in a kind of platonic universe, outside of time.

But this “timeless” view of the world is short-lived. It really only kicks in during the process of understanding a system from scratch. Past that stage, I have to deal with the fact that the world _does_ change. The domain is not static, and neither is my understanding of it. From then on, I have to think about how the system _evolves_ over time. We deal with _refactoring_, _migrating_, and accommodating changing requirements.

For most of a project’s life cycle, time _does_ play a big role.

And with time as a dimension, and change as a driver, graphs can go from asset to liability.

### Depth and coupling

Graphs grow deeper as the domain grows more complex. Perhaps product variants have allowed “complements” associated to them (to validate which other products can be added to them. for example toppings and add-ons). Perhaps they have a price. Perhaps customers can have discounts that can be applied to their orders.

![Deeper graph](/images/2025/timelines/deeper-graph.svg)

The graph grows deeper

Different parts of the model become progressively more tangled together. As the domain becomes more complex, so does the mental model. Graph depth, and therefore [coupling](https://en.wikipedia.org/wiki/Coupling_\(computer_programming\)), is unbounded.

### Where’s the door?

Graph-based models are effective at describing structure, but less so at describing _behaviour_. What capabilities does the model expose? What _workflows_ does it enable and, more importantly, what are the _entry points_ into those workflows?

This is especially true of ORM-based models, where data and capabilities are melded into the same relational graph. ORMs offer amazing flexibility, but they can make it hard to describe the model’s intended behaviour.

For example, you can create an order line item via the order record:

    line_item = order.line_items.create(variant: variant, ...)
    

… Or via the line item record factory:

    line_item = LineItem.create(order: order, variant: variant, ...)
    

Because of this malleability, domain invariants become hard to enforce and reason about. For example, if a business rule says that an order can only have up to 5 line items: that validation probably lives in the context of an _order_. But since the object graph does not prescribe its “public” entry points, we’re forced to resort to callbacks and other indirect methods to enforce invariants across whole sections of the graph.

    class Order
      has_many :line_items
      validates :max_five_line_items
    end
    
    class LineItem
      belongs_to :order
      before_save :validate_order
    end
    

Moreover: business rules are often contextual. The order can only have 5 line items _if_ the order is in a certain state, or if the customer is a certain type. Rules are not necessarily properties of the graph structure itself, but relative to behaviour, data and time.

### Implicit command layer

One way of identifying behaviour and capabilities in the model is by looking at the points where users interact with it. In CRUD web systems this is usually HTTP handlers or controllers.

    # POST /orders/:id/line_items
    def create
      order = Order.find(params[:id])
      order.line_items.create(line_item_params)
    end
    

These handlers define the entry points into the system. They constitute the system’s _command layer_, albeit somewhat informally, and tied to a specific execution context - handling HTTP requests.

If we then need to run some capabilities in the background, or as CLI tasks or scheduled jobs, we’re required to model and implement those entry points in different ways, tied to their distinct execution contexts.

    # A background job
    class OrderArchivalJob
      def perform(order_id)
        order = Order.find(order_id)
        order.archive
      end
    end
    

    # A CLI task
    bin/rake orders:archive
    

These are all _commands_ by another name. We just refer to them by their execution contexts instead of their roles in the system.

### Dee-dee-dee

It’s this kind of ambiguity that Domain Driven Design set out to solve. And its focus on language can indeed provide a lot of clarity, keep coupling in check, and illuminate the entry points into the system.

In particular, DDD’s [Aggregate](https://martinfowler.com/bliki/DDD_Aggregate.html) acts as a gatekeeper into the model. Aggregates enforce business rules and guarantee data consistency for entire chunks of the model.

    class Order
      def add_line_item(variant_id:, ...)
        # validate business rules rules
        raise "order can't have more than 5 line items" if line_items.count >= 5
        line_items.create(variant_id: variant_id, ...)
      end
    
      def update_quantity(line_item_id, quantity)
        # etc
      end
    
      def remove_line_item(line_item_id)
        # etc
      end
    end
    

    # The Order is the Aggregate Root
    # for all order-related capabilities
    # All interactions with an order or its sub-components 
    # are defined as methods in the order
    line_item = order.add_line_item(variant_id: 10, ...)
    

DDD’s Aggregate and [bounded contexts](https://martinfowler.com/bliki/BoundedContext.html) can also help keep different parts of the model decoupled from each other by defining strict boundaries around them. In our example above, we can decide that variant prices belong to a _pricing_ context, and that orders belong to a _sales_ context. With this constraint in mind we then define the contract between the two contexts.

### Standalone command objects

Yet another way to bring a system’s behaviour to the fore -and abstract it away from execution context- is to have explicit command objects. These are sometimes referred to as “service objects” (a mis-identification that usually belies a misunderstanding of the role they play).

    AddLineItem.run(order_id: 123, variant_id: 456, ...)
    

This pattern can definitely be misused, but it can also give clearer indication of a system’s capabilities as a distinct and uniform abstraction.

.file-tree { font-family: monospace; list-style-type: none; background: var(--hljs-bg); padding: 1rem var(--gap); color: #f8f8f2; margin: 0 calc(var(--gap) \* -1) 4rem; } .file-tree code { line-height: 1; } .folder { color: #66d9ef; } .file { color: #e6db74; } .file-tree ul { list-style-type: none; } .file-tree li { margin: 0; padding: 0; line-height: 1.5; }

*   `commands/`
    *   `orders/`
        *   `create.rb`
        *   `add_line_item.rb`
        *   `remove_line_item.rb`
        *   `archive.rb`
        *   `cancel.rb`
        *   `update_quantity.rb`
        *   `place.rb`

### The arrow of time

But in trying to surface a system’s behaviour and entry points, in all cases we hit on the central concept of a _command_. Commands initiate action, and may lead to state changes and side effects. Commands are causes to your domain’s effects. At a high level, we can describe entire sets of behaviours in those terms.

![Cause and effect](/images/2025/timelines/cause-and-effect.svg)

There’s an explicit sense of direction here. There’s a before and an after. There’s _time_, which is the axis on which behaviour plays out.

Behaviour can be modeled and tracked as a sequence of effects, and effects are _events_ that happen over time.

### The deep state

We still need state. But state is a function of behaviour, not the other way around. We can derive state from the events left behind by the system’s behaviour.

![State derived from events](/images/2025/timelines/state-view.svg)

State is derived from events

### Time composes

The single directionality of time allows us to compose behaviours together. We can model **workflows** by stitching together sequences of commands and events. Derived state can be used to drive the next command in the workflow.

![Workflow](/images/2025/timelines/workflow.svg)

Composing a workflow

These are the basic conventions of [Event Modeling](https://eventmodeling.org), which I’m using (liberally) in this post.

Note that there’s no canonical “data model” here. There are _ad-hoc_ data models derived from the system’s behaviour, and they’re essentially throw-away projections or views, in service of the next transition in the state machine, or whatever user-facing screen or report is needed.

![Linear workflow](/images/2025/timelines/linear-workflow.svg)

A linear "single threaded" workflow

### Concurrency is part of the model

Thinking in timelines and workflows means that we can model concurrency as a first-class citizen of the system.

![Concurrent workflow](/images/2025/timelines/concurrent-workflow.svg)

Concurrent timelines in a choreographed workflow

In this example, a main Order timeline “spawns” payment and build as concurrent timelines, which notify back to the parent timeline when they finish, at their own pace.

Whether the timelines are concurrent or sequential is a business decision. In this case, the coffee shop may judge that allowing starting the build before the payment is completed is worth the risk, as it speeds up overall delivery time. Business decisions are, by definition, part of the domain model, and therefore concurrency here is not just a technical concern.

### Automate this

Composing workflows based on this reduced set of building blocks lets us automate where it makes sense. We can start with a human-operated workflow, where a staff member must confirm orders ready to be released to the customer, once both payment and build are complete.

![Manual process](/images/2025/timelines/manual.svg)

A human operator moves the workflow forward

Later, we decide that this step is time-consuming and easily automateable. We now have a script periodically checking a specialised state view and scheduling the next command.

![Automation](/images/2025/timelines/automation.svg)

An automation tracks orders ready for release

Note that both human operators and automations work on the same layer as _actors_ in the workflow. They sit on the margins of the domain model, moving the workflow forward.

### When, not where

These workflows can be understood independently of their execution context. At this level it matters little whether a command is run from a web controller, or a background job, or a CLI task. We care about what the system can do, and when it can do it relative to workflows exposed. The model should not concern itself with execution context, and in fact we should be free to change it piece-meal as the system evolves.

#### TL;DR

*   Graphs are deep, timelines are shallow.
*   Shallow is simpler to reason about, and more resistant to coupling.
*   Your domain can be modeled, and thought of, as timelines instead of graphs.

### Notes

Workflows are central to a lot of domains. If you think about it, it’s peculiar that we design software based on object graphs and treat the workflows as, at best, a secondary part of the design process, and as an afterthought at worst.

I suspect this is mainly because of the legacy of relational databases as our primary way of interacting with and storing data for many decades. It’s all about the data schemas, and any behaviour is implicit in the interactions made possible by those schemas. This is reinforced by CRUD toolkits built on top of these assumptions.

### Links

[Event Modeling](https://eventmodeling.org) is the main source for the ideas and diagrams in this post (though I’ve skipped some of its conventions to take some points across). While [Event Sourcing](/posts/event-sourcing-ruby-examples/) is the obvious architectural pattern to implement this approach, modeling in these terms is high-level and should work well with [state-stored systems](/posts/decide-evolve-react-pattern-in-ruby/#event-sourced-vs-state-stored-systems).

Other valuable reading:

*   [The workflow pattern](https://blog.bittacklr.be/the-workflow-pattern.html)
*   [Food truck architecture - It’s all about events](https://ralfw.de/food-truck-architecture-its-all-about-events/)
*   [Don’t try to model the real world, it doesn’t exist](https://udidahan.com/2012/03/05/dont-try-to-model-the-real-world-it-doesnt-exist/)

Other articles …

[What do commands do in Event Sourcing](https://ismaelcelis.com/posts/what-do-commands-do-in-event-sourcing/) Dec 22, 2024 7 minutes read

[Dead Code Podcast Notes](https://ismaelcelis.com/posts/2025-01-dead-code-podcast-notes/) Jan 14, 2025 4 minutes read

[The Decide, Evolve, React pattern in Ruby](https://ismaelcelis.com/posts/decide-evolve-react-pattern-in-ruby/) Sep 16, 2024 11 minutes read

[Event Sourcing with Ruby examples. The Command layer.](https://ismaelcelis.com/posts/event-sourcing-ruby-command-layer/) Jul 4, 2022 11 minutes read

[Event Sourcing with Ruby examples. The Event Store interface.](https://ismaelcelis.com/posts/event-sourcing-ruby-event-store/) Jun 28, 2022 3 minutes read

© 2025 [Ismael Celis](https://ismaelcelis.com/)

[![Twitter feed](/images/twitter-logo.svg)](https://twitter.com/ismasan "Twitter: @ismasan")

[![Mastodon profile](/images/mastodon-logo.svg)](https://ruby.social/@ismasan "Mastodon")

[![Github profile](/images/github-logo.svg)](https://github.com/ismasan "Github: ismasan")

[![LinkedIn profile](/images/linkedin-logo.svg)](https://www.linkedin.com/in/ismasan/ "LinkedIn")

[![Bluesky profile](/images/bluesky-logo.svg)](https://bsky.app/profile/ismaelcelis.com "Bluesky")

---

# How to make an Android tablet respect my wish to stay on a WiFi with no internet access?

*Source: <https://lobste.rs/s/okm5za/how_make_android_tablet_respect_my_wish>*
*Published: 2025-04-23T23:03:13.000Z*

[](/ "Lobsters (Current traffic: 0%)")

[Active](/active) [Recent](/recent) [Comments](/comments) [Search](/search) [Login](/login)

[Login](/login)

1.  [4](/login)
    
    [How to make an Android tablet respect my wish to stay on a WiFi with no internet access?](/s/okm5za/how_make_android_tablet_respect_my_wish) [☶](/s/okm5za/how_make_android_tablet_respect_my_wish "I have a Lenovo android tablet for controlling my Behringer XR12 mixer. I connect the tablet to the mixer via a Wifi access point built into the mixer. For obvious reasons this wifi access point doesn't have internet access, and this is a feature: I don't want to be distracted my messages or new email during performances. 
    So far so good.
    There is one fly in the ointment. Periodically the Android tablet opens a browser window, in the foreground, trying to load the google.com front page....") [ask](/t/ask "Ask Lobsters") [android](/t/android "Android")
    
    authored by [![stig avatar](/avatars/stig-16.png)](/~stig) [stig](/~stig) 4 hours ago | [1 comment](/s/okm5za/how_make_android_tablet_respect_my_wish)
    

I have a Lenovo android tablet for controlling my Behringer XR12 mixer. I connect the tablet to the mixer via a Wifi access point built into the mixer. For obvious reasons this wifi access point doesn’t have internet access, and this is a feature: I don’t want to be distracted my messages or new email during performances.

So far so good.

There is one fly in the ointment. Periodically the Android tablet opens a browser window, in the foreground, trying to load the google.com front page. I have so far failed to find a setting that can make it stop doing this. Internet search have so far been fruitless. I only find articles aimed at folks that has the opposite problem: they want to get on the internet, but can’t. I want to NOT be on the internet, but I can’t make my tablet respect this.

Anybody have any suggestions?

1.    
    
       Preview
    
2.  1.  [](/login)
        
         [![nogweii avatar](/avatars/nogweii-16.png)](/~nogweii) [nogweii](/~nogweii) [2 hours ago](/s/okm5za/how_make_android_tablet_respect_my_wish#c_nnlya8 "2025-04-23 20:31:56 -0500")
        
        I wonder if this is related to the internet connectivity check, and if you can change it to a different host. Then point it at say, a raspberry pi or your router.
        

  

[About](/about) [Tags](/tags) [Filter](/filters) [Moderation Log](/moderations)

---

# Searchable Linux Syscall Table for x86_64

*Source: <https://filippo.io/linux-syscall-table/>*
*Published: 2025-04-23T19:54:44.000Z*

jQuery(document).ready(function ($) { $('.tbls-entry-collapsed').each(function () { $(this).dblclick(function () { $(this).toggleClass('tbls-entry-collapsed'); $(this).toggleClass('tbls-entry-expanded'); $(this).next().toggleClass('tbls-arguments-collapsed'); $(this).next().toggleClass('tbls-arguments-expanded'); }); $(this).next().dblclick(function () { $(this).toggleClass('tbls-arguments-collapsed'); $(this).toggleClass('tbls-arguments-expanded'); $(this).prev().toggleClass('tbls-entry-collapsed'); $(this).prev().toggleClass('tbls-entry-expanded'); }); }); $('.tbls-filter input').on('input', function () { $('.tbls-entry-expanded').each(function () { $(this).toggleClass('tbls-entry-collapsed'); $(this).toggleClass('tbls-entry-expanded'); $(this).next().toggleClass('tbls-arguments-collapsed'); $(this).next().toggleClass('tbls-arguments-expanded'); }); var N = (x) => $(x).find('td').eq(1); var rows = $('.tbls-entry-collapsed').toArray(); if (!$(this).val()) { for (var i = 0; i < rows.length; i++) { $(rows\[i\]).css('display', ''); N(rows\[i\]).html(N(rows\[i\]).text()); } return; } var results = fuzzy.filter($(this).val(), rows, { pre: '<span class="tbls-match">', post: '</span>', extract: function (x) { return N(x).text(); } }); for (var i = 0; i < rows.length; i++) { $(rows\[i\]).css('display', 'none'); } for (var i = 0; i < results.length; i++) { $(results\[i\].original).css('display', ''); N(results\[i\].original).html(results\[i\].string); } }) });

[![Filippo Valsorda](https://words.filippo.io/content/images/2023/02/Logo-Bianco-Filippo-Valsorda-def-web.png)](https://filippo.io)

[Bluesky 🦋](https://bsky.app/profile/filippo.abyssdomain.expert) / [Mastodon 🐘](https://abyssdomain.expert/@filippo) / [Newsletter 📮](https://filippo.io/newsletter)

# Searchable Linux Syscall Table

Since 2013, this table lists the Linux system call numbers for the x86-64 architecture, with their name, arguments, and links to the manual and the implementation. Also, fuzzy search!

The table is derived from the [`syscall_64.tbl` file](https://github.com/torvalds/linux/blob/v6.7/arch/x86/entry/syscalls/syscall_64.tbl) in the **Linux 6.7 kernel** source, and the [`syscalls.h` header file](https://github.com/torvalds/linux/blob/v6.7/include/linux/syscalls.h). The generator is available [on GitHub](https://github.com/FiloSottile/mostly-harmless/tree/main/filippo.fly.dev/filippo.io/linux-syscall-table).

Syscalls are implemented in functions named as in the _Entry point_ column, generated with `DEFINE_SYSCALLx` macros. For more information, see [Documentation/process/adding-syscalls.rst](https://www.kernel.org/doc/html/latest/process/adding-syscalls.html).

To learn more, read the [`syscall(2)`](https://manpages.debian.org/unstable/manpages-dev/syscall.2.en.html) and [`syscalls(2)`](https://manpages.debian.org/unstable/manpages-dev/syscalls.2.en.html) man pages.

**Double click on a row** to reveal the arguments list. Search using the fuzzy filter box.

Filter: 

The **return value** is placed in `%rax`.

%rax

Name

Manual

Entry point

0

read

[read(2)](https://manpages.debian.org/unstable/manpages-dev/read.2.en.html)

[sys\_read](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbread%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

char \*buf

size\_t count

1

write

[write(2)](https://manpages.debian.org/unstable/manpages-dev/write.2.en.html)

[sys\_write](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbwrite%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

const char \*buf

size\_t count

2

open

[open(2)](https://manpages.debian.org/unstable/manpages-dev/open.2.en.html)

[sys\_open](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbopen%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*filename

int flags

umode\_t mode

3

close

[close(2)](https://manpages.debian.org/unstable/manpages-dev/close.2.en.html)

[sys\_close](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclose%5Cb%2F&type=code)

%rdi

unsigned int fd

4

stat

[stat(2)](https://manpages.debian.org/unstable/manpages-dev/stat.2.en.html)

[sys\_newstat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbnewstat%5Cb%2F&type=code)

%rdi

%rsi

const char \*filename

struct stat \*statbuf

5

fstat

[fstat(2)](https://manpages.debian.org/unstable/manpages-dev/fstat.2.en.html)

[sys\_newfstat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbnewfstat%5Cb%2F&type=code)

%rdi

%rsi

unsigned int fd

struct stat \*statbuf

6

lstat

[lstat(2)](https://manpages.debian.org/unstable/manpages-dev/lstat.2.en.html)

[sys\_newlstat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbnewlstat%5Cb%2F&type=code)

%rdi

%rsi

const char \*filename

struct stat \*statbuf

7

poll

[poll(2)](https://manpages.debian.org/unstable/manpages-dev/poll.2.en.html)

[sys\_poll](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpoll%5Cb%2F&type=code)

%rdi

%rsi

%rdx

struct pollfd \*ufds

unsigned int nfds

int timeout

8

lseek

[lseek(2)](https://manpages.debian.org/unstable/manpages-dev/lseek.2.en.html)

[sys\_lseek](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblseek%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

off\_t offset

unsigned int whence

9

mmap

[mmap(2)](https://manpages.debian.org/unstable/manpages-dev/mmap.2.en.html)

[sys\_ksys\_mmap\_pgoff](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbksys_mmap_pgoff%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

unsigned long addr

unsigned long len

unsigned long prot

unsigned long flags

unsigned long fd

unsigned long pgoff

10

mprotect

[mprotect(2)](https://manpages.debian.org/unstable/manpages-dev/mprotect.2.en.html)

[sys\_mprotect](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmprotect%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long start

size\_t len

unsigned long prot

11

munmap

[munmap(2)](https://manpages.debian.org/unstable/manpages-dev/munmap.2.en.html)

[sys\_munmap](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmunmap%5Cb%2F&type=code)

%rdi

%rsi

unsigned long addr

size\_t len

12

brk

[brk(2)](https://manpages.debian.org/unstable/manpages-dev/brk.2.en.html)

[sys\_brk](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbbrk%5Cb%2F&type=code)

%rdi

unsigned long brk

13

rt\_sigaction

[rt\_sigaction(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigaction.2.en.html)

[sys\_rt\_sigaction](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigaction%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int

const struct sigaction \*

struct sigaction \*

size\_t

14

rt\_sigprocmask

[rt\_sigprocmask(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigprocmask.2.en.html)

[sys\_rt\_sigprocmask](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigprocmask%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int how

sigset\_t \*set

sigset\_t \*oset

size\_t sigsetsize

15

rt\_sigreturn

[rt\_sigreturn(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigreturn.2.en.html)

[sys\_rt\_sigreturn](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigreturn%5Cb%2F&type=code)

No arguments

16

ioctl

[ioctl(2)](https://manpages.debian.org/unstable/manpages-dev/ioctl.2.en.html)

[sys\_ioctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbioctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

unsigned int cmd

unsigned long arg

17

pread64

[pread64(2)](https://manpages.debian.org/unstable/manpages-dev/pread64.2.en.html)

[sys\_pread64](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpread64%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned int fd

char \*buf

size\_t count

loff\_t pos

18

pwrite64

[pwrite64(2)](https://manpages.debian.org/unstable/manpages-dev/pwrite64.2.en.html)

[sys\_pwrite64](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpwrite64%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned int fd

const char \*buf

size\_t count

loff\_t pos

19

readv

[readv(2)](https://manpages.debian.org/unstable/manpages-dev/readv.2.en.html)

[sys\_readv](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbreadv%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long fd

const struct iovec \*vec

unsigned long vlen

20

writev

[writev(2)](https://manpages.debian.org/unstable/manpages-dev/writev.2.en.html)

[sys\_writev](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbwritev%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long fd

const struct iovec \*vec

unsigned long vlen

21

access

[access(2)](https://manpages.debian.org/unstable/manpages-dev/access.2.en.html)

[sys\_access](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbaccess%5Cb%2F&type=code)

%rdi

%rsi

const char \*filename

int mode

22

pipe

[pipe(2)](https://manpages.debian.org/unstable/manpages-dev/pipe.2.en.html)

[sys\_pipe](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpipe%5Cb%2F&type=code)

%rdi

int \*fildes

23

select

[select(2)](https://manpages.debian.org/unstable/manpages-dev/select.2.en.html)

[sys\_select](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbselect%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int n

fd\_set \*inp

fd\_set \*outp

fd\_set \*exp

struct \_\_kernel\_old\_timeval \*tvp

24

sched\_yield

[sched\_yield(2)](https://manpages.debian.org/unstable/manpages-dev/sched_yield.2.en.html)

[sys\_sched\_yield](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_yield%5Cb%2F&type=code)

No arguments

25

mremap

[mremap(2)](https://manpages.debian.org/unstable/manpages-dev/mremap.2.en.html)

[sys\_mremap](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmremap%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

unsigned long addr

unsigned long old\_len

unsigned long new\_len

unsigned long flags

unsigned long new\_addr

26

msync

[msync(2)](https://manpages.debian.org/unstable/manpages-dev/msync.2.en.html)

[sys\_msync](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmsync%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long start

size\_t len

int flags

27

mincore

[mincore(2)](https://manpages.debian.org/unstable/manpages-dev/mincore.2.en.html)

[sys\_mincore](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmincore%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long start

size\_t len

unsigned char \* vec

28

madvise

[madvise(2)](https://manpages.debian.org/unstable/manpages-dev/madvise.2.en.html)

[sys\_madvise](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmadvise%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long start

size\_t len

int behavior

29

shmget

[shmget(2)](https://manpages.debian.org/unstable/manpages-dev/shmget.2.en.html)

[sys\_shmget](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbshmget%5Cb%2F&type=code)

%rdi

%rsi

%rdx

key\_t key

size\_t size

int flag

30

shmat

[shmat(2)](https://manpages.debian.org/unstable/manpages-dev/shmat.2.en.html)

[sys\_shmat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbshmat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int shmid

char \*shmaddr

int shmflg

31

shmctl

[shmctl(2)](https://manpages.debian.org/unstable/manpages-dev/shmctl.2.en.html)

[sys\_shmctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbshmctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int shmid

int cmd

struct shmid\_ds \*buf

32

dup

[dup(2)](https://manpages.debian.org/unstable/manpages-dev/dup.2.en.html)

[sys\_dup](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbdup%5Cb%2F&type=code)

%rdi

unsigned int fildes

33

dup2

[dup2(2)](https://manpages.debian.org/unstable/manpages-dev/dup2.2.en.html)

[sys\_dup2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbdup2%5Cb%2F&type=code)

%rdi

%rsi

unsigned int oldfd

unsigned int newfd

34

pause

[pause(2)](https://manpages.debian.org/unstable/manpages-dev/pause.2.en.html)

[sys\_pause](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpause%5Cb%2F&type=code)

No arguments

35

nanosleep

[nanosleep(2)](https://manpages.debian.org/unstable/manpages-dev/nanosleep.2.en.html)

[sys\_nanosleep](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbnanosleep%5Cb%2F&type=code)

%rdi

%rsi

struct \_\_kernel\_timespec \*rqtp

struct \_\_kernel\_timespec \*rmtp

36

getitimer

[getitimer(2)](https://manpages.debian.org/unstable/manpages-dev/getitimer.2.en.html)

[sys\_getitimer](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetitimer%5Cb%2F&type=code)

%rdi

%rsi

int which

struct \_\_kernel\_old\_itimerval \*value

37

alarm

[alarm(2)](https://manpages.debian.org/unstable/manpages-dev/alarm.2.en.html)

[sys\_alarm](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbalarm%5Cb%2F&type=code)

%rdi

unsigned int seconds

38

setitimer

[setitimer(2)](https://manpages.debian.org/unstable/manpages-dev/setitimer.2.en.html)

[sys\_setitimer](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetitimer%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int which

struct \_\_kernel\_old\_itimerval \*value

struct \_\_kernel\_old\_itimerval \*ovalue

39

getpid

[getpid(2)](https://manpages.debian.org/unstable/manpages-dev/getpid.2.en.html)

[sys\_getpid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetpid%5Cb%2F&type=code)

No arguments

40

sendfile

[sendfile(2)](https://manpages.debian.org/unstable/manpages-dev/sendfile.2.en.html)

[sys\_sendfile64](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsendfile64%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int out\_fd

int in\_fd

loff\_t \*offset

size\_t count

41

socket

[socket(2)](https://manpages.debian.org/unstable/manpages-dev/socket.2.en.html)

[sys\_socket](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsocket%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int

int

int

42

connect

[connect(2)](https://manpages.debian.org/unstable/manpages-dev/connect.2.en.html)

[sys\_connect](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbconnect%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int

struct sockaddr \*

int

43

accept

[accept(2)](https://manpages.debian.org/unstable/manpages-dev/accept.2.en.html)

[sys\_accept](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbaccept%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int

struct sockaddr \*

int \*

44

sendto

[sendto(2)](https://manpages.debian.org/unstable/manpages-dev/sendto.2.en.html)

[sys\_sendto](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsendto%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int

void \*

size\_t

unsigned

struct sockaddr \*

int

45

recvfrom

[recvfrom(2)](https://manpages.debian.org/unstable/manpages-dev/recvfrom.2.en.html)

[sys\_recvfrom](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrecvfrom%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int

void \*

size\_t

unsigned

struct sockaddr \*

int \*

46

sendmsg

[sendmsg(2)](https://manpages.debian.org/unstable/manpages-dev/sendmsg.2.en.html)

[sys\_sendmsg](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsendmsg%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fd

struct user\_msghdr \*msg

unsigned flags

47

recvmsg

[recvmsg(2)](https://manpages.debian.org/unstable/manpages-dev/recvmsg.2.en.html)

[sys\_recvmsg](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrecvmsg%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fd

struct user\_msghdr \*msg

unsigned flags

48

shutdown

[shutdown(2)](https://manpages.debian.org/unstable/manpages-dev/shutdown.2.en.html)

[sys\_shutdown](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbshutdown%5Cb%2F&type=code)

%rdi

%rsi

int

int

49

bind

[bind(2)](https://manpages.debian.org/unstable/manpages-dev/bind.2.en.html)

[sys\_bind](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbbind%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int

struct sockaddr \*

int

50

listen

[listen(2)](https://manpages.debian.org/unstable/manpages-dev/listen.2.en.html)

[sys\_listen](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblisten%5Cb%2F&type=code)

%rdi

%rsi

int

int

51

getsockname

[getsockname(2)](https://manpages.debian.org/unstable/manpages-dev/getsockname.2.en.html)

[sys\_getsockname](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetsockname%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int

struct sockaddr \*

int \*

52

getpeername

[getpeername(2)](https://manpages.debian.org/unstable/manpages-dev/getpeername.2.en.html)

[sys\_getpeername](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetpeername%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int

struct sockaddr \*

int \*

53

socketpair

[socketpair(2)](https://manpages.debian.org/unstable/manpages-dev/socketpair.2.en.html)

[sys\_socketpair](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsocketpair%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int

int

int

int \*

54

setsockopt

[setsockopt(2)](https://manpages.debian.org/unstable/manpages-dev/setsockopt.2.en.html)

[sys\_setsockopt](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetsockopt%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int fd

int level

int optname

char \*optval

int optlen

55

getsockopt

[getsockopt(2)](https://manpages.debian.org/unstable/manpages-dev/getsockopt.2.en.html)

[sys\_getsockopt](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetsockopt%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int fd

int level

int optname

char \*optval

int \*optlen

56

clone

[clone(2)](https://manpages.debian.org/unstable/manpages-dev/clone.2.en.html)

[sys\_clone](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclone%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

unsigned long

unsigned long

int \*

unsigned long

int \*

57

fork

[fork(2)](https://manpages.debian.org/unstable/manpages-dev/fork.2.en.html)

[sys\_fork](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfork%5Cb%2F&type=code)

No arguments

58

vfork

[vfork(2)](https://manpages.debian.org/unstable/manpages-dev/vfork.2.en.html)

[sys\_vfork](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbvfork%5Cb%2F&type=code)

No arguments

59

execve

[execve(2)](https://manpages.debian.org/unstable/manpages-dev/execve.2.en.html)

[sys\_execve](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbexecve%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*filename

const char \*const \*argv

const char \*const \*envp

60

exit

[exit(2)](https://manpages.debian.org/unstable/manpages-dev/exit.2.en.html)

[sys\_exit](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbexit%5Cb%2F&type=code)

%rdi

int error\_code

61

wait4

[wait4(2)](https://manpages.debian.org/unstable/manpages-dev/wait4.2.en.html)

[sys\_wait4](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbwait4%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

pid\_t pid

int \*stat\_addr

int options

struct rusage \*ru

62

kill

[kill(2)](https://manpages.debian.org/unstable/manpages-dev/kill.2.en.html)

[sys\_kill](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbkill%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

int sig

63

uname

[uname(2)](https://manpages.debian.org/unstable/manpages-dev/uname.2.en.html)

[sys\_newuname](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbnewuname%5Cb%2F&type=code)

%rdi

struct new\_utsname \*name

64

semget

[semget(2)](https://manpages.debian.org/unstable/manpages-dev/semget.2.en.html)

[sys\_semget](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsemget%5Cb%2F&type=code)

%rdi

%rsi

%rdx

key\_t key

int nsems

int semflg

65

semop

[semop(2)](https://manpages.debian.org/unstable/manpages-dev/semop.2.en.html)

[sys\_semop](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsemop%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int semid

struct sembuf \*sops

unsigned nsops

66

semctl

[semctl(2)](https://manpages.debian.org/unstable/manpages-dev/semctl.2.en.html)

[sys\_semctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsemctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int semid

int semnum

int cmd

unsigned long arg

67

shmdt

[shmdt(2)](https://manpages.debian.org/unstable/manpages-dev/shmdt.2.en.html)

[sys\_shmdt](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbshmdt%5Cb%2F&type=code)

%rdi

char \*shmaddr

68

msgget

[msgget(2)](https://manpages.debian.org/unstable/manpages-dev/msgget.2.en.html)

[sys\_msgget](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmsgget%5Cb%2F&type=code)

%rdi

%rsi

key\_t key

int msgflg

69

msgsnd

[msgsnd(2)](https://manpages.debian.org/unstable/manpages-dev/msgsnd.2.en.html)

[sys\_msgsnd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmsgsnd%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int msqid

struct msgbuf \*msgp

size\_t msgsz

int msgflg

70

msgrcv

[msgrcv(2)](https://manpages.debian.org/unstable/manpages-dev/msgrcv.2.en.html)

[sys\_msgrcv](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmsgrcv%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int msqid

struct msgbuf \*msgp

size\_t msgsz

long msgtyp

int msgflg

71

msgctl

[msgctl(2)](https://manpages.debian.org/unstable/manpages-dev/msgctl.2.en.html)

[sys\_msgctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmsgctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int msqid

int cmd

struct msqid\_ds \*buf

72

fcntl

[fcntl(2)](https://manpages.debian.org/unstable/manpages-dev/fcntl.2.en.html)

[sys\_fcntl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfcntl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

unsigned int cmd

unsigned long arg

73

flock

[flock(2)](https://manpages.debian.org/unstable/manpages-dev/flock.2.en.html)

[sys\_flock](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbflock%5Cb%2F&type=code)

%rdi

%rsi

unsigned int fd

unsigned int cmd

74

fsync

[fsync(2)](https://manpages.debian.org/unstable/manpages-dev/fsync.2.en.html)

[sys\_fsync](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfsync%5Cb%2F&type=code)

%rdi

unsigned int fd

75

fdatasync

[fdatasync(2)](https://manpages.debian.org/unstable/manpages-dev/fdatasync.2.en.html)

[sys\_fdatasync](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfdatasync%5Cb%2F&type=code)

%rdi

unsigned int fd

76

truncate

[truncate(2)](https://manpages.debian.org/unstable/manpages-dev/truncate.2.en.html)

[sys\_truncate](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtruncate%5Cb%2F&type=code)

%rdi

%rsi

const char \*path

long length

77

ftruncate

[ftruncate(2)](https://manpages.debian.org/unstable/manpages-dev/ftruncate.2.en.html)

[sys\_ftruncate](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbftruncate%5Cb%2F&type=code)

%rdi

%rsi

unsigned int fd

unsigned long length

78

getdents

[getdents(2)](https://manpages.debian.org/unstable/manpages-dev/getdents.2.en.html)

[sys\_getdents](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetdents%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

struct linux\_dirent \*dirent

unsigned int count

79

getcwd

[getcwd(2)](https://manpages.debian.org/unstable/manpages-dev/getcwd.2.en.html)

[sys\_getcwd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetcwd%5Cb%2F&type=code)

%rdi

%rsi

char \*buf

unsigned long size

80

chdir

[chdir(2)](https://manpages.debian.org/unstable/manpages-dev/chdir.2.en.html)

[sys\_chdir](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbchdir%5Cb%2F&type=code)

%rdi

const char \*filename

81

fchdir

[fchdir(2)](https://manpages.debian.org/unstable/manpages-dev/fchdir.2.en.html)

[sys\_fchdir](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfchdir%5Cb%2F&type=code)

%rdi

unsigned int fd

82

rename

[rename(2)](https://manpages.debian.org/unstable/manpages-dev/rename.2.en.html)

[sys\_rename](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrename%5Cb%2F&type=code)

%rdi

%rsi

const char \*oldname

const char \*newname

83

mkdir

[mkdir(2)](https://manpages.debian.org/unstable/manpages-dev/mkdir.2.en.html)

[sys\_mkdir](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmkdir%5Cb%2F&type=code)

%rdi

%rsi

const char \*pathname

umode\_t mode

84

rmdir

[rmdir(2)](https://manpages.debian.org/unstable/manpages-dev/rmdir.2.en.html)

[sys\_rmdir](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrmdir%5Cb%2F&type=code)

%rdi

const char \*pathname

85

creat

[creat(2)](https://manpages.debian.org/unstable/manpages-dev/creat.2.en.html)

[sys\_creat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbcreat%5Cb%2F&type=code)

%rdi

%rsi

const char \*pathname

umode\_t mode

86

link

[link(2)](https://manpages.debian.org/unstable/manpages-dev/link.2.en.html)

[sys\_link](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblink%5Cb%2F&type=code)

%rdi

%rsi

const char \*oldname

const char \*newname

87

unlink

[unlink(2)](https://manpages.debian.org/unstable/manpages-dev/unlink.2.en.html)

[sys\_unlink](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbunlink%5Cb%2F&type=code)

%rdi

const char \*pathname

88

symlink

[symlink(2)](https://manpages.debian.org/unstable/manpages-dev/symlink.2.en.html)

[sys\_symlink](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsymlink%5Cb%2F&type=code)

%rdi

%rsi

const char \*old

const char \*new

89

readlink

[readlink(2)](https://manpages.debian.org/unstable/manpages-dev/readlink.2.en.html)

[sys\_readlink](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbreadlink%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*path

char \*buf

int bufsiz

90

chmod

[chmod(2)](https://manpages.debian.org/unstable/manpages-dev/chmod.2.en.html)

[sys\_chmod](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbchmod%5Cb%2F&type=code)

%rdi

%rsi

const char \*filename

umode\_t mode

91

fchmod

[fchmod(2)](https://manpages.debian.org/unstable/manpages-dev/fchmod.2.en.html)

[sys\_fchmod](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfchmod%5Cb%2F&type=code)

%rdi

%rsi

unsigned int fd

umode\_t mode

92

chown

[chown(2)](https://manpages.debian.org/unstable/manpages-dev/chown.2.en.html)

[sys\_chown](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbchown%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*filename

uid\_t user

gid\_t group

93

fchown

[fchown(2)](https://manpages.debian.org/unstable/manpages-dev/fchown.2.en.html)

[sys\_fchown](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfchown%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

uid\_t user

gid\_t group

94

lchown

[lchown(2)](https://manpages.debian.org/unstable/manpages-dev/lchown.2.en.html)

[sys\_lchown](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblchown%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*filename

uid\_t user

gid\_t group

95

umask

[umask(2)](https://manpages.debian.org/unstable/manpages-dev/umask.2.en.html)

[sys\_umask](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbumask%5Cb%2F&type=code)

%rdi

int mask

96

gettimeofday

[gettimeofday(2)](https://manpages.debian.org/unstable/manpages-dev/gettimeofday.2.en.html)

[sys\_gettimeofday](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgettimeofday%5Cb%2F&type=code)

%rdi

%rsi

struct \_\_kernel\_old\_timeval \*tv

struct timezone \*tz

97

getrlimit

[getrlimit(2)](https://manpages.debian.org/unstable/manpages-dev/getrlimit.2.en.html)

[sys\_getrlimit](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetrlimit%5Cb%2F&type=code)

%rdi

%rsi

unsigned int resource

struct rlimit \*rlim

98

getrusage

[getrusage(2)](https://manpages.debian.org/unstable/manpages-dev/getrusage.2.en.html)

[sys\_getrusage](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetrusage%5Cb%2F&type=code)

%rdi

%rsi

int who

struct rusage \*ru

99

sysinfo

[sysinfo(2)](https://manpages.debian.org/unstable/manpages-dev/sysinfo.2.en.html)

[sys\_sysinfo](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsysinfo%5Cb%2F&type=code)

%rdi

struct sysinfo \*info

100

times

[times(2)](https://manpages.debian.org/unstable/manpages-dev/times.2.en.html)

[sys\_times](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimes%5Cb%2F&type=code)

%rdi

struct tms \*tbuf

101

ptrace

[ptrace(2)](https://manpages.debian.org/unstable/manpages-dev/ptrace.2.en.html)

[sys\_ptrace](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbptrace%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

long request

long pid

unsigned long addr

unsigned long data

102

getuid

[getuid(2)](https://manpages.debian.org/unstable/manpages-dev/getuid.2.en.html)

[sys\_getuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetuid%5Cb%2F&type=code)

No arguments

103

syslog

[syslog(2)](https://manpages.debian.org/unstable/manpages-dev/syslog.2.en.html)

[sys\_syslog](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsyslog%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int type

char \*buf

int len

104

getgid

[getgid(2)](https://manpages.debian.org/unstable/manpages-dev/getgid.2.en.html)

[sys\_getgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetgid%5Cb%2F&type=code)

No arguments

105

setuid

[setuid(2)](https://manpages.debian.org/unstable/manpages-dev/setuid.2.en.html)

[sys\_setuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetuid%5Cb%2F&type=code)

%rdi

uid\_t uid

106

setgid

[setgid(2)](https://manpages.debian.org/unstable/manpages-dev/setgid.2.en.html)

[sys\_setgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetgid%5Cb%2F&type=code)

%rdi

gid\_t gid

107

geteuid

[geteuid(2)](https://manpages.debian.org/unstable/manpages-dev/geteuid.2.en.html)

[sys\_geteuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgeteuid%5Cb%2F&type=code)

No arguments

108

getegid

[getegid(2)](https://manpages.debian.org/unstable/manpages-dev/getegid.2.en.html)

[sys\_getegid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetegid%5Cb%2F&type=code)

No arguments

109

setpgid

[setpgid(2)](https://manpages.debian.org/unstable/manpages-dev/setpgid.2.en.html)

[sys\_setpgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetpgid%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

pid\_t pgid

110

getppid

[getppid(2)](https://manpages.debian.org/unstable/manpages-dev/getppid.2.en.html)

[sys\_getppid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetppid%5Cb%2F&type=code)

No arguments

111

getpgrp

[getpgrp(2)](https://manpages.debian.org/unstable/manpages-dev/getpgrp.2.en.html)

[sys\_getpgrp](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetpgrp%5Cb%2F&type=code)

No arguments

112

setsid

[setsid(2)](https://manpages.debian.org/unstable/manpages-dev/setsid.2.en.html)

[sys\_setsid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetsid%5Cb%2F&type=code)

No arguments

113

setreuid

[setreuid(2)](https://manpages.debian.org/unstable/manpages-dev/setreuid.2.en.html)

[sys\_setreuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetreuid%5Cb%2F&type=code)

%rdi

%rsi

uid\_t ruid

uid\_t euid

114

setregid

[setregid(2)](https://manpages.debian.org/unstable/manpages-dev/setregid.2.en.html)

[sys\_setregid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetregid%5Cb%2F&type=code)

%rdi

%rsi

gid\_t rgid

gid\_t egid

115

getgroups

[getgroups(2)](https://manpages.debian.org/unstable/manpages-dev/getgroups.2.en.html)

[sys\_getgroups](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetgroups%5Cb%2F&type=code)

%rdi

%rsi

int gidsetsize

gid\_t \*grouplist

116

setgroups

[setgroups(2)](https://manpages.debian.org/unstable/manpages-dev/setgroups.2.en.html)

[sys\_setgroups](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetgroups%5Cb%2F&type=code)

%rdi

%rsi

int gidsetsize

gid\_t \*grouplist

117

setresuid

[setresuid(2)](https://manpages.debian.org/unstable/manpages-dev/setresuid.2.en.html)

[sys\_setresuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetresuid%5Cb%2F&type=code)

%rdi

%rsi

%rdx

uid\_t ruid

uid\_t euid

uid\_t suid

118

getresuid

[getresuid(2)](https://manpages.debian.org/unstable/manpages-dev/getresuid.2.en.html)

[sys\_getresuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetresuid%5Cb%2F&type=code)

%rdi

%rsi

%rdx

uid\_t \*ruid

uid\_t \*euid

uid\_t \*suid

119

setresgid

[setresgid(2)](https://manpages.debian.org/unstable/manpages-dev/setresgid.2.en.html)

[sys\_setresgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetresgid%5Cb%2F&type=code)

%rdi

%rsi

%rdx

gid\_t rgid

gid\_t egid

gid\_t sgid

120

getresgid

[getresgid(2)](https://manpages.debian.org/unstable/manpages-dev/getresgid.2.en.html)

[sys\_getresgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetresgid%5Cb%2F&type=code)

%rdi

%rsi

%rdx

gid\_t \*rgid

gid\_t \*egid

gid\_t \*sgid

121

getpgid

[getpgid(2)](https://manpages.debian.org/unstable/manpages-dev/getpgid.2.en.html)

[sys\_getpgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetpgid%5Cb%2F&type=code)

%rdi

pid\_t pid

122

setfsuid

[setfsuid(2)](https://manpages.debian.org/unstable/manpages-dev/setfsuid.2.en.html)

[sys\_setfsuid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetfsuid%5Cb%2F&type=code)

%rdi

uid\_t uid

123

setfsgid

[setfsgid(2)](https://manpages.debian.org/unstable/manpages-dev/setfsgid.2.en.html)

[sys\_setfsgid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetfsgid%5Cb%2F&type=code)

%rdi

gid\_t gid

124

getsid

[getsid(2)](https://manpages.debian.org/unstable/manpages-dev/getsid.2.en.html)

[sys\_getsid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetsid%5Cb%2F&type=code)

%rdi

pid\_t pid

125

capget

[capget(2)](https://manpages.debian.org/unstable/manpages-dev/capget.2.en.html)

[sys\_capget](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbcapget%5Cb%2F&type=code)

%rdi

%rsi

cap\_user\_header\_t header

cap\_user\_data\_t dataptr

126

capset

[capset(2)](https://manpages.debian.org/unstable/manpages-dev/capset.2.en.html)

[sys\_capset](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbcapset%5Cb%2F&type=code)

%rdi

%rsi

cap\_user\_header\_t header

const cap\_user\_data\_t data

127

rt\_sigpending

[rt\_sigpending(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigpending.2.en.html)

[sys\_rt\_sigpending](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigpending%5Cb%2F&type=code)

%rdi

%rsi

sigset\_t \*set

size\_t sigsetsize

128

rt\_sigtimedwait

[rt\_sigtimedwait(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigtimedwait.2.en.html)

[sys\_rt\_sigtimedwait](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigtimedwait%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

const sigset\_t \*uthese

siginfo\_t \*uinfo

const struct \_\_kernel\_timespec \*uts

size\_t sigsetsize

129

rt\_sigqueueinfo

[rt\_sigqueueinfo(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigqueueinfo.2.en.html)

[sys\_rt\_sigqueueinfo](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigqueueinfo%5Cb%2F&type=code)

%rdi

%rsi

%rdx

pid\_t pid

int sig

siginfo\_t \*uinfo

130

rt\_sigsuspend

[rt\_sigsuspend(2)](https://manpages.debian.org/unstable/manpages-dev/rt_sigsuspend.2.en.html)

[sys\_rt\_sigsuspend](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_sigsuspend%5Cb%2F&type=code)

%rdi

%rsi

sigset\_t \*unewset

size\_t sigsetsize

131

sigaltstack

[sigaltstack(2)](https://manpages.debian.org/unstable/manpages-dev/sigaltstack.2.en.html)

[sys\_sigaltstack](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsigaltstack%5Cb%2F&type=code)

%rdi

%rsi

const struct sigaltstack \*uss

struct sigaltstack \*uoss

132

utime

[utime(2)](https://manpages.debian.org/unstable/manpages-dev/utime.2.en.html)

[sys\_utime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbutime%5Cb%2F&type=code)

%rdi

%rsi

char \*filename

struct utimbuf \*times

133

mknod

[mknod(2)](https://manpages.debian.org/unstable/manpages-dev/mknod.2.en.html)

[sys\_mknod](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmknod%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*filename

umode\_t mode

unsigned dev

134

uselib

[uselib(2)](https://manpages.debian.org/unstable/manpages-dev/uselib.2.en.html)

Not implemented

135

personality

[personality(2)](https://manpages.debian.org/unstable/manpages-dev/personality.2.en.html)

[sys\_personality](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpersonality%5Cb%2F&type=code)

%rdi

unsigned int personality

136

ustat

[ustat(2)](https://manpages.debian.org/unstable/manpages-dev/ustat.2.en.html)

[sys\_ustat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbustat%5Cb%2F&type=code)

%rdi

%rsi

unsigned dev

struct ustat \*ubuf

137

statfs

[statfs(2)](https://manpages.debian.org/unstable/manpages-dev/statfs.2.en.html)

[sys\_statfs](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbstatfs%5Cb%2F&type=code)

%rdi

%rsi

const char \* path

struct statfs \*buf

138

fstatfs

[fstatfs(2)](https://manpages.debian.org/unstable/manpages-dev/fstatfs.2.en.html)

[sys\_fstatfs](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfstatfs%5Cb%2F&type=code)

%rdi

%rsi

unsigned int fd

struct statfs \*buf

139

sysfs

[sysfs(2)](https://manpages.debian.org/unstable/manpages-dev/sysfs.2.en.html)

[sys\_sysfs](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsysfs%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int option

unsigned long arg1

unsigned long arg2

140

getpriority

[getpriority(2)](https://manpages.debian.org/unstable/manpages-dev/getpriority.2.en.html)

[sys\_getpriority](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetpriority%5Cb%2F&type=code)

%rdi

%rsi

int which

int who

141

setpriority

[setpriority(2)](https://manpages.debian.org/unstable/manpages-dev/setpriority.2.en.html)

[sys\_setpriority](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetpriority%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int which

int who

int niceval

142

sched\_setparam

[sched\_setparam(2)](https://manpages.debian.org/unstable/manpages-dev/sched_setparam.2.en.html)

[sys\_sched\_setparam](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_setparam%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

struct sched\_param \*param

143

sched\_getparam

[sched\_getparam(2)](https://manpages.debian.org/unstable/manpages-dev/sched_getparam.2.en.html)

[sys\_sched\_getparam](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_getparam%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

struct sched\_param \*param

144

sched\_setscheduler

[sched\_setscheduler(2)](https://manpages.debian.org/unstable/manpages-dev/sched_setscheduler.2.en.html)

[sys\_sched\_setscheduler](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_setscheduler%5Cb%2F&type=code)

%rdi

%rsi

%rdx

pid\_t pid

int policy

struct sched\_param \*param

145

sched\_getscheduler

[sched\_getscheduler(2)](https://manpages.debian.org/unstable/manpages-dev/sched_getscheduler.2.en.html)

[sys\_sched\_getscheduler](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_getscheduler%5Cb%2F&type=code)

%rdi

pid\_t pid

146

sched\_get\_priority\_max

[sched\_get\_priority\_max(2)](https://manpages.debian.org/unstable/manpages-dev/sched_get_priority_max.2.en.html)

[sys\_sched\_get\_priority\_max](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_get_priority_max%5Cb%2F&type=code)

%rdi

int policy

147

sched\_get\_priority\_min

[sched\_get\_priority\_min(2)](https://manpages.debian.org/unstable/manpages-dev/sched_get_priority_min.2.en.html)

[sys\_sched\_get\_priority\_min](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_get_priority_min%5Cb%2F&type=code)

%rdi

int policy

148

sched\_rr\_get\_interval

[sched\_rr\_get\_interval(2)](https://manpages.debian.org/unstable/manpages-dev/sched_rr_get_interval.2.en.html)

[sys\_sched\_rr\_get\_interval](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_rr_get_interval%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

struct \_\_kernel\_timespec \*interval

149

mlock

[mlock(2)](https://manpages.debian.org/unstable/manpages-dev/mlock.2.en.html)

[sys\_mlock](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmlock%5Cb%2F&type=code)

%rdi

%rsi

unsigned long start

size\_t len

150

munlock

[munlock(2)](https://manpages.debian.org/unstable/manpages-dev/munlock.2.en.html)

[sys\_munlock](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmunlock%5Cb%2F&type=code)

%rdi

%rsi

unsigned long start

size\_t len

151

mlockall

[mlockall(2)](https://manpages.debian.org/unstable/manpages-dev/mlockall.2.en.html)

[sys\_mlockall](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmlockall%5Cb%2F&type=code)

%rdi

int flags

152

munlockall

[munlockall(2)](https://manpages.debian.org/unstable/manpages-dev/munlockall.2.en.html)

[sys\_munlockall](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmunlockall%5Cb%2F&type=code)

No arguments

153

vhangup

[vhangup(2)](https://manpages.debian.org/unstable/manpages-dev/vhangup.2.en.html)

[sys\_vhangup](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbvhangup%5Cb%2F&type=code)

No arguments

154

modify\_ldt

[modify\_ldt(2)](https://manpages.debian.org/unstable/manpages-dev/modify_ldt.2.en.html)

[sys\_modify\_ldt](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmodify_ldt%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int func

void \*ptr

unsigned long bytecount

155

pivot\_root

[pivot\_root(2)](https://manpages.debian.org/unstable/manpages-dev/pivot_root.2.en.html)

[sys\_pivot\_root](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpivot_root%5Cb%2F&type=code)

%rdi

%rsi

const char \*new\_root

const char \*put\_old

156

\_sysctl

[\_sysctl(2)](https://manpages.debian.org/unstable/manpages-dev/_sysctl.2.en.html)

[sys\_ni\_syscall](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbni_syscall%5Cb%2F&type=code)

No arguments

157

prctl

[prctl(2)](https://manpages.debian.org/unstable/manpages-dev/prctl.2.en.html)

[sys\_prctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbprctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int option

unsigned long arg2

unsigned long arg3

unsigned long arg4

unsigned long arg5

158

arch\_prctl

[arch\_prctl(2)](https://manpages.debian.org/unstable/manpages-dev/arch_prctl.2.en.html)

[sys\_arch\_prctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbarch_prctl%5Cb%2F&type=code)

%rdi

%rsi

int option

unsigned long arg2

159

adjtimex

[adjtimex(2)](https://manpages.debian.org/unstable/manpages-dev/adjtimex.2.en.html)

[sys\_adjtimex](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbadjtimex%5Cb%2F&type=code)

%rdi

struct \_\_kernel\_timex \*txc\_p

160

setrlimit

[setrlimit(2)](https://manpages.debian.org/unstable/manpages-dev/setrlimit.2.en.html)

[sys\_setrlimit](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetrlimit%5Cb%2F&type=code)

%rdi

%rsi

unsigned int resource

struct rlimit \*rlim

161

chroot

[chroot(2)](https://manpages.debian.org/unstable/manpages-dev/chroot.2.en.html)

[sys\_chroot](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbchroot%5Cb%2F&type=code)

%rdi

const char \*filename

162

sync

[sync(2)](https://manpages.debian.org/unstable/manpages-dev/sync.2.en.html)

[sys\_sync](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsync%5Cb%2F&type=code)

No arguments

163

acct

[acct(2)](https://manpages.debian.org/unstable/manpages-dev/acct.2.en.html)

[sys\_acct](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbacct%5Cb%2F&type=code)

%rdi

const char \*name

164

settimeofday

[settimeofday(2)](https://manpages.debian.org/unstable/manpages-dev/settimeofday.2.en.html)

[sys\_settimeofday](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsettimeofday%5Cb%2F&type=code)

%rdi

%rsi

struct \_\_kernel\_old\_timeval \*tv

struct timezone \*tz

165

mount

[mount(2)](https://manpages.debian.org/unstable/manpages-dev/mount.2.en.html)

[sys\_mount](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmount%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

char \*dev\_name

char \*dir\_name

char \*type

unsigned long flags

void \*data

166

umount2

[umount2(2)](https://manpages.debian.org/unstable/manpages-dev/umount2.2.en.html)

[sys\_umount](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbumount%5Cb%2F&type=code)

%rdi

%rsi

char \*name

int flags

167

swapon

[swapon(2)](https://manpages.debian.org/unstable/manpages-dev/swapon.2.en.html)

[sys\_swapon](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbswapon%5Cb%2F&type=code)

%rdi

%rsi

const char \*specialfile

int swap\_flags

168

swapoff

[swapoff(2)](https://manpages.debian.org/unstable/manpages-dev/swapoff.2.en.html)

[sys\_swapoff](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbswapoff%5Cb%2F&type=code)

%rdi

const char \*specialfile

169

reboot

[reboot(2)](https://manpages.debian.org/unstable/manpages-dev/reboot.2.en.html)

[sys\_reboot](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbreboot%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int magic1

int magic2

unsigned int cmd

void \*arg

170

sethostname

[sethostname(2)](https://manpages.debian.org/unstable/manpages-dev/sethostname.2.en.html)

[sys\_sethostname](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsethostname%5Cb%2F&type=code)

%rdi

%rsi

char \*name

int len

171

setdomainname

[setdomainname(2)](https://manpages.debian.org/unstable/manpages-dev/setdomainname.2.en.html)

[sys\_setdomainname](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetdomainname%5Cb%2F&type=code)

%rdi

%rsi

char \*name

int len

172

iopl

[iopl(2)](https://manpages.debian.org/unstable/manpages-dev/iopl.2.en.html)

[sys\_iopl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbiopl%5Cb%2F&type=code)

%rdi

unsigned int level

173

ioperm

[ioperm(2)](https://manpages.debian.org/unstable/manpages-dev/ioperm.2.en.html)

[sys\_ioperm](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbioperm%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long from

unsigned long num

int on

174

create\_module

[create\_module(2)](https://manpages.debian.org/unstable/manpages-dev/create_module.2.en.html)

Not implemented

175

init\_module

[init\_module(2)](https://manpages.debian.org/unstable/manpages-dev/init_module.2.en.html)

[sys\_init\_module](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbinit_module%5Cb%2F&type=code)

%rdi

%rsi

%rdx

void \*umod

unsigned long len

const char \*uargs

176

delete\_module

[delete\_module(2)](https://manpages.debian.org/unstable/manpages-dev/delete_module.2.en.html)

[sys\_delete\_module](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbdelete_module%5Cb%2F&type=code)

%rdi

%rsi

const char \*name\_user

unsigned int flags

177

get\_kernel\_syms

[get\_kernel\_syms(2)](https://manpages.debian.org/unstable/manpages-dev/get_kernel_syms.2.en.html)

Not implemented

178

query\_module

[query\_module(2)](https://manpages.debian.org/unstable/manpages-dev/query_module.2.en.html)

Not implemented

179

quotactl

[quotactl(2)](https://manpages.debian.org/unstable/manpages-dev/quotactl.2.en.html)

[sys\_quotactl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbquotactl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned int cmd

const char \*special

qid\_t id

void \*addr

180

nfsservctl

[nfsservctl(2)](https://manpages.debian.org/unstable/manpages-dev/nfsservctl.2.en.html)

Not implemented

181

getpmsg

[getpmsg(2)](https://manpages.debian.org/unstable/manpages-dev/getpmsg.2.en.html)

Not implemented

182

putpmsg

[putpmsg(2)](https://manpages.debian.org/unstable/manpages-dev/putpmsg.2.en.html)

Not implemented

183

afs\_syscall

[afs\_syscall(2)](https://manpages.debian.org/unstable/manpages-dev/afs_syscall.2.en.html)

Not implemented

184

tuxcall

[tuxcall(2)](https://manpages.debian.org/unstable/manpages-dev/tuxcall.2.en.html)

Not implemented

185

security

[security(2)](https://manpages.debian.org/unstable/manpages-dev/security.2.en.html)

Not implemented

186

gettid

[gettid(2)](https://manpages.debian.org/unstable/manpages-dev/gettid.2.en.html)

[sys\_gettid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgettid%5Cb%2F&type=code)

No arguments

187

readahead

[readahead(2)](https://manpages.debian.org/unstable/manpages-dev/readahead.2.en.html)

[sys\_readahead](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbreadahead%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fd

loff\_t offset

size\_t count

188

setxattr

[setxattr(2)](https://manpages.debian.org/unstable/manpages-dev/setxattr.2.en.html)

[sys\_setxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

const char \*path

const char \*name

const void \*value

size\_t size

int flags

189

lsetxattr

[lsetxattr(2)](https://manpages.debian.org/unstable/manpages-dev/lsetxattr.2.en.html)

[sys\_lsetxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblsetxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

const char \*path

const char \*name

const void \*value

size\_t size

int flags

190

fsetxattr

[fsetxattr(2)](https://manpages.debian.org/unstable/manpages-dev/fsetxattr.2.en.html)

[sys\_fsetxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfsetxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int fd

const char \*name

const void \*value

size\_t size

int flags

191

getxattr

[getxattr(2)](https://manpages.debian.org/unstable/manpages-dev/getxattr.2.en.html)

[sys\_getxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

const char \*path

const char \*name

void \*value

size\_t size

192

lgetxattr

[lgetxattr(2)](https://manpages.debian.org/unstable/manpages-dev/lgetxattr.2.en.html)

[sys\_lgetxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblgetxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

const char \*path

const char \*name

void \*value

size\_t size

193

fgetxattr

[fgetxattr(2)](https://manpages.debian.org/unstable/manpages-dev/fgetxattr.2.en.html)

[sys\_fgetxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfgetxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fd

const char \*name

void \*value

size\_t size

194

listxattr

[listxattr(2)](https://manpages.debian.org/unstable/manpages-dev/listxattr.2.en.html)

[sys\_listxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblistxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*path

char \*list

size\_t size

195

llistxattr

[llistxattr(2)](https://manpages.debian.org/unstable/manpages-dev/llistxattr.2.en.html)

[sys\_llistxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbllistxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \*path

char \*list

size\_t size

196

flistxattr

[flistxattr(2)](https://manpages.debian.org/unstable/manpages-dev/flistxattr.2.en.html)

[sys\_flistxattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbflistxattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fd

char \*list

size\_t size

197

removexattr

[removexattr(2)](https://manpages.debian.org/unstable/manpages-dev/removexattr.2.en.html)

[sys\_removexattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbremovexattr%5Cb%2F&type=code)

%rdi

%rsi

const char \*path

const char \*name

198

lremovexattr

[lremovexattr(2)](https://manpages.debian.org/unstable/manpages-dev/lremovexattr.2.en.html)

[sys\_lremovexattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblremovexattr%5Cb%2F&type=code)

%rdi

%rsi

const char \*path

const char \*name

199

fremovexattr

[fremovexattr(2)](https://manpages.debian.org/unstable/manpages-dev/fremovexattr.2.en.html)

[sys\_fremovexattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfremovexattr%5Cb%2F&type=code)

%rdi

%rsi

int fd

const char \*name

200

tkill

[tkill(2)](https://manpages.debian.org/unstable/manpages-dev/tkill.2.en.html)

[sys\_tkill](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtkill%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

int sig

201

time

[time(2)](https://manpages.debian.org/unstable/manpages-dev/time.2.en.html)

[sys\_time](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtime%5Cb%2F&type=code)

%rdi

\_\_kernel\_old\_time\_t \*tloc

202

futex

[futex(2)](https://manpages.debian.org/unstable/manpages-dev/futex.2.en.html)

[sys\_futex](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfutex%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

u32 \*uaddr

int op

u32 val

const struct \_\_kernel\_timespec \*utime

u32 \*uaddr2

u32 val3

203

sched\_setaffinity

[sched\_setaffinity(2)](https://manpages.debian.org/unstable/manpages-dev/sched_setaffinity.2.en.html)

[sys\_sched\_setaffinity](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_setaffinity%5Cb%2F&type=code)

%rdi

%rsi

%rdx

pid\_t pid

unsigned int len

unsigned long \*user\_mask\_ptr

204

sched\_getaffinity

[sched\_getaffinity(2)](https://manpages.debian.org/unstable/manpages-dev/sched_getaffinity.2.en.html)

[sys\_sched\_getaffinity](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_getaffinity%5Cb%2F&type=code)

%rdi

%rsi

%rdx

pid\_t pid

unsigned int len

unsigned long \*user\_mask\_ptr

205

set\_thread\_area

[set\_thread\_area(2)](https://manpages.debian.org/unstable/manpages-dev/set_thread_area.2.en.html)

Not implemented

206

io\_setup

[io\_setup(2)](https://manpages.debian.org/unstable/manpages-dev/io_setup.2.en.html)

[sys\_io\_setup](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_setup%5Cb%2F&type=code)

%rdi

%rsi

unsigned nr\_reqs

aio\_context\_t \*ctx

207

io\_destroy

[io\_destroy(2)](https://manpages.debian.org/unstable/manpages-dev/io_destroy.2.en.html)

[sys\_io\_destroy](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_destroy%5Cb%2F&type=code)

%rdi

aio\_context\_t ctx

208

io\_getevents

[io\_getevents(2)](https://manpages.debian.org/unstable/manpages-dev/io_getevents.2.en.html)

[sys\_io\_getevents](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_getevents%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

aio\_context\_t ctx\_id

long min\_nr

long nr

struct io\_event \*events

struct \_\_kernel\_timespec \*timeout

209

io\_submit

[io\_submit(2)](https://manpages.debian.org/unstable/manpages-dev/io_submit.2.en.html)

[sys\_io\_submit](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_submit%5Cb%2F&type=code)

%rdi

%rsi

%rdx

aio\_context\_t

long

struct iocb \* \*

210

io\_cancel

[io\_cancel(2)](https://manpages.debian.org/unstable/manpages-dev/io_cancel.2.en.html)

[sys\_io\_cancel](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_cancel%5Cb%2F&type=code)

%rdi

%rsi

%rdx

aio\_context\_t ctx\_id

struct iocb \*iocb

struct io\_event \*result

211

get\_thread\_area

[get\_thread\_area(2)](https://manpages.debian.org/unstable/manpages-dev/get_thread_area.2.en.html)

Not implemented

212

lookup\_dcookie

[lookup\_dcookie(2)](https://manpages.debian.org/unstable/manpages-dev/lookup_dcookie.2.en.html)

Not implemented

213

epoll\_create

[epoll\_create(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_create.2.en.html)

[sys\_epoll\_create](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbepoll_create%5Cb%2F&type=code)

%rdi

int size

214

epoll\_ctl\_old

[epoll\_ctl\_old(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_ctl_old.2.en.html)

Not implemented

215

epoll\_wait\_old

[epoll\_wait\_old(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_wait_old.2.en.html)

Not implemented

216

remap\_file\_pages

[remap\_file\_pages(2)](https://manpages.debian.org/unstable/manpages-dev/remap_file_pages.2.en.html)

[sys\_remap\_file\_pages](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbremap_file_pages%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

unsigned long start

unsigned long size

unsigned long prot

unsigned long pgoff

unsigned long flags

217

getdents64

[getdents64(2)](https://manpages.debian.org/unstable/manpages-dev/getdents64.2.en.html)

[sys\_getdents64](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetdents64%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

struct linux\_dirent64 \*dirent

unsigned int count

218

set\_tid\_address

[set\_tid\_address(2)](https://manpages.debian.org/unstable/manpages-dev/set_tid_address.2.en.html)

[sys\_set\_tid\_address](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbset_tid_address%5Cb%2F&type=code)

%rdi

int \*tidptr

219

restart\_syscall

[restart\_syscall(2)](https://manpages.debian.org/unstable/manpages-dev/restart_syscall.2.en.html)

[sys\_restart\_syscall](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrestart_syscall%5Cb%2F&type=code)

No arguments

220

semtimedop

[semtimedop(2)](https://manpages.debian.org/unstable/manpages-dev/semtimedop.2.en.html)

[sys\_semtimedop](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsemtimedop%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int semid

struct sembuf \*sops

unsigned nsops

const struct \_\_kernel\_timespec \*timeout

221

fadvise64

[fadvise64(2)](https://manpages.debian.org/unstable/manpages-dev/fadvise64.2.en.html)

[sys\_fadvise64](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfadvise64%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fd

loff\_t offset

size\_t len

int advice

222

timer\_create

[timer\_create(2)](https://manpages.debian.org/unstable/manpages-dev/timer_create.2.en.html)

[sys\_timer\_create](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimer_create%5Cb%2F&type=code)

%rdi

%rsi

%rdx

clockid\_t which\_clock

struct sigevent \*timer\_event\_spec

timer\_t \* created\_timer\_id

223

timer\_settime

[timer\_settime(2)](https://manpages.debian.org/unstable/manpages-dev/timer_settime.2.en.html)

[sys\_timer\_settime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimer_settime%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

timer\_t timer\_id

int flags

const struct \_\_kernel\_itimerspec \*new\_setting

struct \_\_kernel\_itimerspec \*old\_setting

224

timer\_gettime

[timer\_gettime(2)](https://manpages.debian.org/unstable/manpages-dev/timer_gettime.2.en.html)

[sys\_timer\_gettime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimer_gettime%5Cb%2F&type=code)

%rdi

%rsi

timer\_t timer\_id

struct \_\_kernel\_itimerspec \*setting

225

timer\_getoverrun

[timer\_getoverrun(2)](https://manpages.debian.org/unstable/manpages-dev/timer_getoverrun.2.en.html)

[sys\_timer\_getoverrun](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimer_getoverrun%5Cb%2F&type=code)

%rdi

timer\_t timer\_id

226

timer\_delete

[timer\_delete(2)](https://manpages.debian.org/unstable/manpages-dev/timer_delete.2.en.html)

[sys\_timer\_delete](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimer_delete%5Cb%2F&type=code)

%rdi

timer\_t timer\_id

227

clock\_settime

[clock\_settime(2)](https://manpages.debian.org/unstable/manpages-dev/clock_settime.2.en.html)

[sys\_clock\_settime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclock_settime%5Cb%2F&type=code)

%rdi

%rsi

clockid\_t which\_clock

const struct \_\_kernel\_timespec \*tp

228

clock\_gettime

[clock\_gettime(2)](https://manpages.debian.org/unstable/manpages-dev/clock_gettime.2.en.html)

[sys\_clock\_gettime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclock_gettime%5Cb%2F&type=code)

%rdi

%rsi

clockid\_t which\_clock

struct \_\_kernel\_timespec \*tp

229

clock\_getres

[clock\_getres(2)](https://manpages.debian.org/unstable/manpages-dev/clock_getres.2.en.html)

[sys\_clock\_getres](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclock_getres%5Cb%2F&type=code)

%rdi

%rsi

clockid\_t which\_clock

struct \_\_kernel\_timespec \*tp

230

clock\_nanosleep

[clock\_nanosleep(2)](https://manpages.debian.org/unstable/manpages-dev/clock_nanosleep.2.en.html)

[sys\_clock\_nanosleep](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclock_nanosleep%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

clockid\_t which\_clock

int flags

const struct \_\_kernel\_timespec \*rqtp

struct \_\_kernel\_timespec \*rmtp

231

exit\_group

[exit\_group(2)](https://manpages.debian.org/unstable/manpages-dev/exit_group.2.en.html)

[sys\_exit\_group](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbexit_group%5Cb%2F&type=code)

%rdi

int error\_code

232

epoll\_wait

[epoll\_wait(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_wait.2.en.html)

[sys\_epoll\_wait](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbepoll_wait%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int epfd

struct epoll\_event \*events

int maxevents

int timeout

233

epoll\_ctl

[epoll\_ctl(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_ctl.2.en.html)

[sys\_epoll\_ctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbepoll_ctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int epfd

int op

int fd

struct epoll\_event \*event

234

tgkill

[tgkill(2)](https://manpages.debian.org/unstable/manpages-dev/tgkill.2.en.html)

[sys\_tgkill](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtgkill%5Cb%2F&type=code)

%rdi

%rsi

%rdx

pid\_t tgid

pid\_t pid

int sig

235

utimes

[utimes(2)](https://manpages.debian.org/unstable/manpages-dev/utimes.2.en.html)

[sys\_utimes](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbutimes%5Cb%2F&type=code)

%rdi

%rsi

char \*filename

struct \_\_kernel\_old\_timeval \*utimes

236

vserver

[vserver(2)](https://manpages.debian.org/unstable/manpages-dev/vserver.2.en.html)

Not implemented

237

mbind

[mbind(2)](https://manpages.debian.org/unstable/manpages-dev/mbind.2.en.html)

[sys\_mbind](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmbind%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

unsigned long start

unsigned long len

unsigned long mode

const unsigned long \*nmask

unsigned long maxnode

unsigned flags

238

set\_mempolicy

[set\_mempolicy(2)](https://manpages.debian.org/unstable/manpages-dev/set_mempolicy.2.en.html)

[sys\_set\_mempolicy](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbset_mempolicy%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int mode

const unsigned long \*nmask

unsigned long maxnode

239

get\_mempolicy

[get\_mempolicy(2)](https://manpages.debian.org/unstable/manpages-dev/get_mempolicy.2.en.html)

[sys\_get\_mempolicy](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbget_mempolicy%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int \*policy

unsigned long \*nmask

unsigned long maxnode

unsigned long addr

unsigned long flags

240

mq\_open

[mq\_open(2)](https://manpages.debian.org/unstable/manpages-dev/mq_open.2.en.html)

[sys\_mq\_open](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmq_open%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

const char \*name

int oflag

umode\_t mode

struct mq\_attr \*attr

241

mq\_unlink

[mq\_unlink(2)](https://manpages.debian.org/unstable/manpages-dev/mq_unlink.2.en.html)

[sys\_mq\_unlink](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmq_unlink%5Cb%2F&type=code)

%rdi

const char \*name

242

mq\_timedsend

[mq\_timedsend(2)](https://manpages.debian.org/unstable/manpages-dev/mq_timedsend.2.en.html)

[sys\_mq\_timedsend](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmq_timedsend%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

mqd\_t mqdes

const char \*msg\_ptr

size\_t msg\_len

unsigned int msg\_prio

const struct \_\_kernel\_timespec \*abs\_timeout

243

mq\_timedreceive

[mq\_timedreceive(2)](https://manpages.debian.org/unstable/manpages-dev/mq_timedreceive.2.en.html)

[sys\_mq\_timedreceive](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmq_timedreceive%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

mqd\_t mqdes

char \*msg\_ptr

size\_t msg\_len

unsigned int \*msg\_prio

const struct \_\_kernel\_timespec \*abs\_timeout

244

mq\_notify

[mq\_notify(2)](https://manpages.debian.org/unstable/manpages-dev/mq_notify.2.en.html)

[sys\_mq\_notify](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmq_notify%5Cb%2F&type=code)

%rdi

%rsi

mqd\_t mqdes

const struct sigevent \*notification

245

mq\_getsetattr

[mq\_getsetattr(2)](https://manpages.debian.org/unstable/manpages-dev/mq_getsetattr.2.en.html)

[sys\_mq\_getsetattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmq_getsetattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

mqd\_t mqdes

const struct mq\_attr \*mqstat

struct mq\_attr \*omqstat

246

kexec\_load

[kexec\_load(2)](https://manpages.debian.org/unstable/manpages-dev/kexec_load.2.en.html)

[sys\_kexec\_load](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbkexec_load%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned long entry

unsigned long nr\_segments

struct kexec\_segment \*segments

unsigned long flags

247

waitid

[waitid(2)](https://manpages.debian.org/unstable/manpages-dev/waitid.2.en.html)

[sys\_waitid](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbwaitid%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int which

pid\_t pid

struct siginfo \*infop

int options

struct rusage \*ru

248

add\_key

[add\_key(2)](https://manpages.debian.org/unstable/manpages-dev/add_key.2.en.html)

[sys\_add\_key](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbadd_key%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

const char \*\_type

const char \*\_description

const void \*\_payload

size\_t plen

key\_serial\_t destringid

249

request\_key

[request\_key(2)](https://manpages.debian.org/unstable/manpages-dev/request_key.2.en.html)

[sys\_request\_key](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrequest_key%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

const char \*\_type

const char \*\_description

const char \*\_callout\_info

key\_serial\_t destringid

250

keyctl

[keyctl(2)](https://manpages.debian.org/unstable/manpages-dev/keyctl.2.en.html)

[sys\_keyctl](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbkeyctl%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int cmd

unsigned long arg2

unsigned long arg3

unsigned long arg4

unsigned long arg5

251

ioprio\_set

[ioprio\_set(2)](https://manpages.debian.org/unstable/manpages-dev/ioprio_set.2.en.html)

[sys\_ioprio\_set](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbioprio_set%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int which

int who

int ioprio

252

ioprio\_get

[ioprio\_get(2)](https://manpages.debian.org/unstable/manpages-dev/ioprio_get.2.en.html)

[sys\_ioprio\_get](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbioprio_get%5Cb%2F&type=code)

%rdi

%rsi

int which

int who

253

inotify\_init

[inotify\_init(2)](https://manpages.debian.org/unstable/manpages-dev/inotify_init.2.en.html)

[sys\_inotify\_init](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbinotify_init%5Cb%2F&type=code)

No arguments

254

inotify\_add\_watch

[inotify\_add\_watch(2)](https://manpages.debian.org/unstable/manpages-dev/inotify_add_watch.2.en.html)

[sys\_inotify\_add\_watch](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbinotify_add_watch%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fd

const char \*path

u32 mask

255

inotify\_rm\_watch

[inotify\_rm\_watch(2)](https://manpages.debian.org/unstable/manpages-dev/inotify_rm_watch.2.en.html)

[sys\_inotify\_rm\_watch](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbinotify_rm_watch%5Cb%2F&type=code)

%rdi

%rsi

int fd

\_\_s32 wd

256

migrate\_pages

[migrate\_pages(2)](https://manpages.debian.org/unstable/manpages-dev/migrate_pages.2.en.html)

[sys\_migrate\_pages](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmigrate_pages%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

pid\_t pid

unsigned long maxnode

const unsigned long \*from

const unsigned long \*to

257

openat

[openat(2)](https://manpages.debian.org/unstable/manpages-dev/openat.2.en.html)

[sys\_openat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbopenat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*filename

int flags

umode\_t mode

258

mkdirat

[mkdirat(2)](https://manpages.debian.org/unstable/manpages-dev/mkdirat.2.en.html)

[sys\_mkdirat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmkdirat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \* pathname

umode\_t mode

259

mknodat

[mknodat(2)](https://manpages.debian.org/unstable/manpages-dev/mknodat.2.en.html)

[sys\_mknodat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmknodat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \* filename

umode\_t mode

unsigned dev

260

fchownat

[fchownat(2)](https://manpages.debian.org/unstable/manpages-dev/fchownat.2.en.html)

[sys\_fchownat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfchownat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int dfd

const char \*filename

uid\_t user

gid\_t group

int flag

261

futimesat

[futimesat(2)](https://manpages.debian.org/unstable/manpages-dev/futimesat.2.en.html)

[sys\_futimesat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfutimesat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \*filename

struct \_\_kernel\_old\_timeval \*utimes

262

newfstatat

[newfstatat(2)](https://manpages.debian.org/unstable/manpages-dev/newfstatat.2.en.html)

[sys\_newfstatat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbnewfstatat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*filename

struct stat \*statbuf

int flag

263

unlinkat

[unlinkat(2)](https://manpages.debian.org/unstable/manpages-dev/unlinkat.2.en.html)

[sys\_unlinkat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbunlinkat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \* pathname

int flag

264

renameat

[renameat(2)](https://manpages.debian.org/unstable/manpages-dev/renameat.2.en.html)

[sys\_renameat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrenameat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int olddfd

const char \* oldname

int newdfd

const char \* newname

265

linkat

[linkat(2)](https://manpages.debian.org/unstable/manpages-dev/linkat.2.en.html)

[sys\_linkat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblinkat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int olddfd

const char \*oldname

int newdfd

const char \*newname

int flags

266

symlinkat

[symlinkat(2)](https://manpages.debian.org/unstable/manpages-dev/symlinkat.2.en.html)

[sys\_symlinkat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsymlinkat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const char \* oldname

int newdfd

const char \* newname

267

readlinkat

[readlinkat(2)](https://manpages.debian.org/unstable/manpages-dev/readlinkat.2.en.html)

[sys\_readlinkat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbreadlinkat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*path

char \*buf

int bufsiz

268

fchmodat

[fchmodat(2)](https://manpages.debian.org/unstable/manpages-dev/fchmodat.2.en.html)

[sys\_fchmodat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfchmodat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \*filename

umode\_t mode

269

faccessat

[faccessat(2)](https://manpages.debian.org/unstable/manpages-dev/faccessat.2.en.html)

[sys\_faccessat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfaccessat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \*filename

int mode

270

pselect6

[pselect6(2)](https://manpages.debian.org/unstable/manpages-dev/pselect6.2.en.html)

[sys\_pselect6](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpselect6%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int

fd\_set \*

fd\_set \*

fd\_set \*

struct \_\_kernel\_timespec \*

void \*

271

ppoll

[ppoll(2)](https://manpages.debian.org/unstable/manpages-dev/ppoll.2.en.html)

[sys\_ppoll](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbppoll%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

struct pollfd \*

unsigned int

struct \_\_kernel\_timespec \*

const sigset\_t \*

size\_t

272

unshare

[unshare(2)](https://manpages.debian.org/unstable/manpages-dev/unshare.2.en.html)

[sys\_unshare](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbunshare%5Cb%2F&type=code)

%rdi

unsigned long unshare\_flags

273

set\_robust\_list

[set\_robust\_list(2)](https://manpages.debian.org/unstable/manpages-dev/set_robust_list.2.en.html)

[sys\_set\_robust\_list](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbset_robust_list%5Cb%2F&type=code)

%rdi

%rsi

struct robust\_list\_head \*head

size\_t len

274

get\_robust\_list

[get\_robust\_list(2)](https://manpages.debian.org/unstable/manpages-dev/get_robust_list.2.en.html)

[sys\_get\_robust\_list](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbget_robust_list%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int pid

struct robust\_list\_head \* \*head\_ptr

size\_t \*len\_ptr

275

splice

[splice(2)](https://manpages.debian.org/unstable/manpages-dev/splice.2.en.html)

[sys\_splice](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsplice%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int fd\_in

loff\_t \*off\_in

int fd\_out

loff\_t \*off\_out

size\_t len

unsigned int flags

276

tee

[tee(2)](https://manpages.debian.org/unstable/manpages-dev/tee.2.en.html)

[sys\_tee](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtee%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fdin

int fdout

size\_t len

unsigned int flags

277

sync\_file\_range

[sync\_file\_range(2)](https://manpages.debian.org/unstable/manpages-dev/sync_file_range.2.en.html)

[sys\_sync\_file\_range](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsync_file_range%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fd

loff\_t offset

loff\_t nbytes

unsigned int flags

278

vmsplice

[vmsplice(2)](https://manpages.debian.org/unstable/manpages-dev/vmsplice.2.en.html)

[sys\_vmsplice](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbvmsplice%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fd

const struct iovec \*iov

unsigned long nr\_segs

unsigned int flags

279

move\_pages

[move\_pages(2)](https://manpages.debian.org/unstable/manpages-dev/move_pages.2.en.html)

[sys\_move\_pages](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmove_pages%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

pid\_t pid

unsigned long nr\_pages

const void \* \*pages

const int \*nodes

int \*status

int flags

280

utimensat

[utimensat(2)](https://manpages.debian.org/unstable/manpages-dev/utimensat.2.en.html)

[sys\_utimensat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbutimensat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*filename

struct \_\_kernel\_timespec \*utimes

int flags

281

epoll\_pwait

[epoll\_pwait(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_pwait.2.en.html)

[sys\_epoll\_pwait](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbepoll_pwait%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int epfd

struct epoll\_event \*events

int maxevents

int timeout

const sigset\_t \*sigmask

size\_t sigsetsize

282

signalfd

[signalfd(2)](https://manpages.debian.org/unstable/manpages-dev/signalfd.2.en.html)

[sys\_signalfd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsignalfd%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int ufd

sigset\_t \*user\_mask

size\_t sizemask

283

timerfd\_create

[timerfd\_create(2)](https://manpages.debian.org/unstable/manpages-dev/timerfd_create.2.en.html)

[sys\_timerfd\_create](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimerfd_create%5Cb%2F&type=code)

%rdi

%rsi

int clockid

int flags

284

eventfd

[eventfd(2)](https://manpages.debian.org/unstable/manpages-dev/eventfd.2.en.html)

[sys\_eventfd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbeventfd%5Cb%2F&type=code)

%rdi

unsigned int count

285

fallocate

[fallocate(2)](https://manpages.debian.org/unstable/manpages-dev/fallocate.2.en.html)

[sys\_fallocate](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfallocate%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fd

int mode

loff\_t offset

loff\_t len

286

timerfd\_settime

[timerfd\_settime(2)](https://manpages.debian.org/unstable/manpages-dev/timerfd_settime.2.en.html)

[sys\_timerfd\_settime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimerfd_settime%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int ufd

int flags

const struct \_\_kernel\_itimerspec \*utmr

struct \_\_kernel\_itimerspec \*otmr

287

timerfd\_gettime

[timerfd\_gettime(2)](https://manpages.debian.org/unstable/manpages-dev/timerfd_gettime.2.en.html)

[sys\_timerfd\_gettime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbtimerfd_gettime%5Cb%2F&type=code)

%rdi

%rsi

int ufd

struct \_\_kernel\_itimerspec \*otmr

288

accept4

[accept4(2)](https://manpages.debian.org/unstable/manpages-dev/accept4.2.en.html)

[sys\_accept4](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbaccept4%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int

struct sockaddr \*

int \*

int

289

signalfd4

[signalfd4(2)](https://manpages.debian.org/unstable/manpages-dev/signalfd4.2.en.html)

[sys\_signalfd4](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsignalfd4%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int ufd

sigset\_t \*user\_mask

size\_t sizemask

int flags

290

eventfd2

[eventfd2(2)](https://manpages.debian.org/unstable/manpages-dev/eventfd2.2.en.html)

[sys\_eventfd2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbeventfd2%5Cb%2F&type=code)

%rdi

%rsi

unsigned int count

int flags

291

epoll\_create1

[epoll\_create1(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_create1.2.en.html)

[sys\_epoll\_create1](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbepoll_create1%5Cb%2F&type=code)

%rdi

int flags

292

dup3

[dup3(2)](https://manpages.debian.org/unstable/manpages-dev/dup3.2.en.html)

[sys\_dup3](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbdup3%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int oldfd

unsigned int newfd

int flags

293

pipe2

[pipe2(2)](https://manpages.debian.org/unstable/manpages-dev/pipe2.2.en.html)

[sys\_pipe2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpipe2%5Cb%2F&type=code)

%rdi

%rsi

int \*fildes

int flags

294

inotify\_init1

[inotify\_init1(2)](https://manpages.debian.org/unstable/manpages-dev/inotify_init1.2.en.html)

[sys\_inotify\_init1](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbinotify_init1%5Cb%2F&type=code)

%rdi

int flags

295

preadv

[preadv(2)](https://manpages.debian.org/unstable/manpages-dev/preadv.2.en.html)

[sys\_preadv](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpreadv%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

unsigned long fd

const struct iovec \*vec

unsigned long vlen

unsigned long pos\_l

unsigned long pos\_h

296

pwritev

[pwritev(2)](https://manpages.debian.org/unstable/manpages-dev/pwritev.2.en.html)

[sys\_pwritev](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpwritev%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

unsigned long fd

const struct iovec \*vec

unsigned long vlen

unsigned long pos\_l

unsigned long pos\_h

297

rt\_tgsigqueueinfo

[rt\_tgsigqueueinfo(2)](https://manpages.debian.org/unstable/manpages-dev/rt_tgsigqueueinfo.2.en.html)

[sys\_rt\_tgsigqueueinfo](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrt_tgsigqueueinfo%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

pid\_t tgid

pid\_t pid

int sig

siginfo\_t \*uinfo

298

perf\_event\_open

[perf\_event\_open(2)](https://manpages.debian.org/unstable/manpages-dev/perf_event_open.2.en.html)

[sys\_perf\_event\_open](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbperf_event_open%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

struct perf\_event\_attr \*attr\_uptr

pid\_t pid

int cpu

int group\_fd

unsigned long flags

299

recvmmsg

[recvmmsg(2)](https://manpages.debian.org/unstable/manpages-dev/recvmmsg.2.en.html)

[sys\_recvmmsg](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrecvmmsg%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int fd

struct mmsghdr \*msg

unsigned int vlen

unsigned flags

struct \_\_kernel\_timespec \*timeout

300

fanotify\_init

[fanotify\_init(2)](https://manpages.debian.org/unstable/manpages-dev/fanotify_init.2.en.html)

[sys\_fanotify\_init](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfanotify_init%5Cb%2F&type=code)

%rdi

%rsi

unsigned int flags

unsigned int event\_f\_flags

301

fanotify\_mark

[fanotify\_mark(2)](https://manpages.debian.org/unstable/manpages-dev/fanotify_mark.2.en.html)

[sys\_fanotify\_mark](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfanotify_mark%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int fanotify\_fd

unsigned int flags

u64 mask

int fd

const char \*pathname

302

prlimit64

[prlimit64(2)](https://manpages.debian.org/unstable/manpages-dev/prlimit64.2.en.html)

[sys\_prlimit64](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbprlimit64%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

pid\_t pid

unsigned int resource

const struct rlimit64 \*new\_rlim

struct rlimit64 \*old\_rlim

303

name\_to\_handle\_at

[name\_to\_handle\_at(2)](https://manpages.debian.org/unstable/manpages-dev/name_to_handle_at.2.en.html)

[sys\_name\_to\_handle\_at](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbname_to_handle_at%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int dfd

const char \*name

struct file\_handle \*handle

int \*mnt\_id

int flag

304

open\_by\_handle\_at

[open\_by\_handle\_at(2)](https://manpages.debian.org/unstable/manpages-dev/open_by_handle_at.2.en.html)

[sys\_open\_by\_handle\_at](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbopen_by_handle_at%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int mountdirfd

struct file\_handle \*handle

int flags

305

clock\_adjtime

[clock\_adjtime(2)](https://manpages.debian.org/unstable/manpages-dev/clock_adjtime.2.en.html)

[sys\_clock\_adjtime](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclock_adjtime%5Cb%2F&type=code)

%rdi

%rsi

clockid\_t which\_clock

struct \_\_kernel\_timex \*tx

306

syncfs

[syncfs(2)](https://manpages.debian.org/unstable/manpages-dev/syncfs.2.en.html)

[sys\_syncfs](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsyncfs%5Cb%2F&type=code)

%rdi

int fd

307

sendmmsg

[sendmmsg(2)](https://manpages.debian.org/unstable/manpages-dev/sendmmsg.2.en.html)

[sys\_sendmmsg](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsendmmsg%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int fd

struct mmsghdr \*msg

unsigned int vlen

unsigned flags

308

setns

[setns(2)](https://manpages.debian.org/unstable/manpages-dev/setns.2.en.html)

[sys\_setns](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsetns%5Cb%2F&type=code)

%rdi

%rsi

int fd

int nstype

309

getcpu

[getcpu(2)](https://manpages.debian.org/unstable/manpages-dev/getcpu.2.en.html)

[sys\_getcpu](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetcpu%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned \*cpu

unsigned \*node

struct getcpu\_cache \*cache

310

process\_vm\_readv

[process\_vm\_readv(2)](https://manpages.debian.org/unstable/manpages-dev/process_vm_readv.2.en.html)

[sys\_process\_vm\_readv](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbprocess_vm_readv%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

pid\_t pid

const struct iovec \*lvec

unsigned long liovcnt

const struct iovec \*rvec

unsigned long riovcnt

unsigned long flags

311

process\_vm\_writev

[process\_vm\_writev(2)](https://manpages.debian.org/unstable/manpages-dev/process_vm_writev.2.en.html)

[sys\_process\_vm\_writev](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbprocess_vm_writev%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

pid\_t pid

const struct iovec \*lvec

unsigned long liovcnt

const struct iovec \*rvec

unsigned long riovcnt

unsigned long flags

312

kcmp

[kcmp(2)](https://manpages.debian.org/unstable/manpages-dev/kcmp.2.en.html)

[sys\_kcmp](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbkcmp%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

pid\_t pid1

pid\_t pid2

int type

unsigned long idx1

unsigned long idx2

313

finit\_module

[finit\_module(2)](https://manpages.debian.org/unstable/manpages-dev/finit_module.2.en.html)

[sys\_finit\_module](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfinit_module%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fd

const char \*uargs

int flags

314

sched\_setattr

[sched\_setattr(2)](https://manpages.debian.org/unstable/manpages-dev/sched_setattr.2.en.html)

[sys\_sched\_setattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_setattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

pid\_t pid

struct sched\_attr \*attr

unsigned int flags

315

sched\_getattr

[sched\_getattr(2)](https://manpages.debian.org/unstable/manpages-dev/sched_getattr.2.en.html)

[sys\_sched\_getattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbsched_getattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

pid\_t pid

struct sched\_attr \*attr

unsigned int size

unsigned int flags

316

renameat2

[renameat2(2)](https://manpages.debian.org/unstable/manpages-dev/renameat2.2.en.html)

[sys\_renameat2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrenameat2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int olddfd

const char \*oldname

int newdfd

const char \*newname

unsigned int flags

317

seccomp

[seccomp(2)](https://manpages.debian.org/unstable/manpages-dev/seccomp.2.en.html)

[sys\_seccomp](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbseccomp%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int op

unsigned int flags

void \*uargs

318

getrandom

[getrandom(2)](https://manpages.debian.org/unstable/manpages-dev/getrandom.2.en.html)

[sys\_getrandom](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbgetrandom%5Cb%2F&type=code)

%rdi

%rsi

%rdx

char \*buf

size\_t count

unsigned int flags

319

memfd\_create

[memfd\_create(2)](https://manpages.debian.org/unstable/manpages-dev/memfd_create.2.en.html)

[sys\_memfd\_create](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmemfd_create%5Cb%2F&type=code)

%rdi

%rsi

const char \*uname\_ptr

unsigned int flags

320

kexec\_file\_load

[kexec\_file\_load(2)](https://manpages.debian.org/unstable/manpages-dev/kexec_file_load.2.en.html)

[sys\_kexec\_file\_load](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbkexec_file_load%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int kernel\_fd

int initrd\_fd

unsigned long cmdline\_len

const char \*cmdline\_ptr

unsigned long flags

321

bpf

[bpf(2)](https://manpages.debian.org/unstable/manpages-dev/bpf.2.en.html)

[sys\_bpf](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbbpf%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int cmd

union bpf\_attr \*attr

unsigned int size

322

execveat

[execveat(2)](https://manpages.debian.org/unstable/manpages-dev/execveat.2.en.html)

[sys\_execveat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbexecveat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int dfd

const char \*filename

const char \*const \*argv

const char \*const \*envp

int flags

323

userfaultfd

[userfaultfd(2)](https://manpages.debian.org/unstable/manpages-dev/userfaultfd.2.en.html)

[sys\_userfaultfd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbuserfaultfd%5Cb%2F&type=code)

%rdi

int flags

324

membarrier

[membarrier(2)](https://manpages.debian.org/unstable/manpages-dev/membarrier.2.en.html)

[sys\_membarrier](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmembarrier%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int cmd

unsigned int flags

int cpu\_id

325

mlock2

[mlock2(2)](https://manpages.debian.org/unstable/manpages-dev/mlock2.2.en.html)

[sys\_mlock2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmlock2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long start

size\_t len

int flags

326

copy\_file\_range

[copy\_file\_range(2)](https://manpages.debian.org/unstable/manpages-dev/copy_file_range.2.en.html)

[sys\_copy\_file\_range](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbcopy_file_range%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int fd\_in

loff\_t \*off\_in

int fd\_out

loff\_t \*off\_out

size\_t len

unsigned int flags

327

preadv2

[preadv2(2)](https://manpages.debian.org/unstable/manpages-dev/preadv2.2.en.html)

[sys\_preadv2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpreadv2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

unsigned long fd

const struct iovec \*vec

unsigned long vlen

unsigned long pos\_l

unsigned long pos\_h

rwf\_t flags

328

pwritev2

[pwritev2(2)](https://manpages.debian.org/unstable/manpages-dev/pwritev2.2.en.html)

[sys\_pwritev2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpwritev2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

unsigned long fd

const struct iovec \*vec

unsigned long vlen

unsigned long pos\_l

unsigned long pos\_h

rwf\_t flags

329

pkey\_mprotect

[pkey\_mprotect(2)](https://manpages.debian.org/unstable/manpages-dev/pkey_mprotect.2.en.html)

[sys\_pkey\_mprotect](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpkey_mprotect%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned long start

size\_t len

unsigned long prot

int pkey

330

pkey\_alloc

[pkey\_alloc(2)](https://manpages.debian.org/unstable/manpages-dev/pkey_alloc.2.en.html)

[sys\_pkey\_alloc](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpkey_alloc%5Cb%2F&type=code)

%rdi

%rsi

unsigned long flags

unsigned long init\_val

331

pkey\_free

[pkey\_free(2)](https://manpages.debian.org/unstable/manpages-dev/pkey_free.2.en.html)

[sys\_pkey\_free](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpkey_free%5Cb%2F&type=code)

%rdi

int pkey

332

statx

[statx(2)](https://manpages.debian.org/unstable/manpages-dev/statx.2.en.html)

[sys\_statx](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbstatx%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int dfd

const char \*path

unsigned flags

unsigned mask

struct statx \*buffer

333

io\_pgetevents

[io\_pgetevents(2)](https://manpages.debian.org/unstable/manpages-dev/io_pgetevents.2.en.html)

[sys\_io\_pgetevents](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_pgetevents%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

aio\_context\_t ctx\_id

long min\_nr

long nr

struct io\_event \*events

struct \_\_kernel\_timespec \*timeout

const struct \_\_aio\_sigset \*sig

334

rseq

[rseq(2)](https://manpages.debian.org/unstable/manpages-dev/rseq.2.en.html)

[sys\_rseq](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbrseq%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

struct rseq \*rseq

uint32\_t rseq\_len

int flags

uint32\_t sig

424

pidfd\_send\_signal

[pidfd\_send\_signal(2)](https://manpages.debian.org/unstable/manpages-dev/pidfd_send_signal.2.en.html)

[sys\_pidfd\_send\_signal](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpidfd_send_signal%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int pidfd

int sig

siginfo\_t \*info

unsigned int flags

425

io\_uring\_setup

[io\_uring\_setup(2)](https://manpages.debian.org/unstable/manpages-dev/io_uring_setup.2.en.html)

[sys\_io\_uring\_setup](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_uring_setup%5Cb%2F&type=code)

%rdi

%rsi

u32 entries

struct io\_uring\_params \*p

426

io\_uring\_enter

[io\_uring\_enter(2)](https://manpages.debian.org/unstable/manpages-dev/io_uring_enter.2.en.html)

[sys\_io\_uring\_enter](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_uring_enter%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

unsigned int fd

u32 to\_submit

u32 min\_complete

u32 flags

const void \*argp

size\_t argsz

427

io\_uring\_register

[io\_uring\_register(2)](https://manpages.debian.org/unstable/manpages-dev/io_uring_register.2.en.html)

[sys\_io\_uring\_register](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbio_uring_register%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned int fd

unsigned int op

void \*arg

unsigned int nr\_args

428

open\_tree

[open\_tree(2)](https://manpages.debian.org/unstable/manpages-dev/open_tree.2.en.html)

[sys\_open\_tree](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbopen_tree%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \*path

unsigned flags

429

move\_mount

[move\_mount(2)](https://manpages.debian.org/unstable/manpages-dev/move_mount.2.en.html)

[sys\_move\_mount](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmove_mount%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int from\_dfd

const char \*from\_path

int to\_dfd

const char \*to\_path

unsigned int ms\_flags

430

fsopen

[fsopen(2)](https://manpages.debian.org/unstable/manpages-dev/fsopen.2.en.html)

[sys\_fsopen](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfsopen%5Cb%2F&type=code)

%rdi

%rsi

const char \*fs\_name

unsigned int flags

431

fsconfig

[fsconfig(2)](https://manpages.debian.org/unstable/manpages-dev/fsconfig.2.en.html)

[sys\_fsconfig](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfsconfig%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int fs\_fd

unsigned int cmd

const char \*key

const void \*value

int aux

432

fsmount

[fsmount(2)](https://manpages.debian.org/unstable/manpages-dev/fsmount.2.en.html)

[sys\_fsmount](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfsmount%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int fs\_fd

unsigned int flags

unsigned int ms\_flags

433

fspick

[fspick(2)](https://manpages.debian.org/unstable/manpages-dev/fspick.2.en.html)

[sys\_fspick](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfspick%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int dfd

const char \*path

unsigned int flags

434

pidfd\_open

[pidfd\_open(2)](https://manpages.debian.org/unstable/manpages-dev/pidfd_open.2.en.html)

[sys\_pidfd\_open](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpidfd_open%5Cb%2F&type=code)

%rdi

%rsi

pid\_t pid

unsigned int flags

435

clone3

[clone3(2)](https://manpages.debian.org/unstable/manpages-dev/clone3.2.en.html)

[sys\_clone3](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclone3%5Cb%2F&type=code)

%rdi

%rsi

struct clone\_args \*uargs

size\_t size

436

close\_range

[close\_range(2)](https://manpages.debian.org/unstable/manpages-dev/close_range.2.en.html)

[sys\_close\_range](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbclose_range%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned int fd

unsigned int max\_fd

unsigned int flags

437

openat2

[openat2(2)](https://manpages.debian.org/unstable/manpages-dev/openat2.2.en.html)

[sys\_openat2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbopenat2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*filename

struct open\_how \*how

size\_t size

438

pidfd\_getfd

[pidfd\_getfd(2)](https://manpages.debian.org/unstable/manpages-dev/pidfd_getfd.2.en.html)

[sys\_pidfd\_getfd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbpidfd_getfd%5Cb%2F&type=code)

%rdi

%rsi

%rdx

int pidfd

int fd

unsigned int flags

439

faccessat2

[faccessat2(2)](https://manpages.debian.org/unstable/manpages-dev/faccessat2.2.en.html)

[sys\_faccessat2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfaccessat2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*filename

int mode

int flags

440

process\_madvise

[process\_madvise(2)](https://manpages.debian.org/unstable/manpages-dev/process_madvise.2.en.html)

[sys\_process\_madvise](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbprocess_madvise%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int pidfd

const struct iovec \*vec

size\_t vlen

int behavior

unsigned int flags

441

epoll\_pwait2

[epoll\_pwait2(2)](https://manpages.debian.org/unstable/manpages-dev/epoll_pwait2.2.en.html)

[sys\_epoll\_pwait2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbepoll_pwait2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

int epfd

struct epoll\_event \*events

int maxevents

const struct \_\_kernel\_timespec \*timeout

const sigset\_t \*sigmask

size\_t sigsetsize

442

mount\_setattr

[mount\_setattr(2)](https://manpages.debian.org/unstable/manpages-dev/mount_setattr.2.en.html)

[sys\_mount\_setattr](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmount_setattr%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

int dfd

const char \*path

unsigned int flags

struct mount\_attr \*uattr

size\_t usize

443

quotactl\_fd

[quotactl\_fd(2)](https://manpages.debian.org/unstable/manpages-dev/quotactl_fd.2.en.html)

[sys\_quotactl\_fd](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbquotactl_fd%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned int fd

unsigned int cmd

qid\_t id

void \*addr

444

landlock\_create\_ruleset

[landlock\_create\_ruleset(2)](https://manpages.debian.org/unstable/manpages-dev/landlock_create_ruleset.2.en.html)

[sys\_landlock\_create\_ruleset](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblandlock_create_ruleset%5Cb%2F&type=code)

%rdi

%rsi

%rdx

const struct landlock\_ruleset\_attr \*attr

size\_t size

\_\_u32 flags

445

landlock\_add\_rule

[landlock\_add\_rule(2)](https://manpages.debian.org/unstable/manpages-dev/landlock_add_rule.2.en.html)

[sys\_landlock\_add\_rule](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblandlock_add_rule%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int ruleset\_fd

enum landlock\_rule\_type rule\_type

const void \*rule\_attr

\_\_u32 flags

446

landlock\_restrict\_self

[landlock\_restrict\_self(2)](https://manpages.debian.org/unstable/manpages-dev/landlock_restrict_self.2.en.html)

[sys\_landlock\_restrict\_self](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cblandlock_restrict_self%5Cb%2F&type=code)

%rdi

%rsi

int ruleset\_fd

\_\_u32 flags

447

memfd\_secret

[memfd\_secret(2)](https://manpages.debian.org/unstable/manpages-dev/memfd_secret.2.en.html)

[sys\_memfd\_secret](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmemfd_secret%5Cb%2F&type=code)

%rdi

unsigned int flags

448

process\_mrelease

[process\_mrelease(2)](https://manpages.debian.org/unstable/manpages-dev/process_mrelease.2.en.html)

[sys\_process\_mrelease](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbprocess_mrelease%5Cb%2F&type=code)

%rdi

%rsi

int pidfd

unsigned int flags

449

futex\_waitv

[futex\_waitv(2)](https://manpages.debian.org/unstable/manpages-dev/futex_waitv.2.en.html)

[sys\_futex\_waitv](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfutex_waitv%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

struct futex\_waitv \*waiters

unsigned int nr\_futexes

unsigned int flags

struct \_\_kernel\_timespec \*timeout

clockid\_t clockid

450

set\_mempolicy\_home\_node

[set\_mempolicy\_home\_node(2)](https://manpages.debian.org/unstable/manpages-dev/set_mempolicy_home_node.2.en.html)

[sys\_set\_mempolicy\_home\_node](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbset_mempolicy_home_node%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned long start

unsigned long len

unsigned long home\_node

unsigned long flags

451

cachestat

[cachestat(2)](https://manpages.debian.org/unstable/manpages-dev/cachestat.2.en.html)

[sys\_cachestat](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbcachestat%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

unsigned int fd

struct cachestat\_range \*cstat\_range

struct cachestat \*cstat

unsigned int flags

452

fchmodat2

[fchmodat2(2)](https://manpages.debian.org/unstable/manpages-dev/fchmodat2.2.en.html)

[sys\_fchmodat2](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfchmodat2%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

int dfd

const char \*filename

umode\_t mode

unsigned int flags

453

map\_shadow\_stack

[map\_shadow\_stack(2)](https://manpages.debian.org/unstable/manpages-dev/map_shadow_stack.2.en.html)

[sys\_map\_shadow\_stack](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbmap_shadow_stack%5Cb%2F&type=code)

%rdi

%rsi

%rdx

unsigned long addr

unsigned long size

unsigned int flags

454

futex\_wake

[futex\_wake(2)](https://manpages.debian.org/unstable/manpages-dev/futex_wake.2.en.html)

[sys\_futex\_wake](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfutex_wake%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

void \*uaddr

unsigned long mask

int nr

unsigned int flags

455

futex\_wait

[futex\_wait(2)](https://manpages.debian.org/unstable/manpages-dev/futex_wait.2.en.html)

[sys\_futex\_wait](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfutex_wait%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

%r8

%r9

void \*uaddr

unsigned long val

unsigned long mask

unsigned int flags

struct \_\_kernel\_timespec \*timespec

clockid\_t clockid

456

futex\_requeue

[futex\_requeue(2)](https://manpages.debian.org/unstable/manpages-dev/futex_requeue.2.en.html)

[sys\_futex\_requeue](https://github.com/search?q=repo%3Atorvalds%2Flinux+%2FSYSCALL_DEFINE%5B%5E%2C%5D*%5Cbfutex_requeue%5Cb%2F&type=code)

%rdi

%rsi

%rdx

%r10

struct futex\_waitv \*waiters

unsigned int flags

int nr\_wake

int nr\_requeue

---

# QEMU version 10.0.0 released

*Source: <https://www.qemu.org/2025/04/23/qemu-10-0-0/>*
*Published: 2025-04-23T23:47:06.000Z*

*   [Home](../../../../)
*   [Download](../../../../download)
*   [Support](../../../../support)
*   [Contribute](../../../../contribute)
*   [Docs](../../../../documentation)
*   [Wiki](https://wiki.qemu.org)
*   [Blog](../../../../blog)

$('body').addClass('js'); $('#nav').hide().before('<div id="titleBar"><div><button role="button" aria-pressed="false" aria-controls="nav" aria-label="Toggle navigation bar"><span class="fa fa-lg fa-bars"></span></button></div></div>'); $('button\[aria-controls="nav"\]').click(function() { jqNav = $('#nav'); if ($(this).attr('aria-pressed') == 'true') { $(this).attr('aria-pressed', false); $('#nav, #titleBar>div').animate( { 'margin-left': '-=80%' }, { 'duration': 400 }); jqNav.promise().done(function() { jqNav.hide().css('margin-left', 0); }); } else { $(this).attr('aria-pressed', true); jqNav.css('margin-left', '-80%').show(); $('#nav, #titleBar>div').animate( { 'margin-left': '+=80%' }, { 'duration': 400 }); } });

# QEMU version 10.0.0 released

23 Apr 2025

We’d like to announce the availability of the QEMU 10.0.0 release. This release contains 2800+ commits from 211 authors.

You can grab the tarball from our [download page](https://www.qemu.org/download/#source). The full list of changes are available [in the changelog](https://wiki.qemu.org/ChangeLog/10.0).

Highlights include:

*   block: virtio-scsi multiqueue support for using different I/O threads to process requests for each queue (similar to the virtio-blk multiqueue support that was added in QEMU 9.2)
*   VFIO: improved support for IGD passthrough on all Intel Gen 11/12 devices
*   Documentation: significant improvement/overhaul of documentation for QEMU Machine Protocol to make it clearer and more organized, including all commands/events/types now being cross-reference-able via click-able links in generated documentation
*   ARM: emulation support for EL2 physical and virtual timers
*   ARM: emulation support for FEAT\_AFP, FEAT\_RPRES, and FEAT\_XS architecture features
*   ARM: new board models for NPCM8445 Evaluation and i.MX 8M Plus EVK boards
*   HPPA: new SeaBIOS-hppa version 18 with lots of fixes and enhancements
*   HPPA: translation speed and virtual CPU reset improvements
*   HPPA: emulation support for Diva GSP BMC boards
*   LoongArch: support for CPU hotplug, paravirtual IPIs, KVM steal time accounting, and virtual ‘extioi’ interrupt routing.
*   RISC-V: ISA/extension support for riscv-iommu-sys devices, ‘svukte’, ‘ssstateen’, ‘smrnmi’, ‘smdbltrp’/’ssdbltrp’, ‘supm’/’sspm’, and IOMMU translation tags
*   RISC-V: emulation support for Ascalon and RV64 Xiangshan Nanhu CPUs, and Microblaze V boards.
*   s390x: add CPU model support for the generation 17 mainframe CPU
*   s930x: add support for virtio-mem and for bypassing IOMMU to improve PCI device performance
*   x86: CPU model support for Clearwater Forest and Sierra Forest v2
*   x86: faster emulation of string instructions
*   and lots more…

Thank you to everybody who contributed to this release, whether that was by writing code, reporting bugs, improving documentation, testing, or providing the project with CI resources. We couldn’t do these without you!

*   [releases](/blog/category/releases/index.html)
*   [qemu 10.0](/blog/category/qemu-10-0/index.html)

# Recent Posts

*   [QEMU version 10.0.0 released](../../../../2025/04/23/qemu-10-0-0/)  
    23 Apr 2025
*   [Announcing QEMU Google Summer of Code 2025 internships](../../../../2025/03/06/gsoc-2025/)  
    06 Mar 2025

# Archives

*   [April 2025 (1)](../../../../blog/2025/04/)
*   [March 2025 (1)](../../../../blog/2025/03/)
*   [December 2024 (1)](../../../../blog/2024/12/)
*   [September 2024 (1)](../../../../blog/2024/09/)
*   [May 2024 (1)](../../../../blog/2024/05/)
*   [April 2024 (1)](../../../../blog/2024/04/)
*   [December 2023 (1)](../../../../blog/2023/12/)
*   [August 2023 (1)](../../../../blog/2023/08/)
*   [April 2023 (1)](../../../../blog/2023/04/)
*   [March 2023 (2)](../../../../blog/2023/03/)
*   [February 2023 (1)](../../../../blog/2023/02/)
*   [December 2022 (1)](../../../../blog/2022/12/)
*   [November 2022 (1)](../../../../blog/2022/11/)
*   [August 2022 (1)](../../../../blog/2022/08/)
*   [April 2022 (1)](../../../../blog/2022/04/)
*   [March 2022 (1)](../../../../blog/2022/03/)
*   [February 2022 (1)](../../../../blog/2022/02/)
*   [December 2021 (1)](../../../../blog/2021/12/)
*   [August 2021 (3)](../../../../blog/2021/08/)
*   [April 2021 (1)](../../../../blog/2021/04/)
*   [March 2021 (1)](../../../../blog/2021/03/)
*   [February 2021 (1)](../../../../blog/2021/02/)
*   [January 2021 (1)](../../../../blog/2021/01/)
*   [December 2020 (1)](../../../../blog/2020/12/)
*   [November 2020 (2)](../../../../blog/2020/11/)
*   [September 2020 (1)](../../../../blog/2020/09/)
*   [August 2020 (1)](../../../../blog/2020/08/)
*   [July 2020 (1)](../../../../blog/2020/07/)
*   [April 2020 (1)](../../../../blog/2020/04/)
*   [February 2020 (2)](../../../../blog/2020/02/)
*   [December 2019 (1)](../../../../blog/2019/12/)
*   [November 2019 (3)](../../../../blog/2019/11/)
*   [August 2019 (1)](../../../../blog/2019/08/)
*   [May 2019 (1)](../../../../blog/2019/05/)
*   [April 2019 (1)](../../../../blog/2019/04/)
*   [February 2019 (1)](../../../../blog/2019/02/)
*   [January 2019 (1)](../../../../blog/2019/01/)
*   [December 2018 (1)](../../../../blog/2018/12/)
*   [August 2018 (1)](../../../../blog/2018/08/)
*   [June 2018 (1)](../../../../blog/2018/06/)
*   [May 2018 (1)](../../../../blog/2018/05/)
*   [April 2018 (1)](../../../../blog/2018/04/)
*   [February 2018 (3)](../../../../blog/2018/02/)
*   [January 2018 (1)](../../../../blog/2018/01/)
*   [November 2017 (1)](../../../../blog/2017/11/)
*   [October 2017 (1)](../../../../blog/2017/10/)
*   [September 2017 (1)](../../../../blog/2017/09/)
*   [August 2017 (1)](../../../../blog/2017/08/)
*   [May 2017 (1)](../../../../blog/2017/05/)
*   [March 2017 (1)](../../../../blog/2017/03/)
*   [February 2017 (2)](../../../../blog/2017/02/)

*   [Advent calendar](http://qemu-advent-calendar.org)
*   [Blog planet](https://planet.virt-tools.org/)
*   [KVM](https://www.linux-kvm.org/)
*   [Libguestfs](http://libguestfs.org/)
*   [Libvirt](https://libvirt.org/)
*   [Xen](https://xenproject.org)

[page source](https://gitlab.com/qemu-project/qemu-web/-/blob/master/_posts/2025-04-23-qemu-10-0-0.md)

QEMU is a member of [Software Freedom Conservancy](../../../../conservancy/)

QEMU has [sponsors](../../../../sponsors/)

[Website licenses](../../../../license.html)

---

# A paean to programming

*Source: <https://bertrandmeyer.com/2025/04/23/a-paean-to-programming/>*
*Published: 2025-04-23T17:53:30.000Z*

# [Bertrand Meyer's technology+ blog](https://bertrandmeyer.com "Bertrand Meyer's technology+ blog: Software engineering, programming methodology, languages, verification, general technology, publication culture, and more")

Software engineering, programming methodology, languages, verification, general technology, publication culture, and more

  
[Follow @Bertrand\_Meyer](https://twitter.com/Bertrand_Meyer)

*   [Home](https://bertrandmeyer.com)
*   [Bio](https://bertrandmeyer.com/bio/)
*   [Earlier columns](https://bertrandmeyer.com/eiffelworld-column/)

« [New article: obituary of Niklaus Wirth](https://bertrandmeyer.com/2025/03/04/new-article-obituary-of-niklaus-wirth/)

## [A paean to programming](https://bertrandmeyer.com/2025/04/23/a-paean-to-programming/ "Permanent Link to A paean to programming")

23 April 2025, 15:08

A Google search for something entirely unrelated led me to a very [old issue](https://www.jstor.org/stable/pdf/community.33113105.pdf?refreqid=fastly-default%3A099aea80b0aec41c0a960d50c6a80445&ab_segments=0%2Fbasic_phrase_search%2Fcontrol&initiator=search-results&acceptTC=1) of the _Daily Nexus_, the student newspaper of the University of California, Santa Barbara, where I was teaching back then.  Apparently (I had forgotten all about it of course) I was piqued by a student’s letter to the editor, where he complained of having to sit all day hacking at a terminal just because he had been told to study computer science to get a high-paying job.  I felt compelled to write a response (published on 24 April 1984 under the editor-provided title “_Monster_”) affirming that CSis not all about money.

My letter appears below, copy-pasted in full. The nice thing about it is that I would write it an exactly the same way today. The scary thing about it is that I would write in exactly the same way today! Well, actually, let me qualify that: I would replace “_which_” by “_that_” in the second paragraph, and in the penultimate one I would not separate the verb  “_convey_” from its complement. So it is good to know that in forty-one years minus one day I have learned at least two things.

* * *

From: UCSB _Daily Nexus_, 24 April 1984, page 3, available [here](https://www.jstor.org/stable/pdf/community.33113105.pdf?refreqid=fastly-default%3A099aea80b0aec41c0a960d50c6a80445&ab_segments=0%2Fbasic_phrase_search%2Fcontrol&initiator=search-results&acceptTC=1).

#### Monster

Editor, Daily Nexus:

In a letter published in the April 17 _Nexus_, Paul Dechant complains that he must sit “_night after night_” in the terminal room instead of devoting his time to more gratifying occupations. I checked my lists: he is not in any of my classes. Good; nobody likes to feel like a monster…

The part of his letter that worries me more, however, is the question which he asks: “_Is this the price I must pay for a decent grade in a major which promises a healthy salary?_” I appreciate Dechant’s frankness, and I have no doubt that it reflects a common view of what majoring in Computer Science is all about, but still, I find this definition bothering. Is it really so that the only argument for choosing a scientific or engineering major is the prospect of making big bucks? How sad! There is so much more to it.

How about intellectual challenges? I may have some ground to speak about this, since as a student I was what in the U.S. would be called a double major, and got degrees both in science and the humanities. I can testify that the choice between the two is not a matter of greed alone; the borderline between “vocational” and “educational” is not that clear. There is cultural value in science, too! The sheer excitement of entering a new scientific field like computer science, where so much remains to be discovered, is my view of a good enough motivation. By the way, one of the challenges that people in my field (software engineering) are tackling has something to do with Mr. Dechant’s frustration: does programming have to be such a trauma? Can we find a way to deal with problems so that people don’t have to sit “night after night” to get their programs running? In fact, some of our teaching is already concerned with this. It’s called programming methodology and I am sure it can help.

Now think about what computers really are: one of the most fabulous kind of machines ever devised by mankind, but different from all the machines invented before in that they can solve not just one problem, but any problem which is presented to them, provided the problem and the solution technique _can be described in complete detaiI_. A computer is thus more of a “meta-machine,” and computer science is really the science of problem-solving. How do we master this power and put it to good use? Doesn’t this present some challenges worthy of devoting part of your life to them? I think it does and I hope some of my teaching is able to convey, however imperfectly, this excitement.

There is nothing wrong in considering the potential financial rewards when choosing a major. I would hate to think, however, that all our students are sitting there just because they or their parents have read in Time or Fortune magazine that one may get rich by going into software.

Bertrand Meyer

Visiting Professor

Computer Science Department

VN:F \[1.9.10\_1130\]

please wait...

Rating: 0.0/**10** (0 votes cast)

VN:F \[1.9.10\_1130\]

Rating: **0** (from 0 votes)

Be Sociable, Share!

*   [](http://twitter.com/intent/tweet?text=A%20paean%20to%20programming%20-%20https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F%20   "Twitter")
*   [](http://www.facebook.com/share.php?u=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&t=A%20paean%20to%20programming "Facebook")
*   [](https://mail.google.com/mail/?view=cm&fs=1&to&su=A%20paean%20to%20programming&body=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&ui=2&tf=1&shva=1 "email")
*   ![](https://bertrandmeyer.com/wp-content/plugins/sociable/images/option1/32/vuible.png)
*   
*   [](http://www.stumbleupon.com/submit?url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming "StumbleUpon")
*   [](http://delicious.com/post?url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming&notes=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "Delicious")
*   [](http://www.google.com/reader/link?url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming&srcURL=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&srcTitle=Bertrand+Meyer%26%23039%3Bs+technology%2B+blog+Software+engineering%2C+programming+methodology%2C+languages%2C+verification%2C+general+technology%2C+publication+culture%2C+and+more "Google Reader")
*   [](http://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming&source=Bertrand+Meyer%26%23039%3Bs+technology%2B+blog+Software+engineering%2C+programming+methodology%2C+languages%2C+verification%2C+general+technology%2C+publication+culture%2C+and+more&summary=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "LinkedIn")
*   ![](https://bertrandmeyer.com/wp-content/plugins/sociable/images/more.png)

*   [](http://www.myspace.com/Modules/PostTo/Pages/?u=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&t=A%20paean%20to%20programming "Myspace")
*   [](http://digg.com/submit?phase=2&url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming&bodytext=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "Digg")
*   [](http://reddit.com/submit?url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming "Reddit")
*   [](http://www.google.com/bookmarks/mark?op=edit&bkmk=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming&annotation=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "Google Bookmarks")
*   [](http://news.ycombinator.com/submitlink?u=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&t=A%20paean%20to%20programming "HackerNews")
*   [](http://reporter.es.msn.com/?fn=contribute&Title=A%20paean%20to%20programming&URL=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&cat_id=6&tag_id=31&Remark=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "MSNReporter")
*   [](http://www.blinklist.com/index.php?Action=Blink/addblink.php&Url=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&Title=A%20paean%20to%20programming "BlinkList")
*   [](http://sphinn.com/index.php?c=post&m=submit&link=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F "Sphinn")
*   [](http://posterous.com/share?linkto=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&title=A%20paean%20to%20programming&selection=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "Posterous")
*   [](http://www.tumblr.com/share?v=3&u=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F&t=A%20paean%20to%20programming&s=A%20Google%20search%20for%20something%20entirely%20unrelated%20led%20me%20to%20a%20very%20old%20issue%20of%20the%20Daily%20Nexus%2C%20the%20student%20newspaper%20of%20the%20University%20of%20California%2C%20Santa%20Barbara%2C%20where%20I%20was%20teaching%20back%20then.%C2%A0%20Apparently%20%28I%20had%20forgotten%20all%20about%20it%20of%20course "Tumblr")

![](https://bertrandmeyer.com/wp-content/plugins/sociable/images/closelabel.png "close")

*   [Tweet](https://twitter.com/share)
*   

*   
*   
*   ![](https://bertrandmeyer.com/wp-content/plugins/sociable/images/vuible.png)

Tags: [ucsb](https://bertrandmeyer.com/tag/ucsb/)  
Category: [Computer science](https://bertrandmeyer.com/category/computer-science/), [Education](https://bertrandmeyer.com/category/education/), [Programming techniques](https://bertrandmeyer.com/category/programmingtechniques/), [Software engineering](https://bertrandmeyer.com/category/software-engineering/)  |  [Comment](#respond) ([RSS](https://bertrandmeyer.com/2025/04/23/a-paean-to-programming/feed/))

### Leave a Reply

[Click here to cancel reply.](/2025/04/23/a-paean-to-programming/#respond)

You must be [logged in](https://bertrandmeyer.com/wp-login.php?redirect_to=https%3A%2F%2Fbertrandmeyer.com%2F2025%2F04%2F23%2Fa-paean-to-programming%2F) to post a comment.

*   ## Sites
    
    *   [Eiffel Community](http://eiffel.org "Eiffel forums, news, blogs")
    *    [![Eiffel Software](https://bertrandmeyer.com/wp-content/upLoads/eiffel-software-icon.jpg "Eiffel web site") Eiffel Software](https://www.eiffel.com/ "Eiffel web site")
    *   [Expertyze](http://expertyze.com "International network of experts in software-related litigation, project rescue, project management and technology policy")
    *    [![Home page at ETH](https://bertrandmeyer.com/wp-content/upLoads/sechair.ico) Home page at ETH](http://se.ethz.ch/~meyer/)
    *    [![Informatics Europe](https://bertrandmeyer.com/wp-content/upLoads/informatics_europe_logo-minuscule.gif "The association of European computer science departments") Informatics Europe](http://www.informatics-europe.org "The association of European computer science departments")
    *   [Innopolis Software Engineering Laboratory](https://university.innopolis.ru/en/research/itsd/selab/ "Software Engineering Laboratory at Innopolis University, Kazan (Russia)")
    *    [![LASER summer school](https://bertrandmeyer.com/wp-content/upLoads/hoteldelgolfo-thumbnail.jpg "Leading software summer school, held every year in Elba island, Italy. 2018 theme: software for bitcoin, blockchains and distributed trust systems") LASER summer school](http://laser-foundation.org "Leading software summer school, held every year in Elba island, Italy. 2018 theme: software for bitcoin, blockchains and distributed trust systems")
    *    [![Propulsion Academy](https://bertrandmeyer.com/wp-content/upLoads/expertyze.logo_.jpg "Propulsion Academy: the first intensive coding school in Switzerland, with 3-month in-depth programs on Full-Stack Development and Data Science") Propulsion Academy](http://propulsionacademy.org "Propulsion Academy: the first intensive coding school in Switzerland, with 3-month in-depth programs on Full-Stack Development and Data Science")
    *    [![Publication list](https://bertrandmeyer.com/wp-content/upLoads/sechair.ico "Publications") Publication list](http://se.ethz.ch/~meyer/publications "Publications")
*   ## Tags
    
    [ACM](https://bertrandmeyer.com/tag/acm/) [Advance](https://bertrandmeyer.com/tag/advance/) [Alias](https://bertrandmeyer.com/tag/alias/) [Aliasing](https://bertrandmeyer.com/tag/aliasing/) [AutoTest](https://bertrandmeyer.com/tag/autotest/) [Beethoven](https://bertrandmeyer.com/tag/beethoven/) [Breakthroughs](https://bertrandmeyer.com/tag/breakthroughs/) [Conferences](https://bertrandmeyer.com/tag/conferences/) [Design by Contract](https://bertrandmeyer.com/tag/design-by-contract/) [Dijkstra](https://bertrandmeyer.com/tag/dijkstra/) [DOSE](https://bertrandmeyer.com/tag/dose/) [Eiffel](https://bertrandmeyer.com/tag/eiffel/) [EiffelStudio](https://bertrandmeyer.com/tag/eiffelstudio/) [Error](https://bertrandmeyer.com/tag/error/) [ETH](https://bertrandmeyer.com/tag/eth/) [Frame problem](https://bertrandmeyer.com/tag/frame%c2%a0problem/) [Google](https://bertrandmeyer.com/tag/google/) [Ground-breaking](https://bertrandmeyer.com/tag/ground-breaking/) [Hoare](https://bertrandmeyer.com/tag/hoare/) [Humphrey](https://bertrandmeyer.com/tag/humphrey/) [Hype](https://bertrandmeyer.com/tag/hype/) [ICSE](https://bertrandmeyer.com/tag/icse/) [IEEE](https://bertrandmeyer.com/tag/ieee/) [Introduction to programming](https://bertrandmeyer.com/tag/introduction-to-programming/) [Invariant](https://bertrandmeyer.com/tag/invariant/) [ITMO](https://bertrandmeyer.com/tag/itmo/) [Java](https://bertrandmeyer.com/tag/java/) [LASER](https://bertrandmeyer.com/tag/laser/) [Loop](https://bertrandmeyer.com/tag/loop/) [Loop invariant](https://bertrandmeyer.com/tag/loop%c2%a0invariant/) [Methodology](https://bertrandmeyer.com/tag/methodology/) [Microsoft Word](https://bertrandmeyer.com/tag/microsoftword/) [Microsoft Word](https://bertrandmeyer.com/tag/microsoft-word/) [MOOC](https://bertrandmeyer.com/tag/mooc/) [Research](https://bertrandmeyer.com/tag/research/) [SCOOP](https://bertrandmeyer.com/tag/scoop/) [Standards](https://bertrandmeyer.com/tag/standards/) [Style](https://bertrandmeyer.com/tag/style/) [Technology](https://bertrandmeyer.com/tag/technology/) [Touch of Class](https://bertrandmeyer.com/tag/touch-of-class/) [Translation](https://bertrandmeyer.com/tag/translation/) [Turing](https://bertrandmeyer.com/tag/turing/) [VAMOC](https://bertrandmeyer.com/tag/vamoc/) [Void safety](https://bertrandmeyer.com/tag/void-safety/) [Wirth](https://bertrandmeyer.com/tag/wirth/)
    
*   ## Categories
    
    *   [Administrative](https://bertrandmeyer.com/category/administrative/) (2)
    *   [Agile](https://bertrandmeyer.com/category/agile/) (16)
    *   [Algorithms](https://bertrandmeyer.com/category/algorithms/) (14)
    *   [Computer science](https://bertrandmeyer.com/category/computer-science/) (145)
    *   [Concurrency](https://bertrandmeyer.com/category/concurrency/) (33)
    *   [Conference](https://bertrandmeyer.com/category/conference/) (42)
    *   [Design by Contract](https://bertrandmeyer.com/category/design-by-contract/) (53)
    *   [Distributed software development](https://bertrandmeyer.com/category/distributed-software-development/) (11)
    *   [Education](https://bertrandmeyer.com/category/education/) (79)
    *   [Eiffel](https://bertrandmeyer.com/category/eiffel/) (81)
    *   [Empirical Software Engineering](https://bertrandmeyer.com/category/empirical-software-engineering/) (30)
    *   [Essay](https://bertrandmeyer.com/category/essay/) (28)
    *   [Eulogy](https://bertrandmeyer.com/category/eulogy/) (5)
    *   [Europe](https://bertrandmeyer.com/category/europe/) (8)
    *   [Formal methods and proofs](https://bertrandmeyer.com/category/formal-methods-and-proofs/) (62)
    *   [French](https://bertrandmeyer.com/category/french/) (5)
    *   [General technology](https://bertrandmeyer.com/category/general-technology/) (61)
    *   [Health](https://bertrandmeyer.com/category/health/) (2)
    *   [History](https://bertrandmeyer.com/category/history/) (17)
    *   [Language design](https://bertrandmeyer.com/category/languagedesign/) (48)
    *   [Limerick](https://bertrandmeyer.com/category/limerick/) (3)
    *   [Master, please explain](https://bertrandmeyer.com/category/master-please-explain/) (5)
    *   [Mathematics](https://bertrandmeyer.com/category/mathematics/) (6)
    *   [Memoir](https://bertrandmeyer.com/category/memoir/) (6)
    *   [Music](https://bertrandmeyer.com/category/music/) (6)
    *   [Numerics](https://bertrandmeyer.com/category/numerics/) (2)
    *   [Object technology](https://bertrandmeyer.com/category/objecttechnology/) (39)
    *   [Opera](https://bertrandmeyer.com/category/opera/) (2)
    *   [Personal](https://bertrandmeyer.com/category/personal/) (23)
    *   [Photo](https://bertrandmeyer.com/category/photo/) (2)
    *   [Photographs](https://bertrandmeyer.com/category/photographs/) (2)
    *   [Policy](https://bertrandmeyer.com/category/policy/) (22)
    *   [Politics](https://bertrandmeyer.com/category/politics/) (28)
    *   [Positions](https://bertrandmeyer.com/category/positions/) (6)
    *   [Privacy](https://bertrandmeyer.com/category/privacy/) (1)
    *   [Prize](https://bertrandmeyer.com/category/prize/) (2)
    *   [Programming techniques](https://bertrandmeyer.com/category/programmingtechniques/) (78)
    *   [Project management](https://bertrandmeyer.com/category/project-management/) (8)
    *   [Publication announcement](https://bertrandmeyer.com/category/paperannouncement/) (38)
    *   [Publications](https://bertrandmeyer.com/category/publications/) (27)
    *   [Puzzle](https://bertrandmeyer.com/category/puzzle/) (3)
    *   [Reading notes](https://bertrandmeyer.com/category/readng_notes/) (9)
    *   [Recycled](https://bertrandmeyer.com/category/recycled/) (6)
    *   [Requirements](https://bertrandmeyer.com/category/requirements/) (21)
    *   [Research evaluation](https://bertrandmeyer.com/category/researchevaluation/) (21)
    *   [Robotics](https://bertrandmeyer.com/category/robotics/) (4)
    *   [Security](https://bertrandmeyer.com/category/security/) (3)
    *   [Seminar](https://bertrandmeyer.com/category/seminar/) (15)
    *   [Software engineering](https://bertrandmeyer.com/category/software-engineering/) (239)
    *   [Software process](https://bertrandmeyer.com/category/software-process/) (49)
    *   [Software verification](https://bertrandmeyer.com/category/software-verification/) (70)
    *   [Software design](https://bertrandmeyer.com/category/softwaredesign/) (57)
    *   [Standardization](https://bertrandmeyer.com/category/standardization/) (5)
    *   [Talks](https://bertrandmeyer.com/category/talks/) (16)
    *   [Testing](https://bertrandmeyer.com/category/testing/) (24)
    *   [Theory](https://bertrandmeyer.com/category/theory/) (38)
    *   [Translation](https://bertrandmeyer.com/category/translation/) (2)
    *   [Uncategorized](https://bertrandmeyer.com/category/uncategorized/) (3)
    *   [User interface design](https://bertrandmeyer.com/category/user-interface-design/) (6)
    *   [Video](https://bertrandmeyer.com/category/video/) (4)
    *   [Writing and style](https://bertrandmeyer.com/category/writing-and-style/) (22)
*   ## Recent Comments
    
*   ## Archives
    
    *   [April 2025](https://bertrandmeyer.com/2025/04/) (1)
    *   [March 2025](https://bertrandmeyer.com/2025/03/) (3)
    *   [February 2025](https://bertrandmeyer.com/2025/02/) (7)
    *   [November 2024](https://bertrandmeyer.com/2024/11/) (1)
    *   [October 2024](https://bertrandmeyer.com/2024/10/) (1)
    *   [September 2024](https://bertrandmeyer.com/2024/09/) (1)
    *   [August 2024](https://bertrandmeyer.com/2024/08/) (1)
    *   [July 2024](https://bertrandmeyer.com/2024/07/) (2)
    *   [June 2024](https://bertrandmeyer.com/2024/06/) (3)
    *   [May 2024](https://bertrandmeyer.com/2024/05/) (1)
    *   [April 2024](https://bertrandmeyer.com/2024/04/) (1)
    *   [March 2024](https://bertrandmeyer.com/2024/03/) (1)
    *   [January 2024](https://bertrandmeyer.com/2024/01/) (1)
    *   [September 2023](https://bertrandmeyer.com/2023/09/) (1)
    *   [July 2023](https://bertrandmeyer.com/2023/07/) (1)
    *   [June 2023](https://bertrandmeyer.com/2023/06/) (2)
    *   [May 2023](https://bertrandmeyer.com/2023/05/) (2)
    *   [March 2023](https://bertrandmeyer.com/2023/03/) (5)
    *   [January 2023](https://bertrandmeyer.com/2023/01/) (1)
    *   [December 2022](https://bertrandmeyer.com/2022/12/) (1)
    *   [October 2022](https://bertrandmeyer.com/2022/10/) (3)
    *   [September 2022](https://bertrandmeyer.com/2022/09/) (4)
    *   [August 2022](https://bertrandmeyer.com/2022/08/) (1)
    *   [June 2022](https://bertrandmeyer.com/2022/06/) (2)
    *   [December 2021](https://bertrandmeyer.com/2021/12/) (1)
    *   [October 2021](https://bertrandmeyer.com/2021/10/) (1)
    *   [September 2021](https://bertrandmeyer.com/2021/09/) (2)
    *   [July 2021](https://bertrandmeyer.com/2021/07/) (1)
    *   [March 2021](https://bertrandmeyer.com/2021/03/) (2)
    *   [February 2021](https://bertrandmeyer.com/2021/02/) (3)
    *   [January 2021](https://bertrandmeyer.com/2021/01/) (2)
    *   [December 2020](https://bertrandmeyer.com/2020/12/) (3)
    *   [November 2020](https://bertrandmeyer.com/2020/11/) (2)
    *   [October 2020](https://bertrandmeyer.com/2020/10/) (1)
    *   [September 2020](https://bertrandmeyer.com/2020/09/) (1)
    *   [August 2020](https://bertrandmeyer.com/2020/08/) (1)
    *   [June 2020](https://bertrandmeyer.com/2020/06/) (1)
    *   [May 2020](https://bertrandmeyer.com/2020/05/) (2)
    *   [April 2020](https://bertrandmeyer.com/2020/04/) (3)
    *   [March 2020](https://bertrandmeyer.com/2020/03/) (8)
    *   [February 2020](https://bertrandmeyer.com/2020/02/) (3)
    *   [January 2020](https://bertrandmeyer.com/2020/01/) (2)
    *   [December 2019](https://bertrandmeyer.com/2019/12/) (5)
    *   [November 2019](https://bertrandmeyer.com/2019/11/) (7)
    *   [October 2019](https://bertrandmeyer.com/2019/10/) (1)
    *   [August 2019](https://bertrandmeyer.com/2019/08/) (1)
    *   [May 2019](https://bertrandmeyer.com/2019/05/) (1)
    *   [April 2019](https://bertrandmeyer.com/2019/04/) (3)
    *   [January 2019](https://bertrandmeyer.com/2019/01/) (1)
    *   [December 2018](https://bertrandmeyer.com/2018/12/) (3)
    *   [November 2018](https://bertrandmeyer.com/2018/11/) (1)
    *   [October 2018](https://bertrandmeyer.com/2018/10/) (1)
    *   [September 2018](https://bertrandmeyer.com/2018/09/) (1)
    *   [August 2018](https://bertrandmeyer.com/2018/08/) (1)
    *   [May 2018](https://bertrandmeyer.com/2018/05/) (3)
    *   [April 2018](https://bertrandmeyer.com/2018/04/) (1)
    *   [February 2018](https://bertrandmeyer.com/2018/02/) (2)
    *   [January 2018](https://bertrandmeyer.com/2018/01/) (8)
    *   [December 2017](https://bertrandmeyer.com/2017/12/) (2)
    *   [November 2017](https://bertrandmeyer.com/2017/11/) (1)
    *   [October 2017](https://bertrandmeyer.com/2017/10/) (1)
    *   [September 2017](https://bertrandmeyer.com/2017/09/) (1)
    *   [June 2017](https://bertrandmeyer.com/2017/06/) (5)
    *   [May 2017](https://bertrandmeyer.com/2017/05/) (1)
    *   [March 2017](https://bertrandmeyer.com/2017/03/) (1)
    *   [December 2016](https://bertrandmeyer.com/2016/12/) (1)
    *   [November 2016](https://bertrandmeyer.com/2016/11/) (2)
    *   [September 2016](https://bertrandmeyer.com/2016/09/) (2)
    *   [May 2016](https://bertrandmeyer.com/2016/05/) (1)
    *   [February 2016](https://bertrandmeyer.com/2016/02/) (1)
    *   [October 2015](https://bertrandmeyer.com/2015/10/) (1)
    *   [September 2015](https://bertrandmeyer.com/2015/09/) (1)
    *   [July 2015](https://bertrandmeyer.com/2015/07/) (4)
    *   [March 2015](https://bertrandmeyer.com/2015/03/) (1)
    *   [February 2015](https://bertrandmeyer.com/2015/02/) (2)
    *   [January 2015](https://bertrandmeyer.com/2015/01/) (2)
    *   [December 2014](https://bertrandmeyer.com/2014/12/) (2)
    *   [September 2014](https://bertrandmeyer.com/2014/09/) (5)
    *   [August 2014](https://bertrandmeyer.com/2014/08/) (2)
    *   [July 2014](https://bertrandmeyer.com/2014/07/) (1)
    *   [June 2014](https://bertrandmeyer.com/2014/06/) (4)
    *   [May 2014](https://bertrandmeyer.com/2014/05/) (2)
    *   [April 2014](https://bertrandmeyer.com/2014/04/) (2)
    *   [March 2014](https://bertrandmeyer.com/2014/03/) (4)
    *   [February 2014](https://bertrandmeyer.com/2014/02/) (1)
    *   [January 2014](https://bertrandmeyer.com/2014/01/) (5)
    *   [November 2013](https://bertrandmeyer.com/2013/11/) (4)
    *   [October 2013](https://bertrandmeyer.com/2013/10/) (5)
    *   [September 2013](https://bertrandmeyer.com/2013/09/) (2)
    *   [August 2013](https://bertrandmeyer.com/2013/08/) (4)
    *   [July 2013](https://bertrandmeyer.com/2013/07/) (1)
    *   [May 2013](https://bertrandmeyer.com/2013/05/) (12)
    *   [April 2013](https://bertrandmeyer.com/2013/04/) (3)
    *   [March 2013](https://bertrandmeyer.com/2013/03/) (2)
    *   [February 2013](https://bertrandmeyer.com/2013/02/) (9)
    *   [January 2013](https://bertrandmeyer.com/2013/01/) (4)
    *   [December 2012](https://bertrandmeyer.com/2012/12/) (8)
    *   [November 2012](https://bertrandmeyer.com/2012/11/) (4)
    *   [October 2012](https://bertrandmeyer.com/2012/10/) (7)
    *   [August 2012](https://bertrandmeyer.com/2012/08/) (1)
    *   [July 2012](https://bertrandmeyer.com/2012/07/) (4)
    *   [June 2012](https://bertrandmeyer.com/2012/06/) (1)
    *   [April 2012](https://bertrandmeyer.com/2012/04/) (3)
    *   [March 2012](https://bertrandmeyer.com/2012/03/) (3)
    *   [February 2012](https://bertrandmeyer.com/2012/02/) (4)
    *   [January 2012](https://bertrandmeyer.com/2012/01/) (4)
    *   [December 2011](https://bertrandmeyer.com/2011/12/) (3)
    *   [November 2011](https://bertrandmeyer.com/2011/11/) (4)
    *   [October 2011](https://bertrandmeyer.com/2011/10/) (3)
    *   [September 2011](https://bertrandmeyer.com/2011/09/) (1)
    *   [August 2011](https://bertrandmeyer.com/2011/08/) (4)
    *   [July 2011](https://bertrandmeyer.com/2011/07/) (5)
    *   [June 2011](https://bertrandmeyer.com/2011/06/) (6)
    *   [May 2011](https://bertrandmeyer.com/2011/05/) (3)
    *   [March 2011](https://bertrandmeyer.com/2011/03/) (1)
    *   [November 2010](https://bertrandmeyer.com/2010/11/) (3)
    *   [October 2010](https://bertrandmeyer.com/2010/10/) (3)
    *   [August 2010](https://bertrandmeyer.com/2010/08/) (1)
    *   [July 2010](https://bertrandmeyer.com/2010/07/) (2)
    *   [June 2010](https://bertrandmeyer.com/2010/06/) (1)
    *   [May 2010](https://bertrandmeyer.com/2010/05/) (3)
    *   [April 2010](https://bertrandmeyer.com/2010/04/) (3)
    *   [March 2010](https://bertrandmeyer.com/2010/03/) (1)
    *   [February 2010](https://bertrandmeyer.com/2010/02/) (1)
    *   [January 2010](https://bertrandmeyer.com/2010/01/) (4)
    *   [December 2009](https://bertrandmeyer.com/2009/12/) (1)
    *   [November 2009](https://bertrandmeyer.com/2009/11/) (1)
    *   [October 2009](https://bertrandmeyer.com/2009/10/) (5)
    *   [September 2009](https://bertrandmeyer.com/2009/09/) (1)
    *   [August 2009](https://bertrandmeyer.com/2009/08/) (17)
    *   [July 2009](https://bertrandmeyer.com/2009/07/) (1)
*   ## Get RSS feed
    
    [![](https://www.feedburner.com/fb/images/pub/feed-icon32x32.png)](http://feeds.feedburner.com/BertrandMeyersTechnologyBlog "Subscribe to feed") [Add feed](http://feeds.feedburner.com/BertrandMeyersTechnologyBlog "Subscribe to feed")
    
*   ## Meta
    
    *   [Register](https://bertrandmeyer.com/wp-login.php?action=register)
    *   [Log in](https://bertrandmeyer.com/wp-login.php)
    *   [Entries feed](https://bertrandmeyer.com/feed/)
    *   [Comments feed](https://bertrandmeyer.com/comments/feed/)
    *   [WordPress.org](https://wordpress.org/)

[Entries (RSS)](https://bertrandmeyer.com/feed/) and [Comments (RSS)](https://bertrandmeyer.com/comments/feed/).  
var addthis\_config = {"data\_track\_clickback":true,"ui\_atversion":300,"ignore\_server\_config":true}; var addthis\_share = {}; var addthis\_product = "wpp-5.3.4"; var wp\_product\_version = "wpp-5.3.4"; var wp\_blog\_version = "6.7.2"; var addthis\_plugin\_info = {"info\_status":"enabled","cms\_name":"WordPress","plugin\_name":"Share Buttons by AddThis","plugin\_version":"5.3.4","anonymous\_profile\_id":"wp-78f32422f909ccd54a73d875673f0b0c","plugin\_mode":"WordPress","select\_prefs":{"addthis\_per\_post\_enabled":true,"addthis\_above\_enabled":true,"addthis\_below\_enabled":true,"addthis\_sidebar\_enabled":false,"addthis\_mobile\_toolbar\_enabled":false,"addthis\_above\_showon\_home":true,"addthis\_below\_showon\_home":true,"addthis\_above\_showon\_pages":true,"addthis\_below\_showon\_pages":true,"addthis\_above\_showon\_categories":true,"addthis\_below\_showon\_categories":true,"addthis\_above\_showon\_archives":true,"addthis\_below\_showon\_archives":true,"addthis\_above\_showon\_posts":true,"addthis\_above\_showon\_excerpts":true,"addthis\_below\_showon\_posts":true,"addthis\_below\_showon\_excerpts":true,"addthis\_sidebar\_showon\_home":true,"addthis\_sidebar\_showon\_posts":true,"addthis\_sidebar\_showon\_pages":true,"addthis\_sidebar\_showon\_archives":true,"addthis\_sidebar\_showon\_categories":true,"addthis\_mobile\_toolbar\_showon\_home":true,"addthis\_mobile\_toolbar\_showon\_posts":true,"addthis\_mobile\_toolbar\_showon\_pages":true,"addthis\_mobile\_toolbar\_showon\_archives":true,"addthis\_mobile\_toolbar\_showon\_categories":true,"sharing\_enabled\_on\_post\_via\_metabox":true},"page\_info":{"template":"posts","post\_type":""}}; if (typeof(addthis\_config) == "undefined") { var addthis\_config = {"data\_track\_clickback":true,"ui\_atversion":300,"ignore\_server\_config":true}; } if (typeof(addthis\_share) == "undefined") { var addthis\_share = {}; } if (typeof(addthis\_layers) == "undefined") { var addthis\_layers = {}; } (function() { var at\_interval = setInterval(function () { if(window.addthis) { clearInterval(at\_interval); addthis.layers(addthis\_layers); } },1000) }());

---

# Echo - Open Hardware Music Player

*Source: <https://github.com/amachronic/echoplayer>*
*Published: 2025-04-23T23:10:19.000Z*

[Skip to content](#start-of-content)  {"props":{"docsUrl":"https://docs.github.com/get-started/accessibility/keyboard-shortcuts"}}

## Navigation Menu

Toggle navigation

[](/)

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Famachronic%2Fechoplayer)

*   Product
    
    *   [
        
        GitHub Copilot
        
        Write better code with AI
        
        ](https://github.com/features/copilot)
    *   [
        
        GitHub Advanced Security
        
        Find and fix vulnerabilities
        
        ](https://github.com/security/advanced-security)
    *   [
        
        Actions
        
        Automate any workflow
        
        ](https://github.com/features/actions)
    *   [
        
        Codespaces
        
        Instant dev environments
        
        ](https://github.com/features/codespaces)
    *   [
        
        Issues
        
        Plan and track work
        
        ](https://github.com/features/issues)
    *   [
        
        Code Review
        
        Manage code changes
        
        ](https://github.com/features/code-review)
    *   [
        
        Discussions
        
        Collaborate outside of code
        
        ](https://github.com/features/discussions)
    *   [
        
        Code Search
        
        Find more, search less
        
        ](https://github.com/features/code-search)
    
    Explore
    
    *   [Why GitHub](https://github.com/why-github)
    *   [All features](https://github.com/features)
    *   [Documentation](https://docs.github.com)
    *   [GitHub Skills](https://skills.github.com)
    *   [Blog](https://github.blog)
    
*   Solutions
    
    By company size
    
    *   [Enterprises](https://github.com/enterprise)
    *   [Small and medium teams](https://github.com/team)
    *   [Startups](https://github.com/enterprise/startups)
    *   [Nonprofits](/solutions/industry/nonprofits)
    
    By use case
    
    *   [DevSecOps](/solutions/use-case/devsecops)
    *   [DevOps](/solutions/use-case/devops)
    *   [CI/CD](/solutions/use-case/ci-cd)
    *   [View all use cases](/solutions/use-case)
    
    By industry
    
    *   [Healthcare](/solutions/industry/healthcare)
    *   [Financial services](/solutions/industry/financial-services)
    *   [Manufacturing](/solutions/industry/manufacturing)
    *   [Government](/solutions/industry/government)
    *   [View all industries](/solutions/industry)
    
    [View all solutions](/solutions)
    
*   Resources
    
    Topics
    
    *   [AI](/resources/articles/ai)
    *   [DevOps](/resources/articles/devops)
    *   [Security](/resources/articles/security)
    *   [Software Development](/resources/articles/software-development)
    *   [View all](/resources/articles)
    
    Explore
    
    *   [Learning Pathways](https://resources.github.com/learn/pathways)
    *   [Events & Webinars](https://resources.github.com)
    *   [Ebooks & Whitepapers](https://github.com/resources/whitepapers)
    *   [Customer Stories](https://github.com/customer-stories)
    *   [Partners](https://partner.github.com)
    *   [Executive Insights](https://github.com/solutions/executive-insights)
    
*   Open Source
    
    *   [
        
        GitHub Sponsors
        
        Fund open source developers
        
        ](/sponsors)
    
    *   [
        
        The ReadME Project
        
        GitHub community articles
        
        ](https://github.com/readme)
    
    Repositories
    
    *   [Topics](https://github.com/topics)
    *   [Trending](https://github.com/trending)
    *   [Collections](https://github.com/collections)
    
*   Enterprise
    
    *   [
        
        Enterprise platform
        
        AI-powered developer platform
        
        ](/enterprise)
    
    Available add-ons
    
    *   [
        
        GitHub Advanced Security
        
        Enterprise-grade security features
        
        ](https://github.com/security/advanced-security)
    *   [
        
        Copilot for business
        
        Enterprise-grade AI features
        
        ](/features/copilot/copilot-business)
    *   [
        
        Premium Support
        
        Enterprise-grade 24/7 support
        
        ](/premium-support)
    
*   [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

 Include my email address so I can be contacted

Cancel Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name  

Query 

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

Cancel Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Famachronic%2Fechoplayer)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=amachronic%2Fechoplayer) Reseting focus

You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert

[amachronic](/amachronic) / **[echoplayer](/amachronic/echoplayer)** Public

*   [Notifications](/login?return_to=%2Famachronic%2Fechoplayer) You must be signed in to change notification settings
*   [Fork 0](/login?return_to=%2Famachronic%2Fechoplayer)
*   [Star 26](/login?return_to=%2Famachronic%2Fechoplayer)
    

Echo - Open Hardware Music Player

### License

[CERN-OHL-S-2.0 license](/amachronic/echoplayer/blob/main/COPYING.txt)

[26 stars](/amachronic/echoplayer/stargazers) [0 forks](/amachronic/echoplayer/forks) [Branches](/amachronic/echoplayer/branches) [Tags](/amachronic/echoplayer/tags) [Activity](/amachronic/echoplayer/activity)

[Star](/login?return_to=%2Famachronic%2Fechoplayer)

[Notifications](/login?return_to=%2Famachronic%2Fechoplayer) You must be signed in to change notification settings

*   [Code](/amachronic/echoplayer)
*   [Issues 0](/amachronic/echoplayer/issues)
*   [Pull requests 0](/amachronic/echoplayer/pulls)
*   [Security](/amachronic/echoplayer/security)
*   [Insights](/amachronic/echoplayer/pulse)

Additional navigation options

*   [Code](/amachronic/echoplayer)
*   [Issues](/amachronic/echoplayer/issues)
*   [Pull requests](/amachronic/echoplayer/pulls)
*   [Security](/amachronic/echoplayer/security)
*   [Insights](/amachronic/echoplayer/pulse)

# amachronic/echoplayer

  {"props":{"initialPayload":{"allShortcutsEnabled":false,"path":"/","repo":{"id":937230650,"defaultBranch":"main","name":"echoplayer","ownerLogin":"amachronic","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2025-02-22T16:40:08.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/67187631?v=4","public":true,"private":false,"isOrgOwned":false},"currentUser":null,"refInfo":{"name":"main","listCacheKey":"v0:1744917816.0","canEdit":false,"refType":"branch","currentOid":"95a90afcf2140a27b356e634246ae6596691075b"},"tree":{"items":\[{"name":"docs","path":"docs","contentType":"directory"},{"name":"echo-r1","path":"echo-r1","contentType":"directory"},{"name":"images","path":"images","contentType":"directory"},{"name":"lib","path":"lib","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"COPYING.txt","path":"COPYING.txt","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"}\],"templateDirectorySuggestionUrl":null,"readme":null,"totalCount":7,"showBranchInfobar":false},"fileTree":null,"fileTreeProcessingTime":null,"foldersToFetch":\[\],"treeExpanded":false,"symbolsExpanded":false,"isOverview":true,"overview":{"banners":{"shouldRecommendReadme":false,"isPersonalRepo":false,"showUseActionBanner":false,"actionSlug":null,"actionId":null,"showProtectBranchBanner":false,"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish\_action\_from\_repo","releasePath":"/amachronic/echoplayer/releases/new?marketplace=true","showPublishActionBanner":false},"interactionLimitBanner":null,"showInvitationBanner":false,"inviterName":null,"actionsMigrationBannerInfo":{"releaseTags":\[\],"showImmutableActionsMigrationBanner":false,"initialMigrationStatus":null}},"codeButton":{"contactPath":"/contact","isEnterprise":false,"local":{"protocolInfo":{"httpAvailable":true,"sshAvailable":null,"httpUrl":"https://github.com/amachronic/echoplayer.git","showCloneWarning":null,"sshUrl":null,"sshCertificatesRequired":null,"sshCertificatesAvailable":null,"ghCliUrl":"gh repo clone amachronic/echoplayer","defaultProtocol":"http","newSshKeyUrl":"/settings/ssh/new","setProtocolPath":"/users/set\_protocol"},"platformInfo":{"cloneUrl":"https://desktop.github.com","showVisualStudioCloneButton":false,"visualStudioCloneUrl":"https://windows.github.com","showXcodeCloneButton":false,"xcodeCloneUrl":"xcode://clone?repo=https%3A%2F%2Fgithub.com%2Famachronic%2Fechoplayer","zipballUrl":"/amachronic/echoplayer/archive/refs/heads/main.zip"}},"newCodespacePath":"/codespaces/new?hide\_repo\_select=true\\u0026repo=937230650"},"popovers":{"rename":null,"renamedParentRepo":null},"commitCount":"2","overviewFiles":\[{"displayName":"README.md","repoName":"echoplayer","refName":"main","path":"README.md","preferredFileType":"readme","tabName":"README","richText":"\\u003carticle class=\\"markdown-body entry-content container-lg\\" itemprop=\\"text\\"\\u003e\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch1 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eEcho: Open Hardware Music Player\\u003c/h1\\u003e\\u003ca id=\\"user-content-echo-open-hardware-music-player\\" class=\\"anchor\\" aria-label=\\"Permalink: Echo: Open Hardware Music Player\\" href=\\"#echo-open-hardware-music-player\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eEcho is an open hardware platform for music players. The goal of\\nthe project is to produce a high quality music player, based on\\nand designed with free software. It's primarily designed to run\\n\\u003ca href=\\"https://www.rockbox.org\\" rel=\\"nofollow\\"\\u003eRockbox\\u003c/a\\u003e, a free music player firmware\\nwith support for many codecs, and a wide array of features.\\u003c/p\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eKiCAD 8.0 was used for the electrical design and PCB layout.\\nThe planned 3D-printable case will be designed using FreeCAD.\\nThe designs themselves are available under the CERN-OHL-S v2\\nlicense.\\u003c/p\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThe current version of the Echo player is called the Echo R1.\\nIn the future, there could be new player models if there are\\nsignificant changes to the features or form factor, but old\\nmodels will always be supported.\\u003c/p\\u003e\\n\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch2 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eEcho R1\\u003c/h2\\u003e\\u003ca id=\\"user-content-echo-r1\\" class=\\"anchor\\" aria-label=\\"Permalink: Echo R1\\" href=\\"#echo-r1\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cp dir=\\"auto\\"\\u003e\\u003ca target=\\"\_blank\\" rel=\\"noopener noreferrer\\" href=\\"/amachronic/echoplayer/blob/main/images/echo-r1.png\\"\\u003e\\u003cimg src=\\"/amachronic/echoplayer/raw/main/images/echo-r1.png\\" alt=\\"3D render of Echo R1 case\\" style=\\"max-width: 100%;\\"\\u003e\\u003c/a\\u003e\\u003c/p\\u003e\\n\\u003cul dir=\\"auto\\"\\u003e\\n\\u003cli\\u003eSize: 60x100x15mm (approx)\\u003c/li\\u003e\\n\\u003cli\\u003eWeight: TBD\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThe R1 has a 4-way D-pad and 6 multi-function buttons on the\\nfaceplate, which can be used to quickly navigate your music\\nlibrary and control playback. There are dedicated volume and\\npower buttons (not pictured), and a sliding hold switch near\\nthe power button, which locks the buttons against accidental\\npresses when the player is in your pocket or bag.\\u003c/p\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThere are two 3.5mm jacks, one for headphones, and one true\\nline-out port. The headphone jack supports recording from an\\nin-line microphone and playback control by an in-line remote.\\nBoth jacks can be used simultaneously.\\u003c/p\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThe removable memory card slot allows up to 2 TiB of storage\\nfor your music and files. The USB-C port is used for charging\\nand file transfer, and supports high-speed USB 2.0.\\u003c/p\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThe battery socket accepts the widely available BL-5C battery,\\nand the battery can easily be replaced without special tools\\nwhen it starts to wear out.\\u003c/p\\u003e\\n\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch3 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eHardware specifications\\u003c/h3\\u003e\\u003ca id=\\"user-content-hardware-specifications\\" class=\\"anchor\\" aria-label=\\"Permalink: Hardware specifications\\" href=\\"#hardware-specifications\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cmarkdown-accessiblity-table\\u003e\\u003ctable\\u003e\\n\\u003cthead\\u003e\\n\\u003ctr\\u003e\\n\\u003cth\\u003eComponent\\u003c/th\\u003e\\n\\u003cth\\u003eDescription\\u003c/th\\u003e\\n\\u003c/tr\\u003e\\n\\u003c/thead\\u003e\\n\\u003ctbody\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eCPU\\u003c/td\\u003e\\n\\u003ctd\\u003eSTM32H743 @ 480 MHz\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eMemory\\u003c/td\\u003e\\n\\u003ctd\\u003e32 MiB SDRAM @ 120 MHz\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eAudio\\u003c/td\\u003e\\n\\u003ctd\\u003eTLV320AIC3104, up to 96 KHz, 0.707 V RMS\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eDisplay\\u003c/td\\u003e\\n\\u003ctd\\u003e18-bit, 320x240, 2.3 inch LCD\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eStorage\\u003c/td\\u003e\\n\\u003ctd\\u003eExpandable external memory card slot\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eUSB\\u003c/td\\u003e\\n\\u003ctd\\u003eUSB 2.0 @ 480 Mbps (High-speed)\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eHeadphone out\\u003c/td\\u003e\\n\\u003ctd\\u003eYes (3.5mm jack)\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eLine out\\u003c/td\\u003e\\n\\u003ctd\\u003eYes (3.5mm jack)\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eMicrophone\\u003c/td\\u003e\\n\\u003ctd\\u003eCan use wired headphone mic\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eRTC\\u003c/td\\u003e\\n\\u003ctd\\u003eYes, with wake-up alarm function\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003ctr\\u003e\\n\\u003ctd\\u003eBattery\\u003c/td\\u003e\\n\\u003ctd\\u003eReplaceable BL-5C battery (~1000 mAH)\\u003c/td\\u003e\\n\\u003c/tr\\u003e\\n\\u003c/tbody\\u003e\\n\\u003c/table\\u003e\\u003c/markdown-accessiblity-table\\u003e\\n\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch3 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eStatus\\u003c/h3\\u003e\\u003ca id=\\"user-content-status\\" class=\\"anchor\\" aria-label=\\"Permalink: Status\\" href=\\"#status\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThe Rev1 prototype PCB is complete but has some problems (see the\\nlist of known issues below). A 3D-printable case for the Rev1 is\\nplanned, but CAD files aren't available yet.\\u003c/p\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eDevelopment is currently focused on two areas:\\u003c/p\\u003e\\n\\u003cul dir=\\"auto\\"\\u003e\\n\\u003cli\\u003ePorting Rockbox to the Rev1 board to identify any issues with\\nthe hardware design.\\u003c/li\\u003e\\n\\u003cli\\u003eDesigning a case to test general usability and ergonomics, and\\nfind issues with the mechanical design of the PCB.\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eThe next revision will be focused on addressing issues from Rev1.\\u003c/p\\u003e\\n\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch3 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eKnown issues\\u003c/h3\\u003e\\u003ca id=\\"user-content-known-issues\\" class=\\"anchor\\" aria-label=\\"Permalink: Known issues\\" href=\\"#known-issues\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cul dir=\\"auto\\"\\u003e\\n\\u003cli\\u003eThe backlight cannot be disabled, power is supplied to the LEDs\\neven when the boost converter is disabled.\\u003c/li\\u003e\\n\\u003cli\\u003eThe current limit on the backlight LED driver is set too low\\n(20 mA paralleled to 4 LEDs, should be 20 mA per LED).\\u003c/li\\u003e\\n\\u003cli\\u003eReference designators in the schematics don't make much sense,\\nthere are gaps in the numbering and samed-valued components are\\nnot in contiguous ranges.\\u003c/li\\u003e\\n\\u003c/ul\\u003e\\n\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch2 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eLicense\\u003c/h2\\u003e\\u003ca id=\\"user-content-license\\" class=\\"anchor\\" aria-label=\\"Permalink: License\\" href=\\"#license\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eUnless otherwise noted, all files in this repository, including\\nthis README, are available under the terms of the CERN-OHL-S\\nversion 2 license, which should be found in the file \\u003ccode\\u003eCOPYING.txt\\u003c/code\\u003e\\nalongside this README; or at \\u003ca href=\\"https://ohwr.org/cern\_ohl\_s\_v2.txt\\" rel=\\"nofollow\\"\\u003ehttps://ohwr.org/cern\_ohl\_s\_v2.txt\\u003c/a\\u003e.\\u003c/p\\u003e\\n\\u003cdiv class=\\"markdown-heading\\" dir=\\"auto\\"\\u003e\\u003ch2 tabindex=\\"-1\\" class=\\"heading-element\\" dir=\\"auto\\"\\u003eCredits\\u003c/h2\\u003e\\u003ca id=\\"user-content-credits\\" class=\\"anchor\\" aria-label=\\"Permalink: Credits\\" href=\\"#credits\\"\\u003e\\u003csvg class=\\"octicon octicon-link\\" viewBox=\\"0 0 16 16\\" version=\\"1.1\\" width=\\"16\\" height=\\"16\\" aria-hidden=\\"true\\"\\u003e\\u003cpath d=\\"m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z\\"\\u003e\\u003c/path\\u003e\\u003c/svg\\u003e\\u003c/a\\u003e\\u003c/div\\u003e\\n\\u003cp dir=\\"auto\\"\\u003eCopyright (C) 2024-2025 Aidan MacDonald\\u003c/p\\u003e\\n\\u003c/article\\u003e","loaded":true,"timedOut":false,"errorMessage":null,"headerInfo":{"toc":\[{"level":1,"text":"Echo: Open Hardware Music Player","anchor":"echo-open-hardware-music-player","htmlText":"Echo: Open Hardware Music Player"},{"level":2,"text":"Echo R1","anchor":"echo-r1","htmlText":"Echo R1"},{"level":3,"text":"Hardware specifications","anchor":"hardware-specifications","htmlText":"Hardware specifications"},{"level":3,"text":"Status","anchor":"status","htmlText":"Status"},{"level":3,"text":"Known issues","anchor":"known-issues","htmlText":"Known issues"},{"level":2,"text":"License","anchor":"license","htmlText":"License"},{"level":2,"text":"Credits","anchor":"credits","htmlText":"Credits"}\],"siteNavLoginPath":"/login?return\_to=https%3A%2F%2Fgithub.com%2Famachronic%2Fechoplayer"}},{"displayName":"COPYING.txt","repoName":"echoplayer","refName":"main","path":"COPYING.txt","preferredFileType":"license","tabName":"CERN-OHL-S-2.0","richText":null,"loaded":false,"timedOut":false,"errorMessage":null,"headerInfo":{"toc":null,"siteNavLoginPath":"/login?return\_to=https%3A%2F%2Fgithub.com%2Famachronic%2Fechoplayer"}}\],"overviewFilesProcessingTime":0}},"appPayload":{"helpUrl":"https://docs.github.com","findFileWorkerPath":"/assets-cdn/worker/find-file-worker-7d7eb7c71814.js","findInFileWorkerPath":"/assets-cdn/worker/find-in-file-worker-708ec8ade250.js","githubDevUrl":null,"enabled\_features":{"copilot\_workspace":null,"code\_nav\_ui\_events":false,"react\_blob\_overlay":false,"accessible\_code\_button":true,"github\_models\_repo\_integration":false}}}}

.iVEunk{margin-top:16px;margin-bottom:16px;}/\*!sc\*/ .jzuOtQ{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}/\*!sc\*/ .bGojzy{margin-bottom:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;row-gap:16px;}/\*!sc\*/ .iNSVHo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;padding-bottom:16px;padding-top:8px;}/\*!sc\*/ .bVgnfw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:8px;}/\*!sc\*/ @media screen and (max-width:320px){.bVgnfw{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}}/\*!sc\*/ .CEgMp{position:relative;}/\*!sc\*/ @media screen and (max-width:380px){.CEgMp .ref-selector-button-text-container{max-width:80px;}}/\*!sc\*/ @media screen and (max-width:320px){.CEgMp{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}.CEgMp .overview-ref-selector{width:100%;}.CEgMp .overview-ref-selector > span{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;}.CEgMp .overview-ref-selector > span > span\[data-component="text"\]{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}}/\*!sc\*/ .gMOVLe\[data-size="medium"\]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-width:0;}/\*!sc\*/ .gMOVLe\[data-size="medium"\] svg{color:var(--fgColor-muted,var(--color-fg-muted,#656d76));}/\*!sc\*/ .gMOVLe\[data-size="medium"\] > span{width:inherit;}/\*!sc\*/ .gUkoLg{-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}/\*!sc\*/ .bZBlpz{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;}/\*!sc\*/ .lhTYNA{margin-right:4px;color:var(--fgColor-muted,var(--color-fg-muted,#656d76));}/\*!sc\*/ .ffLUq{font-size:14px;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}/\*!sc\*/ .bmcJak{min-width:0;}/\*!sc\*/ .fLXEGX{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/\*!sc\*/ @media screen and (max-width:1079px){.fLXEGX{display:none;}}/\*!sc\*/ .lmSMZJ\[data-size="medium"\]{color:var(--fgColor-muted,var(--color-fg-muted,#656d76));padding-left:4px;padding-right:4px;}/\*!sc\*/ .lmSMZJ\[data-size="medium"\] span\[data-component="leadingVisual"\]{margin-right:4px !important;}/\*!sc\*/ .dqfxud{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/\*!sc\*/ @media screen and (min-width:1080px){.dqfxud{display:none;}}/\*!sc\*/ @media screen and (max-width:543px){.dqfxud{display:none;}}/\*!sc\*/ .fGwBZA\[data-size="medium"\]\[data-no-visuals\]{color:var(--fgColor-muted,var(--color-fg-muted,#656d76));}/\*!sc\*/ .jxTzTd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding-left:8px;gap:8px;}/\*!sc\*/ .gqqBXN{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:8px;}/\*!sc\*/ @media screen and (max-width:543px){.gqqBXN{display:none;}}/\*!sc\*/ .dzXgxt{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/\*!sc\*/ @media screen and (max-width:1011px){.dzXgxt{display:none;}}/\*!sc\*/ .iWFGlI{margin-left:8px;margin-right:8px;margin:0;}/\*!sc\*/ .vcvyP{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-width:160px;}/\*!sc\*/ .YUPas{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/\*!sc\*/ @media screen and (min-width:1012px){.YUPas{display:none;}}/\*!sc\*/ .izFOf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}/\*!sc\*/ @media screen and (min-width:544px){.izFOf{display:none;}}/\*!sc\*/ .vIPPs{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;gap:16px;}/\*!sc\*/ .fdROMU{width:100%;border-collapse:separate;border-spacing:0;border:1px solid;border-color:var(--borderColor-default,var(--color-border-default,#d0d7de));border-radius:6px;table-layout:fixed;overflow:unset;}/\*!sc\*/ .jGKpsv{height:0px;line-height:0px;}/\*!sc\*/ .jGKpsv tr{height:0px;font-size:0px;}/\*!sc\*/ .jdgHnn{padding:16px;color:var(--fgColor-muted,var(--color-fg-muted,#656d76));font-size:12px;text-align:left;height:40px;}/\*!sc\*/ .jdgHnn th{padding-left:16px;background-color:var(--bgColor-muted,var(--color-canvas-subtle,#f6f8fa));}/\*!sc\*/ .bQivRW{width:100%;border-top-left-radius:6px;}/\*!sc\*/ @media screen and (min-width:544px){.bQivRW{display:none;}}/\*!sc\*/ .ldkMIO{width:40%;border-top-left-radius:6px;}/\*!sc\*/ @media screen and (max-width:543px){.ldkMIO{display:none;}}/\*!sc\*/ .jMbWeI{text-align:right;padding-right:16px;width:136px;border-top-right-radius:6px;}/\*!sc\*/ .gpqjiB{color:var(--fgColor-muted,var(--color-fg-muted,#656d76));font-size:12px;height:40px;}/\*!sc\*/ .dzCJzi{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:8px;min-width:273px;padding:8px;}/\*!sc\*/ @media screen and (min-width:544px){.dzCJzi{-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;}}/\*!sc\*/ .eNCcrz{text-align:center;vertical-align:center;height:40px;border-top:1px solid;border-color:var(--borderColor-default,var(--color-border-default,#d0d7de));}/\*!sc\*/ .bHTcCe{border-top:1px solid var(--borderColor-default,var(--color-border-default));cursor:pointer;}/\*!sc\*/ .csrIcr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;gap:16px;}/\*!sc\*/ .bUQNHB{border:1px solid;border-color:var(--borderColor-default,var(--color-border-default,#d0d7de));border-radius:6px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}/\*!sc\*/ @media screen and (max-width:543px){.bUQNHB{margin-left:-16px;margin-right:-16px;max-width:calc(100% + 32px);}}/\*!sc\*/ @media screen and (min-width:544px){.bUQNHB{max-width:100%;}}/\*!sc\*/ .jPdcfu{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;border-bottom:1px solid;border-bottom-color:var(--borderColor-default,var(--color-border-default,#d0d7de));-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-right:8px;position:-webkit-sticky;position:sticky;top:0;background-color:var(--bgColor-default,var(--color-canvas-default,#ffffff));z-index:1;border-top-left-radius:6px;border-top-right-radius:6px;}/\*!sc\*/ .iphEWz{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;border-bottom:none;max-width:100%;padding-left:8px;padding-right:8px;}/\*!sc\*/ .hUCRAk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/\*!sc\*/ .cwoBXV\[data-size="medium"\]{color:var(--fgColor-muted,var(--color-fg-subtle,#6e7781));padding-left:8px;padding-right:8px;}/\*!sc\*/ .QkQOb{padding:32px;overflow:auto;}/\*!sc\*/ data-styled.g1\[id="Box-sc-g0xbh4-0"\]{content:"iVEunk,jzuOtQ,bGojzy,iNSVHo,bVgnfw,CEgMp,gMOVLe,gUkoLg,bZBlpz,lhTYNA,ffLUq,bmcJak,fLXEGX,lmSMZJ,dqfxud,fGwBZA,jxTzTd,gqqBXN,dzXgxt,iWFGlI,vcvyP,YUPas,izFOf,vIPPs,fdROMU,jGKpsv,jdgHnn,bQivRW,ldkMIO,jMbWeI,gpqjiB,dzCJzi,eNCcrz,bHTcCe,csrIcr,bUQNHB,jPdcfu,iphEWz,hUCRAk,cwoBXV,QkQOb,"}/\*!sc\*/ .brGdpi{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;-webkit-clip:rect(0,0,0,0);clip:rect(0,0,0,0);white-space:nowrap;border-width:0;}/\*!sc\*/ data-styled.g4\[id="\_VisuallyHidden\_\_VisuallyHidden-sc-11jhm7a-0"\]{content:"brGdpi,"}/\*!sc\*/ .hWlpPn{position:relative;display:inline-block;}/\*!sc\*/ .hWlpPn::after{position:absolute;z-index:1000000;display:none;padding:0.5em 0.75em;font:normal normal 11px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";-webkit-font-smoothing:subpixel-antialiased;color:var(--tooltip-fgColor,var(--fgColor-onEmphasis,var(--color-fg-on-emphasis,#ffffff)));text-align:center;-webkit-text-decoration:none;text-decoration:none;text-shadow:none;text-transform:none;-webkit-letter-spacing:normal;-moz-letter-spacing:normal;-ms-letter-spacing:normal;letter-spacing:normal;word-wrap:break-word;white-space:pre;pointer-events:none;content:attr(aria-label);background:var(--tooltip-bgColor,var(--bgColor-emphasis,var(--color-neutral-emphasis-plus,#24292f)));border-radius:6px;opacity:0;}/\*!sc\*/ @-webkit-keyframes tooltip-appear{from{opacity:0;}to{opacity:1;}}/\*!sc\*/ @keyframes tooltip-appear{from{opacity:0;}to{opacity:1;}}/\*!sc\*/ .hWlpPn:hover::after,.hWlpPn:active::after,.hWlpPn:focus::after,.hWlpPn:focus-within::after{display:inline-block;-webkit-text-decoration:none;text-decoration:none;-webkit-animation-name:tooltip-appear;animation-name:tooltip-appear;-webkit-animation-duration:0.1s;animation-duration:0.1s;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in;-webkit-animation-delay:0s;animation-delay:0s;}/\*!sc\*/ .hWlpPn.tooltipped-no-delay:hover::after,.hWlpPn.tooltipped-no-delay:active::after,.hWlpPn.tooltipped-no-delay:focus::after,.hWlpPn.tooltipped-no-delay:focus-within::after{-webkit-animation-delay:0s;animation-delay:0s;}/\*!sc\*/ .hWlpPn.tooltipped-multiline:hover::after,.hWlpPn.tooltipped-multiline:active::after,.hWlpPn.tooltipped-multiline:focus::after,.hWlpPn.tooltipped-multiline:focus-within::after{display:table-cell;}/\*!sc\*/ .hWlpPn.tooltipped-s::after,.hWlpPn.tooltipped-se::after,.hWlpPn.tooltipped-sw::after{top:100%;right:50%;margin-top:6px;}/\*!sc\*/ .hWlpPn.tooltipped-se::after{right:auto;left:50%;margin-left:-16px;}/\*!sc\*/ .hWlpPn.tooltipped-sw::after{margin-right:-16px;}/\*!sc\*/ .hWlpPn.tooltipped-n::after,.hWlpPn.tooltipped-ne::after,.hWlpPn.tooltipped-nw::after{right:50%;bottom:100%;margin-bottom:6px;}/\*!sc\*/ .hWlpPn.tooltipped-ne::after{right:auto;left:50%;margin-left:-16px;}/\*!sc\*/ .hWlpPn.tooltipped-nw::after{margin-right:-16px;}/\*!sc\*/ .hWlpPn.tooltipped-s::after,.hWlpPn.tooltipped-n::after{-webkit-transform:translateX(50%);-ms-transform:translateX(50%);transform:translateX(50%);}/\*!sc\*/ .hWlpPn.tooltipped-w::after{right:100%;bottom:50%;margin-right:6px;-webkit-transform:translateY(50%);-ms-transform:translateY(50%);transform:translateY(50%);}/\*!sc\*/ .hWlpPn.tooltipped-e::after{bottom:50%;left:100%;margin-left:6px;-webkit-transform:translateY(50%);-ms-transform:translateY(50%);transform:translateY(50%);}/\*!sc\*/ .hWlpPn.tooltipped-multiline::after{width:-webkit-max-content;width:-moz-max-content;width:max-content;max-width:250px;word-wrap:break-word;white-space:pre-line;border-collapse:separate;}/\*!sc\*/ .hWlpPn.tooltipped-multiline.tooltipped-s::after,.hWlpPn.tooltipped-multiline.tooltipped-n::after{right:auto;left:50%;-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%);transform:translateX(-50%);}/\*!sc\*/ .hWlpPn.tooltipped-multiline.tooltipped-w::after,.hWlpPn.tooltipped-multiline.tooltipped-e::after{right:100%;}/\*!sc\*/ .hWlpPn.tooltipped-align-right-2::after{right:0;margin-right:0;}/\*!sc\*/ .hWlpPn.tooltipped-align-left-2::after{left:0;margin-left:0;}/\*!sc\*/ data-styled.g10\[id="Tooltip\_\_TooltipBase-sc-17tf59c-0"\]{content:"hWlpPn,"}/\*!sc\*/ .liVpTx{display:inline-block;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;max-width:125px;}/\*!sc\*/ data-styled.g12\[id="Truncate\_\_StyledTruncate-sc-23o1d2-0"\]{content:"liVpTx,"}/\*!sc\*/

 main

[Branches](/amachronic/echoplayer/branches)[Tags](/amachronic/echoplayer/tags)

[](/amachronic/echoplayer/branches)[](/amachronic/echoplayer/tags)

Go to file

Code

## Folders and files

Name

Name

Last commit message

Last commit date

## Latest commit

## History

[2 Commits](/amachronic/echoplayer/commits/main/)

[](/amachronic/echoplayer/commits/main/)

[docs](/amachronic/echoplayer/tree/main/docs "docs")

[docs](/amachronic/echoplayer/tree/main/docs "docs")

[echo-r1](/amachronic/echoplayer/tree/main/echo-r1 "echo-r1")

[echo-r1](/amachronic/echoplayer/tree/main/echo-r1 "echo-r1")

[images](/amachronic/echoplayer/tree/main/images "images")

[images](/amachronic/echoplayer/tree/main/images "images")

[lib](/amachronic/echoplayer/tree/main/lib "lib")

[lib](/amachronic/echoplayer/tree/main/lib "lib")

[.gitignore](/amachronic/echoplayer/blob/main/.gitignore ".gitignore")

[.gitignore](/amachronic/echoplayer/blob/main/.gitignore ".gitignore")

[COPYING.txt](/amachronic/echoplayer/blob/main/COPYING.txt "COPYING.txt")

[COPYING.txt](/amachronic/echoplayer/blob/main/COPYING.txt "COPYING.txt")

[README.md](/amachronic/echoplayer/blob/main/README.md "README.md")

[README.md](/amachronic/echoplayer/blob/main/README.md "README.md")

View all files

## Repository files navigation

*   [README](#)
*   [CERN-OHL-S-2.0 license](#)

# Echo: Open Hardware Music Player

[](#echo-open-hardware-music-player)

Echo is an open hardware platform for music players. The goal of the project is to produce a high quality music player, based on and designed with free software. It's primarily designed to run [Rockbox](https://www.rockbox.org), a free music player firmware with support for many codecs, and a wide array of features.

KiCAD 8.0 was used for the electrical design and PCB layout. The planned 3D-printable case will be designed using FreeCAD. The designs themselves are available under the CERN-OHL-S v2 license.

The current version of the Echo player is called the Echo R1. In the future, there could be new player models if there are significant changes to the features or form factor, but old models will always be supported.

## Echo R1

[](#echo-r1)

[![3D render of Echo R1 case](/amachronic/echoplayer/raw/main/images/echo-r1.png)](/amachronic/echoplayer/blob/main/images/echo-r1.png)

*   Size: 60x100x15mm (approx)
*   Weight: TBD

The R1 has a 4-way D-pad and 6 multi-function buttons on the faceplate, which can be used to quickly navigate your music library and control playback. There are dedicated volume and power buttons (not pictured), and a sliding hold switch near the power button, which locks the buttons against accidental presses when the player is in your pocket or bag.

There are two 3.5mm jacks, one for headphones, and one true line-out port. The headphone jack supports recording from an in-line microphone and playback control by an in-line remote. Both jacks can be used simultaneously.

The removable memory card slot allows up to 2 TiB of storage for your music and files. The USB-C port is used for charging and file transfer, and supports high-speed USB 2.0.

The battery socket accepts the widely available BL-5C battery, and the battery can easily be replaced without special tools when it starts to wear out.

### Hardware specifications

[](#hardware-specifications)

Component

Description

CPU

STM32H743 @ 480 MHz

Memory

32 MiB SDRAM @ 120 MHz

Audio

TLV320AIC3104, up to 96 KHz, 0.707 V RMS

Display

18-bit, 320x240, 2.3 inch LCD

Storage

Expandable external memory card slot

USB

USB 2.0 @ 480 Mbps (High-speed)

Headphone out

Yes (3.5mm jack)

Line out

Yes (3.5mm jack)

Microphone

Can use wired headphone mic

RTC

Yes, with wake-up alarm function

Battery

Replaceable BL-5C battery (~1000 mAH)

### Status

[](#status)

The Rev1 prototype PCB is complete but has some problems (see the list of known issues below). A 3D-printable case for the Rev1 is planned, but CAD files aren't available yet.

Development is currently focused on two areas:

*   Porting Rockbox to the Rev1 board to identify any issues with the hardware design.
*   Designing a case to test general usability and ergonomics, and find issues with the mechanical design of the PCB.

The next revision will be focused on addressing issues from Rev1.

### Known issues

[](#known-issues)

*   The backlight cannot be disabled, power is supplied to the LEDs even when the boost converter is disabled.
*   The current limit on the backlight LED driver is set too low (20 mA paralleled to 4 LEDs, should be 20 mA per LED).
*   Reference designators in the schematics don't make much sense, there are gaps in the numbering and samed-valued components are not in contiguous ranges.

## License

[](#license)

Unless otherwise noted, all files in this repository, including this README, are available under the terms of the CERN-OHL-S version 2 license, which should be found in the file `COPYING.txt` alongside this README; or at [https://ohwr.org/cern\_ohl\_s\_v2.txt](https://ohwr.org/cern_ohl_s_v2.txt).

## Credits

[](#credits)

Copyright (C) 2024-2025 Aidan MacDonald

{"resolvedServerColorMode":"day"}

## About

Echo - Open Hardware Music Player

### Resources

[Readme](#readme-ov-file)

### License

[CERN-OHL-S-2.0 license](#CERN-OHL-S-2.0-1-ov-file)

[Activity](/amachronic/echoplayer/activity)

### Stars

[**26** stars](/amachronic/echoplayer/stargazers)

### Watchers

[**6** watching](/amachronic/echoplayer/watchers)

### Forks

[**0** forks](/amachronic/echoplayer/forks)

[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Famachronic%2Fechoplayer&report=amachronic+%28user%29)

## [Releases](/amachronic/echoplayer/releases)

[1 tags](/amachronic/echoplayer/tags)

## [Packages 0](/users/amachronic/packages?repo_name=echoplayer)

No packages published  

## Footer

[](https://github.com "GitHub")© 2025 GitHub, Inc.

### Footer navigation

*   [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
*   [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
*   [Security](https://github.com/security)
*   [Status](https://www.githubstatus.com/)
*   [Docs](https://docs.github.com/)
*   [Contact](https://support.github.com?tags=dotcom-footer)
*   Manage cookies
*   Do not share my personal information

You can’t perform that action at this time.

---

# Linux syscall tables

*Source: <https://syscalls.mebeim.net/?table=x86/64/x64/latest>*
*Published: 2025-04-23T22:12:23.000Z*

# Linux kernel syscall tables

## Loading database...

## Sorry, this website needs JavaScript to work!

## Architecture: Kernel version:

### Powered by [Systrack](https://github.com/mebeim/systrack "Systrack on GitHub") v \[JSON table\] \[kernel config\] \[analysis log\] \[[website source](https://github.com/mebeim/linux-syscalls "Source code for this website on GitHub")\]

Signature

Number

Name

Symbol

Definition location

Kconfig

Copyright © 2023-2024 Marco Bonelli — Licensed under the GNU General Public License v3.0

---

# Hyperscaling Have I Been Pwned with Cloudflare Workers and Caching

*Source: <https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/>*
*Published: 2025-04-23T06:50:23.000Z*

*   [Home](https://www.troyhunt.com/)
*   [Workshops](https://www.troyhunt.com/workshops/)
*   [Speaking](https://www.troyhunt.com/speaking/)
*   [Media](https://www.troyhunt.com/media/)
*   [About](https://www.troyhunt.com/about/)
*   [Contact](https://www.troyhunt.com/contact/)
*   [Sponsor](https://www.troyhunt.com/sponsorship/)

*   [](https://twitter.com/troyhunt)
*   [](https://www.facebook.com/troyahunt)
*   [](https://www.linkedin.com/in/troyhunt)
*   [](https://www.youtube.com/user/troyhuntdotcom)
*   [](https://feeds.feedburner.com/TroyHunt)

**Sponsored by:**

# Closer to the Edge: Hyperscaling Have I Been Pwned with Cloudflare Workers and Caching

*   [](https://twitter.com/share?url=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/&text=Troy%20Hunt%3A%20Closer%20to%20the%20Edge%3A%20Hyperscaling%20Have%20I%20Been%20Pwned%20with%20Cloudflare%20Workers%20and%20Caching)
*   [](https://www.facebook.com/sharer/sharer.php?u=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/)
*   [](https://www.linkedin.com/shareArticle?mini=true&url=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/)
*   [](https://reddit.com/submit?url=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/&title=Troy%20Hunt%3A%20Closer%20to%20the%20Edge%3A%20Hyperscaling%20Have%20I%20Been%20Pwned%20with%20Cloudflare%20Workers%20and%20Caching)
*   [](mailto:?subject=Troy%20Hunt%3A%20Closer%20to%20the%20Edge%3A%20Hyperscaling%20Have%20I%20Been%20Pwned%20with%20Cloudflare%20Workers%20and%20Caching&body=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/)

21 November 2024

I've spent more than a decade now [writing about how to make Have I Been Pwned (HIBP) fast](https://www.troyhunt.com/working-with-154-million-records-on/). _Really_ fast. Fast to the extent that sometimes, it was even _too_ fast:

> The response from each search was coming back so quickly that the user wasn’t sure if it was legitimately checking subsequent addresses they entered or if there was a glitch.

Over the years, the service has evolved to use emerging new techniques to not just make things fast, but make them scale more under load, increase availability and sometimes, even drive down cost. For example, 8 years ago now [I started rolling the most important services to Azure Functions, "serverless" code](https://www.troyhunt.com/azure-functions-in-practice/) that was no longer bound by logical machines and would just scale out to whatever volume of requests was thrown at it. And just last year, [I turned on Cloudflare cache reserve to ensure that all cachable objects _remained_ cached](https://www.troyhunt.com/to-infinity-and-beyond-with-cloudflare-cache-reserve/), even under conditions where they previously would have been evicted.

And now, the pièce de résistance, the coolest performance thing we've done to date (and it is now "we", [thank you Stefán](https://www.troyhunt.com/have-i-been-pwned-employee-1-0-stefan-jokull-sigurdarson/)): just caching the whole lot at Cloudflare. Everything. Every search you do... almost. Let me explain, firstly by way of some background:

When you hit any of the services on HIBP, the first place the traffic goes from your browser is to one of [Cloudflare's 330 "edge nodes"](https://www.cloudflare.com/en-au/lp/ppc/overview-x/?ref=troyhunt.com):

![](https://www.troyhunt.com/content/images/2024/11/Artboard-1.png)

As I sit here writing this on the Gold Coast on Australia's most eastern seaboard, any request I make to HIBP hits that edge node on the far right of the Aussie continent which is just up the road in Brisbane. The capital city of our great state of Queensland is just a short jet ski away, about 80km as the crow flies. Before now, every single time I searched HIBP from home, my request bytes would travel up the wire to Brisbane and then take a giant 12,000km trip to Seattle where the Azure Function in the West US Azure data would query the database before sending the response 12,000km back west to Cloudflare's edge node, then the final 80km down to my Surfers Paradise home. But what if it didn't have to be that way? What if that data was already sitting on the Cloudflare edge node in Brisbane? And the one in Paris, and the one in well, I'm not even sure where all those blue dots are, but what if it was _everywhere?_ Several awesome things would happen:

1.  You'd get your response much faster as we've just shaved off more than 99% of the distance the bytes need to travel.
2.  The availability would massively improve as there are far fewer nodes for the traffic to traverse through, plus when a response is cached, we're no longer dependent on the Azure Function or underlying storage mechanism.
3.  We'd save on Azure Function execution costs, storage account hits and especially egress bandwidth ([which is _very_ expensive](https://www.troyhunt.com/how-i-got-pwned-by-my-cloud-costs/)).

In short, pushing data and processing "closer to the edge" benefits both our customers and ourselves. But how do you do that for 5 _billion_ unique email addresses? (Note: As of today, HIBP reports over 14 billion breached accounts, the number of unique email addresses is lower as on average, each breached address has appeared in multiple breaches.) To answer this question, let's recap on how the data is queried:

1.  [Via the front page of the website](https://haveibeenpwned.com/?ref=troyhunt.com). This hits a "unified search" API which accepts an email address and [uses Cloudflare's Turnstile to prohibit automated requests not originating from the browser](https://www.troyhunt.com/fighting-api-bots-with-cloudflares-invisible-turnstile/).
2.  [Via the public API](https://haveibeenpwned.com/API/v3?ref=troyhunt.com#BreachesForAccount). This endpoint also takes an email address as input and then returns all breaches it appears in.
3.  [Via the k-anonyity enterprise API](https://www.troyhunt.com/were-baking-have-i-been-pwned-into-firefox-and-1password/). This endpoint is used by a handful of large subscribers such as Mozilla and 1Password. Instead of searching by email address, it implements k-anonymity and searches by hash prefix.

Let's delve into that last point further because it's the secret sauce to how this whole caching model works. In order to provide subscribers of this service with complete anonymity over the email addresses being searched for, the only data passed to the API is the first six characters of the SHA-1 hash of the full email address. If this sounds odd, read the blog post linked to in that last bullet point for full details. The important thing for now, though, is that it means there are a total of 16^6 different possible requests that can be made to the API, which is just over 16 million. Further, we can transform the first two use cases above into k-anonymity searches on the server side as it simply involved hashing the email address and taking those first six characters.

In summary, this means we can boil the entire searchable database of email addresses down to the following:

1.  AAAAAA
2.  AAAAAB
3.  AAAAAC
4.  ...about 16 million other values...
5.  FFFFFD
6.  FFFFFE
7.  FFFFFF

That's a large albeit finite list, and that's what we're now caching. So, here's what a search via email address looks like:

1.  Address to search: test@example.com
2.  Full SHA-1 hash: 567159D622FFBB50B11B0EFD307BE358624A26EE
3.  Six char prefix: 567159
4.  API endpoint: https://\[host\]/\[path\]/567159
5.  If hash prefix is cached, retrieve result from there
6.  If hash prefix is _not_ cached, query origin and save to cache
7.  Return result to client

K-anonymity searches obviously go straight to step four, skipping the first few steps as we already know the hash prefix. All of this happens in a Cloudflare worker, so it's "code on the edge" creating hashes, checking cache then retrieving from the origin where necessary. That code also takes care of handling parameters that transform queries, for example, [filtering by domain or truncating the response](https://haveibeenpwned.com/API/v3?ref=troyhunt.com#BreachesForAccount). It's a beautiful, simple model that's all self-contained within a worker and a very simple origin API. But there's a catch - what happens when the data changes?

There are two events that can change cached data, one is simple and one is major:

1.  Someone [opts out of public searchability](https://haveibeenpwned.com/OptOut?ref=troyhunt.com) and their email address needs to be removed. That's easy, we just call an API at Cloudflare and flush a single hash prefix.
2.  A new data breach is loaded and there are changes to a large number of hash prefixes. In this scenario, we flush the entire cache and start populating it again from scratch.

The second point is kind of frustrating as we've built up this beautiful collection of data all sitting close to the consumer where it's super fast to query, and then we nuke it all and go from scratch. The problem is it's either that or we selectively purge what could be many millions of individual hash prefixes, [which you can't do](https://developers.cloudflare.com/api-next/resources/cache/?ref=troyhunt.com):

> For Zones on Enterprise plan, you may purge up to 500 URLs in one API call.

And:

> Cache-Tag, host, and prefix purging each have a rate limit of 30,000 purge API calls in every 24 hour period.

We're giving all this further thought, but it's a non-trivial problem and a full cache flush is both easy and (near) instantaneous.

Enough words, let's get to some pictures! Here's a typical week of queries to the enterprise k-anonymity API:

![](https://www.troyhunt.com/content/images/2024/11/image-9.png)

This is a _very_ predictable pattern, largely due to one particular subscriber regularly querying their entire customer base each day. (Sidenote: most of our enterprise level subscribers use callbacks such that we push updates to them via webhook when a new breach impacts their customers.) That's the total volume of inbound requests, but the really interesting bit is the requests that hit the origin (blue) versus those served directly by Cloudflare (orange):

![](https://www.troyhunt.com/content/images/2024/11/image-10.png)

Let's take the lowest blue data point towards the end of the graph as an example:

![](https://www.troyhunt.com/content/images/2024/11/image-12-1.png)

At that time, 96% of requests were served from Cloudflare's edge. Awesome! But look at it only a little bit later:

![](https://www.troyhunt.com/content/images/2024/11/image-15-1.png)

That's when I flushed cache for [the Finsure breach](https://twitter.com/haveibeenpwned/status/1858730478226100721?ref=troyhunt.com), and 100% of traffic started being directed to the origin. (We're still seeing 14.24k hits via Cloudflare as, inevitably, some requests in that 1-hour block were to the same hash range and were served from cache.) It then took a whole 20 hours for the cache to repopulate to the extent that the hit:miss ratio returned to about 50:50:

![](https://www.troyhunt.com/content/images/2024/11/image-11-1.png)

Look back towards the start of the graph and you can see the same pattern from when I loaded [the DemandScience breach](https://twitter.com/haveibeenpwned/status/1856638427325976584?ref=troyhunt.com). This all does pretty funky things to our origin API:

![](https://www.troyhunt.com/content/images/2024/11/image-13.png)

That last sudden increase is more than a 30x traffic increase in an instant! If we hadn't been careful about how we managed the origin infrastructure, we would have built a literal DDoS machine. Stefán will write later about how we manage the underlying database to ensure this doesn't happen, but even still, whilst we're dealing with the cyclical support patterns seen in that first graph above, I know that the best time to load a breach is later in the Aussie afternoon when the traffic is a third of what it is first thing in the morning. This helps smooth out the rate of requests to the origin such that by the time the traffic is ramping up, more of the content can be returned directly from Cloudflare. You can see that in the graphs above; that big peaky block towards the end of the last graph is pretty steady, even though the inbound traffic the first graph over the same period of time increases quite significantly. It's like we're trying to race the increasing inbound traffic by building ourselves up a bugger in cache.

Here's another angle to this whole thing: now more than ever, loading a data breach costs us money. For example, by the end of the graphs above, we were cruising along at a 50% cache hit ratio, which meant we were only paying for half as many of the Azure Function executions, egress bandwidth, and underlying SQL database as we would have been otherwise. Flushing cache and suddenly sending all the traffic to the origin doubles our cost. Waiting until we're back at 90% cache it ratio literally increases those costs 10x when we flush. If I were to be completely financially ruthless about it, I would need to either load fewer breaches or bulk them together such that a cache flush is only ejecting a small amount of data anyway, [but clearly, that's not what I've been doing](https://twitter.com/haveibeenpwned/?ref=troyhunt.com) 😄

There's just one remaining fly in the ointment...

Of those three methods of querying email addresses, the first is a no-brainer: searches from the front page of the website hit a Cloudflare Worker where it validates the Turnstile token and returns a result. Easy. However, the second two models (the public and enterprise APIs) have the added burden of validating the API key against Azure API Management (APIM), and the only place that exists is in the West US origin service. What this means for those endpoints is that before we can return search results from a location that may be just a short jet ski ride away, we need to go all the way to the other side of the world to validate the key and ensure the request is within the rate limit. We do this in the lightest possible way with barely any data transiting the request to check the key, plus we do it in async with pulling the data back from the origin service if it isn't already in cache. In other words, we're as efficient as humanly possible, but we still cop a massive latency burden.

Doing API management at the origin is super frustrating, but there are really only two alternatives. The first is to distribute our APIM instance to other Azure data centres, and the problem with that is [we need a Premium instance of the product](https://learn.microsoft.com/en-us/azure/api-management/api-management-howto-deploy-multi-region?ref=troyhunt.com). We presently run on a Basic instance, which means [we're talking about a 19x increase in price just to unlock that ability](https://azure.microsoft.com/en-au/pricing/details/api-management/?ref=troyhunt.com). But that's just to go Premium; we then need at least one more instance somewhere else for this to make sense, which means we're talking about a 28x increase. And every region we add amplifies that even further. It's a financial non-starter.

The second option is for Cloudflare to build an API management product. _This_ is the killer piece of this puzzle, as it would put all the checks and balances within the one edge node. It's a suggestion I've put forward on many occasions now, and who knows, maybe it's already in the works, but it's a suggestion I make out of a love of what the company does and a desire to go all-in on having them control the flow of our traffic. [I did get a suggestion this week about rolling what is effectively a "poor man's API management" within workers](https://www.troyhunt.com/weekly-update-422/#comment-6595482405), and it's a really cool suggestion, but it gets hard when people change plans or when we want to apply quotas to APIs rather than rate limits. So c'mon Cloudflare, let's make this happen!

Finally, just one more stat on how powerful serving content directly from the edge is: I shared this stat last month for Pwned Passwords which serves well over 99% of requests from Cloudflare's cache reserve:

> There it is - we’ve now passed 10,000,000,000 requests to Pwned Password in 30 days 😮 This is made possible with [@Cloudflare](https://twitter.com/Cloudflare?ref_src=twsrc%5Etfw&ref=troyhunt.com)’s support, massively edge caching the data to make it super fast and highly available for everyone. [pic.twitter.com/kw3C9gsHmB](https://t.co/kw3C9gsHmB?ref=troyhunt.com)
> 
> — Troy Hunt (@troyhunt) [October 5, 2024](https://twitter.com/troyhunt/status/1842650209475801598?ref_src=twsrc%5Etfw&ref=troyhunt.com)

That's about 3,900 requests _per second_, on average, non-stop for 30 days. It's obviously way more than that at peak; just a quick glance through the last month and it looks like about 17k requests per second in a one-minute period a few weeks ago:

![](https://www.troyhunt.com/content/images/2024/11/image-8.png)

But it doesn't matter how high it is, because I never even think about it. I set up the worker, I turned on cache reserve, and that's it 😎

I hope you've enjoyed this post, [Stefán and I will be doing a live stream on this topic at 06:00 AEST Friday morning](https://youtube.com/live/6CqqgqhopTo?feature=share&ref=troyhunt.com) for this week's regular video update, and it'll be available for replay immediately after. It's also embedded here for convenience:

[Have I Been Pwned](/tag/have-i-been-pwned-3f/) [Cloudflare](/tag/cloudflare/) [Azure](/tag/azure/)

[Tweet](https://twitter.com/share?text=Troy%20Hunt%3A%20Closer%20to%20the%20Edge%3A%20Hyperscaling%20Have%20I%20Been%20Pwned%20with%20Cloudflare%20Workers%20and%20Caching&url=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/) [Post](https://www.facebook.com/sharer/sharer.php?u=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/) [Update](https://www.linkedin.com/shareArticle?mini=true&url=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/) [Email](mailto:?subject=Troy%20Hunt%3A%20Closer%20to%20the%20Edge%3A%20Hyperscaling%20Have%20I%20Been%20Pwned%20with%20Cloudflare%20Workers%20and%20Caching&body=https://www.troyhunt.com/closer-to-the-edge-hyperscaling-have-i-been-pwned-with-cloudflare-workers-and-caching/) [RSS](https://feeds.feedburner.com/TroyHunt)

Troy Hunt's Picture

##### Troy Hunt

Hi, I'm Troy Hunt, I write this blog, create courses for Pluralsight and am a Microsoft Regional Director and MVP who travels the world speaking at events and training technology professionals[](/about)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

#### Troy Hunt

Hi, I'm Troy Hunt, I write this blog, run "Have I Been Pwned" and am a Microsoft Regional Director and MVP who travels the world speaking at events and training technology professionals[](/about)

#### Upcoming Events

I often run [private workshops](/workshops) around these, here's upcoming events I'll be at:

#### Must Read

*   [Data breach disclosure 101: How to succeed after you've failed](/data-breach-disclosure-101-how-to-succeed-after-youve-failed/)
*   [Data from connected CloudPets teddy bears leaked and ransomed, exposing kids' voice messages](/data-from-connected-cloudpets-teddy-bears-leaked-and-ransomed-exposing-kids-voice-messages/)
*   [Here's how I verify data breaches](/heres-how-i-verify-data-breaches/)
*   [When a nation is hacked: Understanding the ginormous Philippines data breach](/when-nation-is-hacked-understanding/)
*   [How I optimised my life to make my job redundant](/how-i-optimised-my-life-to-make-my-job/)

[](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2F)

Don't have Pluralsight already? [How about a 10 day free trial?](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fbilling.pluralsight.com%2Findividual%2Fcheckout) That'll get you access to thousands of courses amongst which are dozens of my own including:

1.  [OWASP Top 10 Web Application Security Risks for ASP.NET](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fowasp-top10-aspdotnet-application-security-risks)
2.  [What Every Developer Must Know About HTTPS](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fhttps-every-developer-must-know)
3.  [Hack Yourself First: How to go on the Cyber-Offense](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fhack-yourself-first)
4.  [The Information Security Big Picture](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Finformation-security-big-picture)
5.  [Ethical Hacking: Social Engineering](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fethical-hacking-social-engineering)
6.  [Modernizing Your Websites with Azure Platform as a Service](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fmodernizing-websites-microsoft-azure)
7.  [Introduction to Browser Security Headers](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fbrowser-security-headers)
8.  [Ethical Hacking: SQL Injection](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fethical-hacking-sql-injection)
9.  [Web Security and the OWASP Top 10: The Big Picture](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fweb-security-owasp-top10-big-picture)
10.  [Ethical Hacking: Hacking Web Applications](https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fethical-hacking-web-applications)

[

#### Weekly Update 427



](/weekly-update-427/)[

#### Weekly Update 426



](/weekly-update-426/)

[Subscribe](#subscribe)

[](#)

#### Subscribe Now!

Send new blog posts:  

 daily

 weekly

 

Hey, just quickly confirm you're not a robot:

Submitting...

Got it! Check your email, click the confirmation link I just sent you and we're done.

###### Copyright 2025, Troy Hunt

This work is licensed under a [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/). In other words, share generously but provide attribution.

###### Disclaimer

Opinions expressed here are my own and may not reflect those of others. Unless I'm quoting someone, they're just my own views.

###### Published with Ghost

This site runs entirely on [Ghost](https://ghost.org/) and is made possible thanks to their kind support. Read more about [why I chose to use Ghost](https://www.troyhunt.com/its-a-new-blog/).

*   [](https://twitter.com/troyhunt)
*   [](https://www.facebook.com/troyahunt)
*   [](https://www.linkedin.com/in/troyhunt)
*   [](https://www.youtube.com/user/troyhuntdotcom)
*   [](https://feeds.feedburner.com/TroyHunt)

!function(s){"use strict";function e(s){return new RegExp("(^|\\\\s+)"+s+"(\\\\s+|$)")}function n(s,e){var n=a(s,e)?c:t;n(s,e)}var a,t,c;"classList"in document.documentElement?(a=function(s,e){return s.classList.contains(e)},t=function(s,e){s.classList.add(e)},c=function(s,e){s.classList.remove(e)}):(a=function(s,n){return e(n).test(s.className)},t=function(s,e){a(s,e)||(s.className=s.className+" "+e)},c=function(s,n){s.className=s.className.replace(e(n)," ")});var i={hasClass:a,addClass:t,removeClass:c,toggleClass:n,has:a,add:t,remove:c,toggle:n};"function"==typeof define&&define.amd?define(i):s.classie=i}(window); !function(){function e(){n()}function n(){i.addEventListener("click",t),d&&d.addEventListener("click",t),c.addEventListener("click",function(e){var n=e.target;a&&n!==i&&t()})}function t(){a?classie.remove(o,"show-menu"):classie.add(o,"show-menu"),a=!a}var o=document.body,c=document.querySelector("#container"),i=document.getElementById("open-button"),d=document.getElementById("close-button"),a=!1;e();for(var r=function(e){e.preventDefault(),window.open(this.href,"social-share","width=580,height=296")},s=document.getElementsByClassName("article-open\_window"),u=0;u<s.length;u++)s\[u\].addEventListener("click",r,!1)}(); function showUnsponsored(){document.getElementById("sponsor\_message").innerHTML='<a href="/sponsorship"><strong>Sponsored by:</strong> I\\'m unsponsored today, click to learn more</a>'}function showNoEvents(){document.getElementById("events\_list").innerHTML="<p>No upcoming events were found</p>"}function showSponsor(e){null===e?showUnsponsored():document.getElementById("sponsor\_message").innerHTML='<a href="'+e.campaignUrl+'" target="\_blank" rel="noopener"><strong>Sponsored by:</strong> '+e.message+' <i class="fa fa-external-link" aria-hidden="true"></i></a>'}function showEvents(e){if(0===e.length)showNoEvents();else{var n="<ol>";e.forEach(function(e){n+=null!==e.url?'<li><a href="'+e.url+'">'+e.name+": "+e.date+", "+e.location+"</a></li>":"<li>"+e.name+": "+e.date+", "+e.location+"</li>"}),n+="</ol>",document.getElementById("events\_list").innerHTML=n}}var xmlhttp=new XMLHttpRequest,url="https://bloghelpers.troyhunt.com/api/BlogData";xmlhttp.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText);null===e||void 0===e?(showUnsponsored(),showNoEvents()):(showSponsor(e.currentSponsor),showEvents(e.events))}else 4===this.readyState&&200!==this.status&&(showUnsponsored(),showNoEvents())},xmlhttp.open("GET",url,!0),xmlhttp.send(); var disqus\_config=function(){this.page.url=document.getElementById("disqus\_post\_url").getAttribute("data"),this.page.identifier=document.getElementById("disqus\_post\_identifier").getAttribute("data")};!function(){if(null!=document.getElementById("disqus\_post\_identifier")&&null!=document.getElementById("disqus\_post\_url")){var t=document,e=t.createElement("script");e.src="//troyhunt.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}}(); function reCaptchaSolved(){document.getElementById("subscribe\_loading").style.display="block",document.getElementById("confirm\_captcha").style.display="none";for(var e,t=encodeURIComponent(document.getElementById("email\_to\_subscribe").value),n=encodeURIComponent(window.location),c=document.getElementsByName("email\_cadence"),s=0,l=c.length;s<l;s++)if(c\[s\].checked){e=c\[s\].value;break}var a=document.getElementById("g-recaptcha-response").value,i="Email="+t+"&EmailCadence="+e+"&SourceUrl="+n+"&g-recaptcha-response="+a,o=new XMLHttpRequest;o.open("POST","https://bloghelpers.troyhunt.com/api/subscribe",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onload=function(){if(document.getElementById("subscribe\_loading").style.display="none",200===this.status)document.getElementById("subscribe\_successful").style.display="block";else{var e=JSON.parse(this.responseText),t="FakeOrInvalid"===e?"Uh oh, apparently that's a fake or invalid email, sorry!":"Uh oh, that didn't work.Try submitting it again.";document.getElementById("subscribe\_unsuccessful").innerHTML="<p>"+t+"</p >",document.getElementById("subscribe\_unsuccessful").style.display="block",document.getElementById("new\_subscription").style.display="block"}},o.send(i)}function closeFloatingSubscribe(){floating\_subscribe.style.display="none",document.cookie="closeFloatingSubscribe=true; expires=1 Jan 2030 00:00:00 UTC; path=/"}document.getElementById("subscribe\_form").addEventListener("submit",function(e){if(e.preventDefault(),document.getElementById("new\_subscription").style.display="none",window.\_\_\_grecaptcha\_cfg)grecaptcha.reset();else{var t=document.createElement("script");t.setAttribute("src","https://www.google.com/recaptcha/api.js"),document.head.appendChild(t);var n=document.createElement("div");n.setAttribute("class","g-recaptcha"),n.setAttribute("data-sitekey","6LdqYhoUAAAAADieTdwsCSDl0-zIpp6Ga-JzatIZ"),n.setAttribute("data-callback","reCaptchaSolved"),document.getElementById("confirm\_captcha").appendChild(n)}document.getElementById("confirm\_captcha").style.display="inline-block"});var floating\_subscribe=document.getElementById("floating\_subscribe");document.cookie.indexOf("closeFloatingSubscribe")===-1&&(floating\_subscribe.style.display="block");var closeElement=document.getElementById("close\_floating\_subscribe");closeElement.addEventListener("click",function(e){closeFloatingSubscribe(),e.preventDefault()},!1);var subscribeElement=document.getElementById("subscribe\_link");subscribeElement.addEventListener("click",function(){closeFloatingSubscribe()},!1);

---

# Commodore 64 Assembly, part 4: how does the machine execute machine code?

*Source: <https://michal.sapka.pl/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/>*
*Published: 2025-04-23T08:50:09.000Z*

Michał Sapka

[Blog](/) [](/rss.xml)[About](/about/) [Archive](/archive/) [Projects](/projects/) [Uses](/uses/)

# [Commodore 64 Assembly, part 4: how does the machine execute machine code?](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/)

Published on Wednesday, 2025-04-23 as part of [Commodore 64 Assembly](/tags/c64-asm) series under [hardware](/hardware) and tagged with: [assembler](/tags/assembler), [retro-computing](/tags/retro-computing), [commodore](/tags/commodore), [programming](/tags/programming), and [c64-asm](/tags/c64-asm)

Last time I stated that I will not dive any deeper than mnemonics. I truly, really wanted to. But when I started learning about how to do math and branching I got confused. The CPU reacts to some magical data stored in the ether. This could not stand, time to go deeper.

The first thing I've learned is that I was lied to. There are many more registers! And, basically, this is where the missing bits of my understand were hidden. The `X`, `Y`, and `a` registers are the ones we use in our logic, but the CPU hides a few more for internal use. Those three are the ones we can directly load/read from, as they have their addresses.

[![](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/CPU_6510@1.png)](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/CPU_6510.png)

The MOS 6510 CPU (via [C64 Wiki](https://www.c64-wiki.com/wiki/File:CPU_6510.jpg))

Let's go though a sample execution of `jmp loop` which I've did time after time. We've got the mnemonic `jmp` and the label `loop`. The mnemonic is stored in RAM under given address, and label refers to another address.

The first thing that happens is called _fetch_ phase. Let's meet the first forbidden register called _Program Counter (PC)_. It stores the memory address of where the op next code is stored. So, if our `jmp` is store under _$1000_, the _PC_ has a value of _$1000_ before we execute the jump. Basically: the _PC_ tells the CPU where to go next.

So, the CPU reads the _PC_ register puts it's value into _Address Bus_, another register. The _Address Bus_ defines the currently executes op code. So: The _PC_ defines what is next, and the CPU reads it and stores it under _Address Bus_. Nothing has used the RAM yet - it's all within the CPU.

The CPU gets data from RAM, a _data bus_ (I already know a lot more about how computes work that a week ago). It consists of a few things, because even our humble 6510 is a complex best. The CPU is connected to RAM via physical line on the to the memory. The line is bidirectional, so the same path will be used to read and write operations. The 65010 has one such line, but there are multiple data busses between different parts of CPU (and this is where I draw the line: I won't be able to comprehend it all).

We're still at the _fetch_ phase, the CPU doesn't know what we want to do. All it knows is that we want to do whatever is under memory location _$1000_, therefore it's a read operation. The _line_ is set to R mode (read). The mode is set inside CPU's internal circuitry. We are again near where I draw the line here, so: the computer is ready to put into CPU whatever is stored in memory under our address _$1000_. Our jmp's opcode is `4C` and this is what is returned via the bus. The CPU then stores it inside _Instruction register (IR)_.

We are now in the _decode_ phase: the CPU has hex value of opcode, now it need to understand what it is. The value `4c` is passed to hardwired internal circuitry of the CPU. I have negative knowledge about electronics, so: via magical incantation of silicon, the opcode is decoded as jmp. It also knows: what addressing w want, and how much more data we need to fetch from the memory. In our `jmp` we need an address. Since our opcode was stored under _$1000_, the operand will start at _$1001_, so the next memory address. Fetching this is called the _Fetch low byte_ and _fetch high bite_. We've got two, as we are able to address 16bit memory address space, but out CPU has store only 8bits. So, we either fetch low-address (which is addressable as 8 bit number), and execute it as jmp, or we will need two fetches. The first first is fetching the low bit. It will be stored in a _latch_ - a temporary memory addition to the register. Currently: the IR register stores the _4C_ opcode, and the IR's latch stores the low bit. Next we fetch the high bit (_$1002_) and execute the jump.

[![](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/C64_RAM@1.png)](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/C64_RAM.png)

The RAM chips on Commodore 64 (via [C64 Wiki](https://www.c64-wiki.com/wiki/File:CPU_6510.jpg))

What the jump does is store the new address (which is our operand) as the next value of the _PC_. Note, that the _PC_ is 16 bit and is fully capable of storing the full address.

Then the dance starts once again. What is sad here is that each operation takes different number of CPU cycles, as different number of actual operations need to take place.

But what about other mnemonics, like `lDX`? Well, then the _IR_ will be automatically incremented. In case of 6510 we've got three possible deltas: 1 byte (no operand), 2 or 3 byte (8 and 15 bit operands). B The _PC_ knows the last address - it has read from it. So it's just add one, store it to _IC_ and voila. The lengths are built into the decoder's hardwired circuits, so the CPU has all the data it needs to continue execution.

We've got two more registers that are I'll need to explore in the future, as they are used in more advanced programs than my useless-border-thingy:

*   _Stack Pointer (SP)_ - where the _stack overflow_ is generated. It points to where the subroutine was called, so the CPU can return out of.
*   _Processor Status Register (P)_ (also known as _flags register_) - which stores flag of recent operation. This is what I'll be using when learning to do math. We can control it!

[![](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/CPU_6502_Detailed_Block_Diagram@1.png)](/2025/commodore-64-assembly-part-4-how-does-the-machine-execute-machine-code/CPU_6502_Detailed_Block_Diagram.png)

6502 Detailed Block Diagram (via [CPM Wiki](https://www.cpcwiki.eu/index.php/File:CPU_6502_Detailed_Block_Diagram.jpg)). I now understand _some_ parts of it.

My brain is melting, my hands are tired, and I never knew that it makes so much sense. I'm a high-level programmer by trade (_Ruby_), and I was afraid of C. But choosing this simple CPU as a learning material was great, as ASM here explains a lot (**a lot**) of things. I am surprised by how much machine code abstracts. `LDX $1000`, puff, magic smoke pushes electrons, and boom: we've got number in the X registry. A lot of things needed to happen for it to happen, and I only explored the logic that happens there. There are layers and layers still to uncover, but nope. I'm done here, I already feel too smart.

Next up: adding numbers and branching.

Time to update my resume.

**Errata**

*   Removed incorrect information about cycle count on different CPU architectures ([thx!](https://lobste.rs/s/jqkwak/commodore_64_assembly_part_4_how_does#c_vdnd5v))

table { border-collapse: collapse; margin-left: auto; margin-right: auto; } table td, table th { padding: 5px; border: 1px solid; } table th { font-weight: bold; text-align: center; }

---

# Start with a clean slate: Integration testing with PostgreSQL

*Source: <https://blog.dogac.dev/pg-test-table-track/>*
*Published: 2025-04-22T15:11:15.000Z*

[Dogac.dev](https://blog.dogac.dev)

*   [Dogac.dev](https://blog.dogac.dev)
*   [Home](https://blog.dogac.dev/)
*   [CV](https://drive.google.com/file/d/1VvvlBschNFRrQpFCHnUOm-fgcHhRyrCP/view?usp=sharing)
*   ### Recent articles
    
    [
    
    ![](/content/images/size/w300/2025/04/New-Project.png)
    
    ### Start with a clean slate: Integration testing with PostgreSQL
    
    2 days ago](/pg-test-table-track/)
    
    [
    
    ![](/content/images/size/w300/2025/04/Screenshot-2025-04-10-at-21.29.19.png)
    
    ### Behind the 6-digit code: Building HOTP and TOTP from scratch
    
    13 days ago](/how-do-one-time-passwords-work/)
    
    [
    
    ![](/assets/images/no-image.png?v=2b1c0f49bd)
    
    ### On Decidability of Our Jobs and AI Replacing Software Engineers
    
    21 days ago](/view-on-ai-in-2025/)
    
    [
    
    ![](/content/images/size/w300/2025/03/ChatGPT-Image-Mar-28--2025--10_06_19-PM.png)
    
    ### Supercharge Your Home Cluster Using Cloudflare Tunnel
    
    a month ago](/scale/)
    
    ### Tags
    
    *   [ai](/tag/ai/)
    *   [Armeria](/tag/armeria/)
    *   [databases](/tag/databases/)
    *   [ideas](/tag/ideas/)
    *   [Java](/tag/java/)
    *   [Lifestyle](/tag/lifestyle/)
    *   [open-source](/tag/open-source/)
    *   [Programming](/tag/programming/)
    *   [self-hosting](/tag/self-hosting/)
    

Toggle light/dark mode 

![](/content/images/size/w1000/2025/04/New-Project.png)

# Start with a clean slate: Integration testing with PostgreSQL

[Programming](https://blog.dogac.dev/tag/programming/) • Apr 21, 2025

[](https://www.facebook.com/sharer/sharer.php?u=https://blog.dogac.dev/pg-test-table-track/)[](https://twitter.com/intent/tweet?text=Start%20with%20a%20clean%20slate%3A%20Integration%20testing%20with%20PostgreSQL&url=https://blog.dogac.dev/pg-test-table-track/)

We have been using PostgreSQL as our primary database in production for 4 over years, however over time, as our database grew bigger and reached over 500 tables in a single monolithic application, we had to come up with smart ways to manage it. PostgreSQL is a database that is capable of handling hundreds of tables and billions of rows, however it doesn't necessarily mean it will be easy to develop applications in a such setting. In this post, I am going to write down how I have tackled some bottlenecks in the integration testing pipeline at Carbon Health by speeding up and increasing isolation of our integration test pipelines. The solution powers our CI/CD pipelines for the last 2 years.

* * *

_This blog post's topic is my upcoming presentation at_ [_PGDay Chicago 2025_](https://postgresql.us/events/pgdaychicago2025/schedule/session/1891-start-with-a-clean-slate-setting-up-integration-tests-with-postgresql/?ref=blog.dogac.dev)_. Conference slides accessible at_ [_https://pgday.dogac.dev/_](https://pgday.dogac.dev/?ref=blog.dogac.dev)_._

**_Link to the tool:_** [**_github.com/Dogacel/pg\_test\_table\_track_**](https://github.com/Dogacel/pg_test_table_track?ref=blog.dogac.dev)

# Problem

**A short anectode on monoliths:** Microservices is something we often hear about but usually a far reality for many of us. Monoliths (_monos: single/one, lithos: stone_) still work pretty great in many real-world settings and they only bear a subset of management problems microservices have. One of the core problems in Monoliths is its huge codebase and slow build times. You don't need to open 3 pull requests just to do some CRUD operations on a basic database table, and jump back a couple PRs later, because you forgot to add a field to your proto definitions and you gotta open 3 more PRs to add that. That sounds neat, however most likely, the total CI/CD runtimes of your 6 PRs will be still less than a single PR check in the monolith's PR, just to see your linter failed after 45 minutes, because you failed to define a constant for a magic number, yikes. If you want to have a productive and effective development environment with your Monolith, you have to do some optimizations in your CI/CD and testing environment.

**Background:** So a little background about our company before we start,

*   Our tech-stack consists of a monolithic server supported by 30+ micro-services.
*   We host our services on cloud, our primary choice of database is PostgreSQL.
*   We have over 500 tables serving more than 10TBs of data.
*   We have about 6 distinct development teams.

As you might have guessed, those 500 tables are causing a big trouble in our CI/CD pipelines. Almost more than half of our 9000+ tests in our monolith are also integration tests, meaning they use a PostgreSQL instance to run queries. And over time, our pipeline has became painfully slow and annoying to work with, which lead me to come up with a solution.

## Integration tests

Integration testing checks whether different parts of a system work together correctly as a whole. Unit testing focuses on testing individual components.

![](https://blog.dogac.dev/content/images/2025/04/image-5.png)

Even though unit tests are much superior in terms of isolation and speed, they are not as good for covering the end to end flows and detect real-life failures. That's why we have extensively written integration tests to ensure our Monolith is tested well before release. Based on our experience, setting up scenarios and running the actual DB queries in tests really help catching bugs early on.

So, what's the catch? Writing integration tests are painfully hard, as your data dependencies, such as foreign key constraints, make initializations a hassle for developers. Moreover, your database keeps a state, therefore you need to ensure it doesn't leak in-between tests. So let's explore our options in order to achieve a fast and isolated environment.

### Wrapping every test with transactions

At first, it sounds like a good idea. In reality, it is a terrible idea. PostgreSQL supports some sort of nested transactions, also called `SAVEPOINTS`. However a failure inside a transaction aborts the rest. Therefore, it is not possible to truly wrap every test inside a transaction and run, as some errors might result parent transaction to abort. Moreover, wrapping with additional transactions would result in altering the runtime behavior of tests. This is not something we want, as it might result in hard to debug errors that are only faced during tests, as well as behavioral differences from the actual production environment, which might cause some bugs to be not caught early on.

### Fresh DB for each start

If you want to maximize isolation, go ahead and create a fresh DB instance for each of your tests. This worked fine in our microservices where the number of tables and tests were lower. However in monoliths, you will quickly realize this is a slow process. We have thousands of migration files, but we can always use a schema dump. In our case, we used `rake:schema:dump`. I highly encourage readers to experiment with `TEMPLATE` databases as well. However, initialization takes around 400 milliseconds, this results in a little over 1 hours of just DB initialization time for our 9000+ integration tests.

![](https://blog.dogac.dev/content/images/2025/04/image-6.png)

A very simple implementation of a DB provider for running isolated tests.

### Cleaning all tables

This was the initial approach in our codebase, maintaining a hand-curated list of `DELETE TABLE` queries. However it has some drawbacks,

1.  Order of deletions matter as there are foreign keys.
2.  Sometimes tables were missed from the, resulting in flakiness.
3.  Sequences and Materialized Views require special attention.

For number 3, our codebase doesn't truly benefit from both, so we didn't care. However, this approach was still too slow and maintaining the list was super annoying. Adding a new table into this list was very hard, you would see weird foreign key errors, random test failures and so. Also, there is no guarantee that your hand-crafted list contains all the necessary tables in the right order. Therefore, a developer might randomly encounter a flakiness while writing a test without knowing it is related to some artifacts leftover from the recent tests.

Actually I have had this issue once, and it was super annoying to fix. Updating our build tools resulted in changing the execution order of tests, which ultimately lead to flakiness. It took me an enourmous amount of time to figure out that test order was changed and the bug was caused by a state leak between tests.

> We also experimented with `TRUNCATE` over `DELETE`. However it slowed down our pipelines even more. I think it is because our test tables had a small amounts of data, which made truncate less effective and caused overhead.

### Final Solution

So I have decided, our final goal should be

1.  Make each table fresh before each test
2.  Clean the state as fast as possible
3.  Get rid of hand-crafted lists as entropy always wins

So I built a solution that uses **PL/pgSQL** to automatically clean all tables that are used in-between tests.

#### Storing Access

If there are bunch of tables, trying to clean up all of them would generate a big overhead. So instead of that, what about only cleaning the ones that contains data? To do that, we need to store the tables that are used during testing somewhere.

    CREATE TABLE IF NOT EXISTS test_access(table_name varchar(256) not null primary key);

Later, create a function / trigger that adds a given table name to the list.

    CREATE OR REPLACE FUNCTION add_table_to_accessed_list() RETURNS TRIGGER AS $$
    BEGIN
     --- Assuming that the table name is passed as the first argument to the function.
     INSERT INTO test_access VALUES (TG_ARGV[0]) ON CONFLICT DO NOTHING;
     RETURN NEW;
    END $$ LANGUAGE PLPGSQL;
    

#### Spying on tables

In order to spy on tables that are modified, we can use triggers. This trigger will be executed before every insert, which ensures we capture all tables that are altered during the test run.

    CREATE OR REPLACE FUNCTION setup_access_triggers(schemas text[]) RETURNS int AS $$
    DECLARE tables CURSOR FOR
     SELECT table_name, table_schema FROM information_schema.tables
       WHERE table_schema = ANY(schemas)
         AND table_type = 'BASE TABLE' --- Exclude views.
         AND table_name NOT IN ('test_access', 'schema_migrations'); 
         --- Prevent recursion when an insertion happens to 'test_access' table.
    BEGIN
     --- Create a table to store the list of tables that have been accessed.
     EXECUTE 'CREATE TABLE IF NOT EXISTS test_access(table_name varchar(256) not null primary key);';
     FOR stmt IN tables LOOP
       --- If the trigger exists, first drop it so we can re-create.
       EXECUTE 'DROP TRIGGER IF EXISTS "' || stmt.table_name || '_access_trigger" ON "' ||
              stmt.table_schema || '"."'|| stmt.table_name || '"';  
       --- Create the on insert trigger.
       --- This calls `add_table_to_accessed_list` everytime a row is inserted into the table with table name.
       --- The table name also includes the table schema.
       EXECUTE 'CREATE TRIGGER "' || stmt.table_name || '_access_trigger"' ||
               ' BEFORE INSERT ON "' || stmt.table_schema ||'"."'|| stmt.table_name || '"' ||
               ' FOR EACH STATEMENT ' ||
               ' EXECUTE PROCEDURE public.add_table_to_accessed_list (''"'||
               stmt.table_schema ||'"."'|| stmt.table_name ||'"'')';
     END LOOP;
    RETURN 0;
    END $$ LANGUAGE plpgsql;

#### Cleaning the tables

As a last step, we need to create a function that allows us to clean all tables that are accessed during the last test execution cycle. We disable foreign keys before deleting to ensure deletion order doesn't matter as our final goal is to clean all tables.

    CREATE OR REPLACE FUNCTION delete_from_accessed_tables() RETURNS int AS $$
    DECLARE tables CURSOR FOR
     SELECT table_name FROM test_access;
    BEGIN
    --- Disable foreign key constraints temporarily. Without this, we need to clear tables in a specific order.
    --- But it is very hard to find this order and this trick makes the process even faster.
    --- Because we clear every table, we don't care about any foreign key constraints.
    EXECUTE 'SET session_replication_role = ''replica'';';
    --- Clear all tables that have been accessed.
    FOR stmt IN tables LOOP
     BEGIN
       EXECUTE 'DELETE FROM '|| stmt.table_name;
       --- If we accessed a table that is dropped, an exception will occur. This ignored the exception.
       EXCEPTION WHEN OTHERS THEN
     END;
    END LOOP;
    --- Clear the list o accessed tables because those tables are now empty.
    EXECUTE 'DELETE FROM test_access';
    --- Turn foreign key constraints back on.
    EXECUTE 'SET session_replication_role = ''origin'';';
    RETURN 0;
    END $$ LANGUAGE plpgsql;

#### Embedding into Tests

We have developed an interface / trait called `CleanDBBetweenTests` and every integration test in our system extends this trait. Inside this trait, we have setup some before and after test triggers to ensure our tables are cleaned.

    def clearAccessedTables(): Unit = {
     finishOperation(sql"""SELECT public.delete_from_accessed_tables()""".as[Int])
    }
    
    def setupTestTriggers(): Unit = {
      finishOperation(sql"""SELECT public.setup_access_triggers(array['test_schema'])""".as[Int])
    }
    
    trait CleanDBBetweenTests extends BeforeAndAfterEach with BeforeAndAfterAll { this: Suite =>
     override def beforeAll(): Unit = {
       setupTestTriggers()
       clearAccessedTables()
     }
     override def beforeEach(): Unit = {
       clearAccessedTables()
     }
     override def afterAll(): Unit = {
       clearAccessedTables()
     }
    }

## Results

Using this approach, we were able to cut our CI/CD times by 30%. The speed increase and better isoaltion greately improved our developer experience. We have never had issues with our table cleaning approach since we first rolled out this tool. As our codebase keeps growing, without this change, our current CI runtime would be more than 1.5 hours by now. Speeding up our CI times didn’t only decrease our bills but it also motivated people towards writing more code and tests as the PR feedback cycle was much quicker

![](https://cdn.prod.website-files.com/601bf9a26667cdf3f285c136/65c68ab7a17bb07d390a8e41_R-nIzg-XOCnxSLfBNv7FZFLMEnDLLnc3l5GY-swOC-rqcsuhALG4L0XC2AeqBXTXWjCcg_ghYrqUbvGtX5c4O9miVmGnk2drEvzHX-nr8n0cwq4aJaom6vcMZZiDKnB0wSktzjpiBXA4D2QO65E1L6E.png)

**Future Work:** Exploring strategies to support constant rows that would stay during all execution cycles, as well as setting up scenarios. Moreover, `UNLOGGED TABLE`s can potentially speed up the execution further more.

**Last words...** I have decided that I should open-source this tool so everyone can benefit from it. Your feedback is very valuable, please let me know what you think.

### Tags

*   [Programming](/tag/programming/ "Programming")
*   [databases](/tag/databases/ "databases")
*   [open-source](/tag/open-source/ "open-source")

#### Subscribe to our newsletter

Get the latest posts delivered right to your inbox.

Your email address 

Subscribe

![Success!](/assets/images/success.png?v=2b1c0f49bd)

Now check your inbox and click the link to confirm your subscription.

Please enter a valid email address

Oops! There was an error sending the email, please try later.

[

](https://blog.dogac.dev/author/dogacel/)

#### [Doğaç Eldenk](https://blog.dogac.dev/author/dogacel/)

### Recommended for you

[](/how-do-one-time-passwords-work/)![](/content/images/size/w600/2025/04/Screenshot-2025-04-10-at-21.29.19.png)[

](https://blog.dogac.dev/author/dogacel/)[](/how-do-one-time-passwords-work/)

[Programming](https://blog.dogac.dev/tag/programming/)[

## Behind the 6-digit code: Building HOTP and TOTP from scratch

13 days ago • 6 min read

](/how-do-one-time-passwords-work/)

[](/scale/)![](/content/images/size/w600/2025/03/ChatGPT-Image-Mar-28--2025--10_06_19-PM.png)[

](https://blog.dogac.dev/author/dogacel/)[](/scale/)

[open-source](https://blog.dogac.dev/tag/open-source/)[

## Supercharge Your Home Cluster Using Cloudflare Tunnel

a month ago • 7 min read

](/scale/)

[](/about-self-hosting/)![](/content/images/size/w600/2024/06/WhatsApp-Image--2-.jpeg)[

](https://blog.dogac.dev/author/dogacel/)[](/about-self-hosting/)

[Programming](https://blog.dogac.dev/tag/programming/)[

## I Like Self-Hosting

10 months ago • 8 min read

](/about-self-hosting/)

Type to search 

No results for your search, please try with something else.

[](https://www.facebook.com/ghost)[](https://twitter.com/atasoytar1)[](https://blog.dogac.dev/rss)

Dogac.dev © 2025   •   Published with [Ghost](https://ghost.org)

[JavaScript license information](/assets/html/javascript.html?v=2b1c0f49bd)

---

# Exploiting Undefined Behavior in C/C++ Programs for Optimization: A Study on the Performance Impact

*Source: <https://web.ist.utl.pt/nuno.lopes/pubs/ub-pldi25.pdf>*
*Published: 2025-04-23T02:47:58.000Z*

[Comments](https://lobste.rs/s/fywpfw/exploiting_undefined_behavior_c_c)

---

# Graphics Livecoding in Common Lisp

*Source: <https://kevingal.com/blog/cl-livecoding.html>*
*Published: 2025-04-23T23:37:17.000Z*

[about](/index.html) • [blog](/blog.html) • [projects](/projects.html) • [rss](/feed.xml)

## Graphics livecoding in Common Lisp

### 2025-04-23

### Developing a Boids program from scratch without restarting it.

Tags: [lisp](/blog/tag/lisp.html) [programming](/blog/tag/programming.html) [artsy](/blog/tag/artsy.html)

[<< previous](/blog/chess-detective.html)

* * *

Some Lisps, like Common Lisp, have a powerful feature that tends to go underappreciated amidst all the talk about macros: the ability to recompile your program while it's running, without restarting it. For the purposes of this post, and because it sounds cool, let's call this ability _livecoding_[1](#fn:livecod).

Entering this strange land where the programs never stop, we'll first take a brief tour of Common Lisp and one of its graphics frameworks, Sketch, before walking through a livecoded implementation of the [Boids algorithm](https://en.wikipedia.org/wiki/Boids).

Boids!

### "Wait, what exactly is this livecoding thing?"

Consider the typical workflow needed to modify a running application, like a videogame.

1.  Stop the application.
2.  Change the code.
3.  (If a compiled language) Wait N time units for a full recompilation.
4.  Start the application again.
5.  Fiddle with the application to get it back to its previous state.
6.  Carry on.

In a livecoding environment, the application is never stopped, which eliminates steps 1, 4 and 5. Instead, small code changes (which can be as granular as recompiling a single function) are immediately reflected in the running program. Step 3 is often instantaneous because only the changed parts of the program must be recompiled. In theory, then, you can develop an entire application while it continuously runs in the background, without ever waiting for code to recompile. This makes the development process more fluid and interactive, with minimal downtime.

In Common Lisp, the workflow might look something like this:

1.  Make a small change to a single function.
2.  Recompile the function (instantaneous).
3.  Carry on.

For an example of this workflow in action, check out Common Lisp and Emacs being used as an environment for [live musical performance](https://www.youtube.com/watch?v=EkYUU0UoB_0). You can hear about a Lisp program being debugged remotely while running in [deep space](https://corecursive.com/lisp-in-space-with-ron-garret/). Livecoding (or hot reloading, or whatever you like to call it) is also available in other languages, like Smalltalk and Erlang.

### A rough sketch of Sketch

Before jumping into Boids, let's take a brief look at [Sketch](https://github.com/vydd/sketch), our Common Lisp graphics framework of choice. We'll be more concerned with big ideas than with code minutiae, but if you're unfamiliar with Common Lisp and want to understand the code samples, then please take a detour through [Learn Common Lisp in Y Minutes](https://learnxinyminutes.com/common-lisp/).

So, Sketch. The Sketch API is heavily based on that of [Processing](https://processing.org/). Its primary entry point is the `defsketch` macro. The code below defines a "sketch" called `my-sketch`.

`(defsketch my-sketch     ((width 200)      (height 200)      (n 5))   ;; ...drawing code here...   )`

After the name of the sketch comes a list of bindings that define its state and configuration. Here, the window properties `width` and `height` are set to `200`, while `n` is an attribute we've added for our own use.

Then comes the drawing code. This gets run in a loop while the sketch is running, once per frame. The following snippet draws 5 red circles on a black background, each of radius 10 and in random positions.

`(background +black+) (loop repeat n       do (with-pen (make-pen :fill +red+)            (circle (random width) (random height) 10)))`

After painting the background black, the all-powerful `loop` macro is used to draw `n` circles. The `with-pen` macro (defined by Sketch) configures drawing properties like fill colour, stroke width and stroke colour. It takes a "pen" object as an argument.

Here's all the code together:

`(defsketch my-sketch     ((width 200)      (height 200)      (n 5))   (background +black+)   (loop repeat n         do (with-pen (make-pen :fill +red+)              (circle (random width) (random height) 10))))`

Finally, to run the sketch, we compile our code and execute `(run-sketch 'my-sketch)` from the REPL, resulting in...

![The result: red circles flashing on a black background.](/static/img/cl-livecoding/sketch-sample.gif)

...art.

That's all we need to know about Sketch for now!

### Livecoding Boids

[Boids](https://en.wikipedia.org/wiki/Boids) is an algorithm from 1986 for simulating flocks of birds. In its essence, it consists of applying 3 forces to the simulated birds. Quoting Wikipedia[2](#fn:boidsref), these forces are:

> *   separation: steer to avoid crowding local flockmates
> *   cohesion: steer to move towards the average position (center of mass) of local flockmates
> *   alignment: steer towards the average heading of local flockmates

How can we implement this ourselves? First, we need a canvas to draw on!

`(defsketch boids     ((width 400)      (height 400)      (restart-on-change nil))   (background (gray-255 230))`

The only mysterious thing in this code is the `restart-on-change` parameter, which is available in my [fork](https://github.com/Kevinpgalligan/sketch) of Sketch. When its value is `nil` (false), the sketch's state - like the boid positions - won't be reset when we recompile our code.

Compiling the defsketch form in Emacs (with the Ctrl-C Ctrl-C shortcut) and executing `(run-sketch 'boids)` at the REPL gives us... 🥁... a gray background. Wonderful.

![A light-gray background.](/static/img/cl-livecoding/boids-1-canvas.png)

(Note: all going well, this modest window will run continuously throughout the entire development lifecycle).

Now let's create some boids to populate our world. We add a `boid` class to store their position and velocity, as well as a convenience function `make-boid` to create a boid from x & y co-ordinates. These rely on a hopefully self-explanatory implementation of 2d vectors, which are created using the `vec2` function.

`(defclass boid ()   ((pos :initarg :pos :accessor pos)    (velocity :initarg :velocity              :initform (vec2 0 0)              :accessor velocity)))  (defun make-boid (x y)   (make-instance 'boid :pos (vec2 x y)))`

To the sketch itself, we add 20 boids in random positions, and pass them to the `draw-boids` function in the drawing loop.

`(defsketch boids     ((width 400)      (height 400)      (restart-on-change nil)      (boids (loop repeat 20                  collect (make-boid (random width) (random height)))))  (background (gray-255 230))   (draw-boids boids))`

If we then recompile defsketch (with Ctrl-C Ctrl-C)...

...we get an error! Woops.

Before: gray canvas. After: red error screen.

But of course! We forgot to define `draw-boids`. The program doesn't crash, however, and we'll soon be able to recover from this setback.

Here's an implementation of `draw-boids`. We don't need to get into the weeds of how it works. For each boid, it does some unwieldy vector math to figure out which direction the boid is facing and draws a triangle pointing in that direction.

`(defun draw-boids (boids)   (let ((boid-width 10)         (boid-length 20))     (loop for boid in boids           do (with-slots (pos velocity) boid                (with-pen (:fill +black+)                  (let* ((dir (if (zerop (v-length velocity))                                  (vec2 0 -1)                                  (v-normalise velocity)))                         (p1 (v+ pos (v-rescale (/ boid-length 2) dir)))                         (p2 (v+ pos                                 (v-rescale (- (/ boid-length 2)) dir)                                 (v-rescale (/ boid-width 2)                                            (perpendicular-anticlockwise dir))))                         (p3 (v+ pos                                 (v-rescale (- (/ boid-length 2)) dir)                                 (v-rescale (/ boid-width 2)                                            (perpendicular-clockwise dir)))))                    (polygon (vx p1) (vy p1)                             (vx p2) (vy p2)                             (vx p3) (vy p3))))))))`

As soon as we compile `draw-boids`, the error screen disappears and our lovely boids are drawn into place. And we didn't have to restart the program to fix it!

Before: red error screen. After: boids are drawn.

There are two Common Lisp features that enable us to fix errors on-the-fly like we've done here:

1.  Newly compiled code, and recompiled code, is immediately loaded (sometimes called "hot reloading") into the running program. This opens up possibilities such as optimising a program as it runs, tweaking parameters like gravitational force and background colour, and iteratively developing a GUI.
2.  The condition system! This is somewhat like exception handling in other languages, but more powerful. Not only can we signal exceptional situations ("conditions"), but we can also define "restarts" for recovering from those situations. When a running Common Lisp program encounters an unhandled condition, control passes to the debugger, and the user is presented with a selection of restarts. Perhaps they want to recompile the offending function and continue execution from the previous stack frame. Or perhaps the error was a division by zero, and the offending function provides a restart that swaps in a value of 1 for the divisor. Suddenly, there are a lot more possibilities than just crashing the program.

Anyway, a worthy discussion of the condition system would take up a full blog post of its own. Back to Boids!

Now that our boids are drawn correctly, we want them to move around and do boid things. First, we implement an `update-positions` function, which basically adds the velocity of each boid to its position (so that the boid moves), and applies the 3 Boidian forces to update the boid's velocity. For now, the functions implementing these forces are stubbed out.

`(defun update-positions (boids)   (let ((max-velocity 10))     ;; Update boid positions.     (map nil          (lambda (boid)            (setf (pos boid) (v+ (pos boid) (velocity boid))))          boids)      ;; Update boid velocities.     (loop for boid in boids           do (setf (velocity boid)                    (v-clamp max-velocity                             (v+ (velocity boid)                                 (rule1 boid boids)                                 (rule2 boid boids)                                 (rule3 boid boids)))))))  ;; Stubs! (For now). (defun rule1 (boid boids)   (vec2 0 0))  (defun rule2 (boid boids)   (vec2 0 0))  (defun rule3 (boid boids)   (vec2 0 0))`

We then have to modify the drawing loop to call `update-positions`.

`(defsketch boids     ((width 400)      (height 400)      (restart-on-change nil)      (boids (loop repeat 20                   collect (make-boid (random width)                                      (random height)))))   (background (gray-255 230))   (draw-boids boids)   (update-positions boids))`

So far, these changes haven't affected the boid behaviour, so let's circle back and implement `rule-1`, which can be summarised as "stay away from other boids". When a boid is less than 10 pixels from another boid, we push them away from each other to avoid crowding.

`(defun rule1 (boid boids)   (let ((v-sum (vec2 0 0)))   (loop for boid2 in boids         for offset = (v- (pos boid) (pos boid2))         for dist = (v-length offset)         when (and (not (eq boid boid2)) (< dist 10))           do (v+! v-sum offset))   v-sum))`

(Note: the vector functions ending in `!`, like `v+!`, follow the convention of storing the result in the vector passed as the first argument).

When we recompile this function...

...a pair of boids that happen to be too close to each other are sent flying off into the void. There's no counterforce to bring them back, just yet.

Next, we implement `rule-2`: boids should fly towards the average position of other boids. Our implementation could be more efficient by summing the boid positions just once, rather than doing it for every single boid, but I can't be bothered.

`(defun rule2 (boid boids)   (let ((center (vec2 0 0)))    (map nil         (lambda (boid2)           (when (not (eq boid boid2))             (v+! center (pos boid2))))         boids)    (v-scale! (/ (1- (length boids))) center)    (v-! center (pos boid))    (v-scale! (/ 200) center)    center))`

Recompiling `rule-2`, we get...

Yes! This is starting to look vaguely like Boids. Let's add the final rule, `rule-3`: boids should match their velocity to all the other boids. Implementation note: we probably shouldn't update the velocities until all the new velocities have been calculated, but this doesn't seem to matter too much.

`(defun rule3 (boid boids)   (let ((result (vec2 0 0)))    (map nil         (lambda (boid2)           (when (not (eq boid boid2))             (v+! result (velocity boid2))))         boids)    (v-scale! (/ (1- (length boids))) result)    (v-! result (velocity boid))    (v-scale! (/ 8) result)    result))`

Recompiling, we see the Boids calm down a little bit.

Since it's not very bird-like to fly around in a vortex of death, we could also give the boids a purpose by making them follow the mouse position. The result of these changes can be seen at the top of the post.

`(defsketch boids     ((width 400)      (height 400)      (restart-on-change nil)      (boids (loop repeat 20                   collect (make-boid (random width)                                      (random height))))      (mouse-pos (vec2 200 200)))  (background (gray-255 230))   (draw-boids boids)   (update-positions boids mouse-pos)) (defmethod on-hover ((instance boids) x y)   (setf (boids-mouse-pos instance) (vec2 x y))) (defun update-positions (boids mouse-pos)   (let ((max-velocity 10))     (map nil          (lambda (boid)            (setf (pos boid) (v+ (pos boid) (velocity boid))))          boids)     (loop for boid in boids           do (setf (velocity boid)                    (v-clamp max-velocity                             (v+ (velocity boid)                                 (rule1 boid boids)                                 (rule2 boid boids)                                 (rule3 boid boids)                                 (v-rescale 0.1 (v- mouse-pos (pos boid)))))))))`

And with that, we have a complete implementation of Boids! At the risk of beating a dead horse, I'll re-emphasise that we did the whole thing without once restarting our program or waiting a perceivable amount of time for code to compile.

### Closing thoughts

I hope, in this brief demonstration of livecoding, I've given you a taste of how useful and fun this feature can be, whether you're developing a graphics application or mundane accounting software. Like I've said, it's not unique to Common Lisp, as at least Smalltalk and Erlang have similar capabilities. It's also possible to bridge the gap in less interactive languages by making applications automatically restart themselves when a code change is detected, or by bolting on a scripting language. Just do me a favour and ask yourself, the next time you're waiting the requisite time units for your code to recompile: _How can I make this workflow more interactive? How can I make it more... like Common Lisp?_

* * *

1.  See the [Wiki page](https://en.wikipedia.org/wiki/Live_coding), and also [interactive programming](https://en.wikipedia.org/wiki/Interactive_programming). [↩](#fnref:livecod "Jump back to footnote 1 in the text")
    
2.  I also heavily leaned on [this webpage](https://vergenet.net/~conrad/boids/pseudocode.html) for my implementation. Thanks, Conrad! [↩](#fnref:boidsref "Jump back to footnote 2 in the text")
    

* * *

[<< previous](/blog/chess-detective.html)

*   [Back to blog](/blog.html)
*   [RSS feed](/feed.xml)

I'd be happy to hear from you at _galligankevinp@gmail.com_.

---

# The Danglepoise

*Source: <https://www.sallery.co.uk/danglepoise>*
*Published: 2025-04-23T16:54:54.000Z*

[

.st0 { fill: #898989; }

](/)

[Blog](/blog)[](/rss.xml "Subscribe to my RSS Feed")

.theme-toggle { display: none !important; }

Auto

# The Danglepoise

Published on 23 April 2025

41 min read

Home Automation

Projects

## [](#motivation "Permalink")Motivation

In the dying years of the 20th century, the “rise and fall” light fitting became briefly popular. You know the type: a counterweight (or spring) balances out the weight of the lantern so that the lamp can be moved up and down. I’ve always thought that these were rather neat. You can leave them up near the ceiling for general room illumination, lower them a bit to create a more intimate atmosphere, or pull them right down for focused task work. Couple a rise and fall pendant with that other 1970s lighting must-have, the dimmer switch, and you have a really flexible lighting system.

I recently found myself in need of some lighting, and wanted to replicate this neatness. It became rather complicated.

Why not just buy a rise and fall pendant lamp and a dimmer switch, and have done with it? Three reasons. Firstly, modern decorative lighting seems to operate in a very price-sensitive market, which has driven manufacturers to engineer out costs everywhere that they can. This generally results in a certain flimsiness in a large number of domestic light fittings. That works pretty well for something that you can simply install and forget; the disconcerting wobbliness will bother you for a few minutes while you install the fitting, and is then irrelevant until you come to remove it. For something that is expected to move reliably and safely, though, wobbliness and flimsiness make me unhappy.

This first problem could be avoided by looking at antique rise and fall fittings: these are generally more solid. However, finding one in good condition is reasonably difficult, and finding five in good condition _that match_ is nigh on impossible. Five, you say? Ah yes. Following some recent renovations, we’ve ended up with a reasonably long dining table, ideal for entertaining or for a big family game of [Kingdom Death : Monster](https://kingdomdeath.com/) (caution: not suitable for families). Lighting this adequately needs, I reckon, about five lights in a row. So the antique approach is out.

Thirdly, finally, and possibly most fundamentally: I really like putting electric motors in things. It’s not that I’m a fan of pointless complication (although… actually that’s probably a whole other post!). It’s just that having something move automatically is just inherently more satisfying than having to move that thing yourself. Or at least I think so.

Having convinced myself that there’s nothing on the market that would satisfy my (admittedly niche) requirements, I did what any sensible person would do: I gave up and tried to ignore it. I failed. This post is an attempt to document my _persistent_ failure to ignore the urge to make lights go up and down with motors.

## [](#research "Permalink")Research

### [](#on-slip-rings "Permalink")On slip rings

So, what’s the best way to arrange for a lamp to move up and down? My first thought was to suspend the lamp from some suitable flex, and wind the other end of the flex around a drum attached to a motor. This seems logical, but makes getting power to the lamp somewhat tricky: as the drum turns, we need some way of maintaining electrical connectivity. The solution to this is a “slip ring”, which is basically some circular conductive rings on one side of a spinny thing arranged such that they’re in contact with some… contacts on the other side of the spinny thing. I’d say “stop me if I’m getting too technical”, but to be honest, there’s no stopping me now.

Anyway, slip rings are definitely a thing. There are quite a wide range of them, but we have a couple of extra constraints: not having thought through exactly what sort of lamp we’re going to dangle from this thing, it seemed best to use a conventional mains lamp holder (you can get lots of different types, after all), rather than trying to find _exactly_ the right low-voltage solution at the outset. So we need to run mains over the slip ring, and furthermore, we’d really like the lamp not to flicker when it moves. That means that we need _quite a good_ slip ring.

In my searches for slip rings, I found three main types: moderately-priced low-voltage slip rings, cheap mains-rated slip rings for vacuum cleaners (the ones with self-rewinding cables, presumably), and _really_ expensive high-quality slip rings. These last seem to be used mainly by defense companies: tank turrets(!), seeker heads on missiles, that sort of thing. I hadn’t set a budget for this project yet, but when potential suppliers are oriented toward the heavier end of the military-industrial complex, it’s time for a re-think.

I re-thought.

If I can’t spin the cable around, I can’t really wind it up. If I can’t wind the cable, I’m probably going to need to wind something else in order to turn the rotational movement of a motor into linear movement to make the lamp rise and fall. That’s not so hard, but then what do I do with the flex, which is still going to be necessary in order to provide power to the lamp? I _could_ just leave it loose, forming a big loop when the lamp is at the top of its motion, but that will a) look pants and b) tend to push the lamp off-axis (also looking pants). So we need a way to make sure that the flex fills a more compact space when it doesn’t have much distance to cover, but still allows extension when the lamp falls. I came up with these (some of which printed better than others):

![](/images/posts/dangle-bias.jpg)

The lamp fitting is suspended from a steel cable. This seemed like a good choice for something that can be wound: strong, flexible, and readily available (in my case, from the very helpful [TECNI](https://tecni.uk/) in Somerset). I settled for a cable 1.5mm in diameter, which has a Minimum Breaking Load of 130kg - probably a bit much, for these purposes, but easier to get hold of than anything thinner. The world-shaking innovation, here, is the pairs of little plastic clips. These thread onto the cable (the steel one) and then clip onto the flex. Get this: the orientation of the flex-clip relative to the cable loop is offset by either +90º or -90º! Radical. The upshot of this is that the flex adopts a pleasing zig-zag configuration as the cable retracts.

I prototyped this using a plywood mount and a hand-pulled cable, and convinced myself that it works. I had a photo of it working, but I’ve lost it, so here’s a short clip of the finished product doing some zig-zagging:

### [](#rude-mechanicals "Permalink")Rude Mechanicals

OK, that’s the dangly bit out of the way. Next to think a bit harder about the whole moving-up-and-down-under-electronic control part. As mentioned above, motors are good. Of course, there are lots of different types of electric motor, with various sizes and capabilities, so before doing any proper design work, I probably ought to choose one. It’s worth noting that these lamps probably don’t need to move particularly fast, and despite the cable’s strength, aren’t intended to be particularly heavy. So I shouldn’t need a really big motor - that’s good, as we’re going to be attaching the whole assembly to the ceiling at some point (more on this later), so we don’t want anything too heavy.

Small is good, then. Except, not too small; we can always trade speed for torque using a gearbox, but that’s noise and complexity that I don’t really want to deal with. So it would be nice to have a motor with enough torque to directly drive the cable-winding drum. I’d also like to be able to position the lamp reasonably accurately. High torque, relatively low speed, precise control? It sounds like we’re in stepper-motor territory. For those rare readers who aren’t particularly into electric motors (I’m trying not to judge), stepper motors are the kind of motors usually used in 3D printers. They have two (or more) separate coils, arranged in such a way that energising them in a particular sequence causes the motor to rotate through a single “step”. Reversing the sequence makes them take a step in the opposite direction. Steps are usually fairly small, of the order of a degree or less, so it takes lots of steps to rotate through 360º. This makes them really good at precise positioning, not so great at really high-speed operation, and pretty high-torque.

Stepper motors also have another interesting property: they’re good at holding a position. One coil will be energised at every possible position, providing a “holding torque” which resists the motion of the shaft. This sounds pretty useful for our application, as we want the lamps to stay where they’re put, but it also means that they use very nearly as much power at standstill as they do when they’re spinning. That seems… inelegant. Wasteful. Not fun. So we need something more. Some kind of brake? Yeah, that’d do it. Such things are indeed available, but are not necessarily available for the size of stepper motor you want (and you can get steppers in almost any size). I selected a motor and brake assembly that seemed about right, which was promptly discontinued by the manufacturer half way through the project.

### [](#is-there-an-app-for-that "Permalink")Is there an app for that?

Heroic in my ignorance of the finer points of mechanical design, I deferred further thought of how everything was going to fit together until later on. The last key piece to nail down (not literally: that’s still a mechanical concern) was the electronics, and more specifically what kind of microcontroller to use. I have for the longest time been a fan of the [Electric Imp](https://www.electricimp.com/) platform - indeed it formed the basis of my major commercial hardware project, the [Fruit](https://www.linkedin.com/pulse/kiwi-power-launches-third-generation-hardware-platform-gavin-sallery/), several hundred of which are still in use 7 years later. However, the company behind it has changed hands a number of times, which makes it look a bit questionable from a longevity point of view, and in any case lots of my fellow techies told me at the time that we’d have been better off using an ESP32. I can see the superficial similarities: they’re both powerful embedded microcontrollers with wifi support. Electric Imp go rather further in terms of their security model and ease-of-use, but ESP32s are more popular, and cheaper. I gave in, and decided to build the electronics around a [TinyPICO](https://www.tinypico.com/), which is a particularly well-designed variation on the ESP32 theme.

## [](#design "Permalink")Design

Off we go then. We’ve got the ability to dangle, a stepper-and-brake widget, and a microcontroller. Where to start? On the somewhat-arrogant assumption that I’d be able to eventually make the firmware work eventually, I decided to start with the electronics. Except, of course, it would be silly to try to design the electronics without knowing how much space I’ve got to play with, so I actually started with the rough outlines of the physical design. The key component was clearly the stepper motor, as it’s relatively big and heavy - it would need a rigid mounting point, and some air-flow around it for cooling purposes. It would also need to attach to some kind of winch arrangement to drive the cable. After a bit of spreadsheet-work, I established that a winch drum with a diameter slightly less than that of the motor would give adequate torque and also be able to spool up a few metres of cable without being too wide, which suggested a nice simple stack of brake : motor : drum as the major assembly to design around.

I spent a while vacillating on whether I’d need any auxiliary cable management; I considered adding additional rollers so that the cable could exit the finished unit from the absolute centre (purely for aesthetic reasons), but decided in the end that the wear and complexity weren’t worth the hassle. Instead, the cable exit would be centred in one axis and offset on the other, with the cable descending directly from the winch drum without passing over any other load-bearing part. This needed the motor assembly to have one edge just over the centre-line of the enclosure, which immediately implied a cuboid outer box leaving a roughly 140 x 60 x 80mm void for the electronics (and quite a few mechanical details to be worked out later).

![](/images/posts/dangle-sketch.jpg)

### [](#electronics "Permalink")Electronics

With a rough space-budget worked out, it was nearly time to break out KiCad, but first I needed to work out what, exactly, to try to fit into that space. The TinyPICO had already been selected, but that certainly can’t drive a stepper motor directly, and a few other ideas had emerged whilst I’d been kicking the concept around. The electronics, I decided, would have to do the following things:

*   Have a self-contained mains-rated power supply
*   Be _really quite unlikely_ to catch fire
*   Have a separate power input for the lamp fitting itself (allowing the unit to function as a lamp even if all the worky bits fail - optimistic, eh?)
*   Be able to switch the lamp supply on and off (no dimming required, though; all the units would be wired to an external C-Bus dimmer channel)
*   Drive the solenoid brake
*   Drive the motor itself, ideally smoothly and quietly
*   Indicate overall status via an LED
*   Power the TinyPICO

The second of these seemed like the most important, which meant choosing a good mains power supply module and treating it with respect. As always with power supplies, the key factors are voltage and current. Stepper motors aren’t too fussy about voltage, but the solenoid brake is specced for 24 Volts, so 24 Volts is what we will give it. The rest of the electronics would be happier with 5V, so we’ll need a further regulator of some sort. A power budget of around an Amp for the motor, another Amp for the brake (quite high!) and half an Amp for the rest of the electronics (this is generous) works out at 2.5A, or an overall 60 Watts at 24 Volts. Sounds like a job for the straightforwardly-named IRM-60-24, a fully-encapsulated mains power supply from Mean Well.

Because I’m a scaredy-cat when it comes to mains, and also because of the size of the IRM-60-24, I decided to put all the mains-voltage stuff on one PCB, and everything else on a separate one, connected by header pins. The only other components to fit onto the mains board were thus a relay to allow the lamp supply to be switched, and a polyfuse to protect the relay in case of a short-circuit in the lamp flex. It was quite straightforward to knock this together in KiCad, then lay out a suitable two-layer PCB. Gratifyingly, this part of the design needed no further refinement… unlike almost everything else.

![](/images/posts/dangle-psu.jpg)

The control board was a little more involved. In theory, you can drive a stepper motor with nothing more than a handful of MOSFETS and a lookup table, but that needs quite precise timing control (which I wasn’t sure about achieving, given that the ESP32 was going to have quite a lot of other stuff going on), and is in any case fairly crude. The state-of-the-art for stepper motor control involves chopper algorithms that either scale the voltage presented to the motor coils in order to reduce operating noise, or very rapidly react to velocity and load in order to damp out resonances in the motor. Microstepping is also common, allowing ultra-fine positional control, which helps to avoid jerkiness at low speeds. These techniques all sound _horribly_ analogue, so I started looking for a dedicated motor-control chip to take care of it all for me.

The TMC2208 from Trinamic appeared to fit the bill: it has a lot of trademarked features such as MicroPlyer™ and StealthChop2™, not to mention the probably-helpful-sounding SpreadCycle™. These tick all the “fancy control algorithm” boxes, and the part can drive up to 2A per coil at voltages up to 36V, whilst needing few external parts. It has a handy UART interface. The only slight down-side is that it’s only available as a QFN part: these are quite fiddly to hand-assemble, particularly if your hot-air gun is on the wonk (as mine is), so it probably meant having someone else assemble the board, and also using a 4-layer PCB for thermal reasons. Not the end of the world, but to convince myself that this part would indeed do the trick, I ordered a development kit.

In summary: yes, the TMC2208 can definitely drive the stepper motor I had in mind. Excellent. That was fun. Now to finish off the Bill of Materials for the control board. We’d need a power supply for the low-voltage side of the TMC2208 and the TinyPICO (converting the 24V we get from the mains board down to 5V), and also a driver for the solenoid brake (and indeed for the lamp-supply relay over on the other board). I picked the BTS7090 for this, which is almost certainly overkill but, being an automotive part, seemed designed to be quite tolerant of various thermal and power-supply abuses. Oh, we also needed a limit switch, to determine when the cable had been wound up to the top of its travel.

After quite some time spent poring over datasheets, I convinced myself that I’d come up with a workable schematic. That led to the pleasantly zen task of routing all the tracks; quite satisfying, but I’m _sure_ I was told back in the 1990s that this would be a fully-automated activity by now… anyway, after the usual feeling that I’d missed something important, but not being able to find out what it was, I sent the designs to the almost improbably helpful [JLCPCB](https://jlcpcb.com/) for manufacturing (and partial assembly of the control board). Design-for-Manufacturing is a vast and complex topic, which I largely ignored for this project - I could certainly have made life easier by choosing more readily-available parts, but for a proof-of-concept such as this, it’s probably not a good use of time.

### [](#mechanical "Permalink")Mechanical

I’ve been trying to find an interesting angle to use when writing about mechanical design, but the best I can do is 1.5º - that’s the draft angle applied to the edge of the chassis, to ensure that it’s possible to remove it from the casing. It’s not actually that interesting. What was more interesting was the sheer complexity of the design I ended up with; I’ve been working with 3D modelling and 3D printing for several years now, but this was by far the most complicated design I’ve attempted. As is, I think, often the case, a lot of the complexity came from a desire for outward simplicity: I really wanted the body of the main unit to be visually simple, and as compact as possible. This meant trying to pack the internal components together quite tightly, and minimising the number of features that would be visible on the bottom or sides of the unit. Whether I was successful in this will become more apparent later on (spoiler: not really, in my opinion), but let’s walk through the initial design first to understand where the gremlins were hiding.

From the rough block diagram above, it’s clear that we have three main parts that need to be held in relation to each other, and also protected from pokey fingers. These are the mains PCB, the control PCB and the motor. Whatever we end up doing about a winch will be attached to the motor shaft, so that doesn’t really need too much thought. It would also be a good thing if all the parts stay firmly attached to the ceiling during use: the motor and brake assembly weighs just under 1kg, so I’m quite keen to avoid it falling on anyone’s head. However, it also needs to be possible to remove the unit for maintenance (and inevitable debugging).

My thinking converged on attaching the motor to a rigid chassis, that would interlock with a mounting plate that would be screwed to the ceiling. A latch would be provided to ensure that these two parts couldn’t accidentally cease to be interlocked. The chassis would also allow us to use screws to attach an outer casing to the chassis, without these being visible once the unit was mounted. Neat. It was here that I made my first big mistake: because the casing would be quite deep, I thought it would be a good idea to have the PCBs simply slot into it from above. These could then be secured by the chassis, which could remain quite thin - and also wouldn’t have to have any protuberances on its lower surface. This appealed to me, on the basis of being easy to print without supports.

In retrospect, I should have attached the PCBs to the chassis, not the casing. It would have vastly simplified the process of assembly, and made the workings much easier to debug. That would have been much more useful than the saving in plastic achieved by having a thin chassis. A useful lesson for next time.

Anyway, this discussion would be much easier to follow with pictures, so let’s see some:

![](/images/posts/dangle-float.png)

These are the main parts. Oh, I should probably point out that I used the _excellent_ OnShape for all this: it’s an absolute pleasure to use, compared to all the other CAD systems I’ve tried. I know I’m only scratching the surface of its capabilities, but just getting the basics absolutely right makes it infinitely less frustrating than, say, Fusion 360. Without it, this process would have felt a lot like _work_, rather than something I’m doing for fun. Anyway, those parts look rather lost, just floating in space, so here’s an early version of the chassis:

### [](#early-chassis "Permalink")Early chassis

The finger-type arrangement in the middle is intended to interlock with the mounting plate, which looks like this:

### [](#early-mounting-plate "Permalink")Early mounting plate

The mounting plate attaches to the ceiling via the screw holes (I provided several, as you never know what you’re going to hit), and can be lined up neatly using the alignment notches. The lambda-shaped clip on the chassis engages with the mounting plate, making sure that the two parts can’t be separated unless you depress the clip with a suitable tool. The rest of the features are mainly an attempt at cable management, which would later undergo heavy revision so I won’t waste time on them now.

#### [](#on-winches "Permalink")On winches

There’s surprisingly little material available on the Internet on the subject of winch design, so I had to tackle things largely from first principles. As such, I made an interesting series of mistakes, and would take a fundamentally different approach if I were to tackle this design again. The first challenge was to securely attach the cable to the drum. Tight bends are bad for braided cables, so I started by forming a cylinder and then providing a hole in this through which the cable would be led to an attachment point inside the cylinder. The end of the cable would be formed into a loop using a crimp-on ferrule, and then slipped over a cunningly-shaped mounting post that would hold it in position. The post doesn’t have to be massively strong, as there would always be a few turns of cable on the drum in use, and the friction between these turns and the drum itself would provide the holding force rather than the post itself - but even so, I tried to make it as solid as possible.

Another concern was to try to make the cable wind neatly onto the drum, particularly to avoid it all bunching up on top of itself. Received wisdom seems to be that this is best tackled in the first layer by shaping grooves into the drum for the cable to spiral into. I wasn’t sure how effective this would be, but spent a fun afternoon on it anyway, coming up with a design that subtracted a swept helical tube from the surface of the cylinder to form a nice spiral groove (with appropriate lead-in and lead-out). Add some flanges at either end of the drum to prevent the cable slipping off, and we’re pretty much done:

![](/images/posts/dangle-drum.png)

#### [](#other-mechanical-bits "Permalink")Other mechanical bits

As mentioned previously, we need to know when the lamp fitting has been winched to the top of its travel, to provide a reference point from which to calculate distances, and also to stop the motor smashing the lamp into the main unit with catastrophic results. This is one of the parts that actually iterated pretty rapidly between mechanical and electronic design, but I’ll discuss it here to avoid jumbling up the narrative too much. Basically, the idea was that the cable would exit the casing through a narrow slot, aligned to be tangential to the edge of the drum. The area surrounding the slot would be hinged, such that if anything larger than the cable impacted this area it would pivot in such a way as to depress a microswitch on the PCB. As the cable slot is on a centre-line of the casing and the control PCB is all the way over on the edge, this necessitated a lever, pusher and switch arrangement that ends up reminding me vaguely of the hammer, stirrup and anvil of the human ear:

![](/images/posts/dangle-limit.png)

Fitting this into the casing involved a bit of fiddling around with the internal bulkhead (which was there to make sure that the steel cable cannot come into contact with any mains-voltage parts, as well as providing rigidity), but apart from that the casing design was, as a first attempt, reasonably straightforward. Honest.

![](/images/posts/dangle-assembly.png)

### [](#early-casing "Permalink")Early casing

The flex exits from the centre of the bottom face, secured internally by a strain-relief clamp, and the casing as a whole (including the PCBs) is attached to the chassis using brass screw-thread inserts. These are very easy to use (just heat them up with a soldering iron and push them in), and provide a secure mechanical connection; I’ll be using them again in future.

With that, _in theory_, the mechanical design was done. In practice… read on. But first, let’s turn to firmware.

## [](#firmware "Permalink")Firmware

It turns out that those who assured me that the ESP32 is as capable a platform for embedded development as Electric Imp were… just. plain. wrong. Comparatively speaking, it’s a dog. Don’t get me wrong, it’s a very capable device, and all the pearl-clutching about its potential security vulnerabilities is _probably_ spurious, and of course it’s very cheap, but… the developer experience is about as pleasant as trying to prune a rose bush using only a nail file: do-able, but it’s going to hurt.

The fundamental difficulty with developing for the ESP32 is the fabled Gulf of Execution. In simple terms, it takes too bloody long to get feedback after making a change, because deploying new code is something that you really have think about (rather than being incidental and transparent, as it should be). I must admit that I hadn’t done a lot of reading into the specifics of building and deploying code on this platform, which was a mistake. I had naively assumed that things had improved in the decade or so since Electric Imp hit the market, and that people wouldn’t be putting up with having to plug a serial cable into a device that already has on-board WiFi, just to program it. How wrong I was.

I’ll return to this topic (as it is irritating, and I don’t like being reasonable about things that obviously ought to be better), but first a brief digression on languages. There are lots of languages that will target the Xtensa CPU cores used by the ESP32, including, intriguingly, Rust. I like Rust. It’s a bit of a head-scratcher at times, but once you’ve got that head around the borrow-checker, it gives you lots of lovely compile-time guarantees; you can be pretty confident that if your code compiles, it will not only run but probably do what you expect, which is a genuinely confidence-inspiring property. So, my starting point for developing the firmware for the Danglepoise was to set up the toolchain for cross-compilation of Rust from a Mac to an ESP32. This was pretty straightforward.

What was less obvious was the level of support for the various ESP32 peripherals (including, critically, WiFi). Documentation for this was, at the time that I started looking at it, fairly uneven (I know it’s improved since). Further confusion emerged from not knowing whether it was best to go for a bare-metal implementation (`#![no_std]`, in Rust-speak), or whether to take the resource hit of using the Rust runtime. This is a fairly nuanced decision, and it’s unfortunate that prospective Rust embedded developers have to grapple with it before they’ve had much of a chance to build familiarity with the trade-offs.

In any case, after experimenting with a few different approaches, I ended up being able to get WiFi up and running on a bare-metal ESP32. However, finding higher-level libraries (such as an HTTP server, for example!) that would work without the standard library was deeply frustrating. Again, this has probably improved a lot in the last couple of years, but in any case none of the tooling seemed really set up for deploying new code over-the-air, which I considered to be a show-stopper.

In the course of reading quite a few pages on the ESP32, it became apparent that there were a lot more people using MicroPython than were using Rust. Large numbers of hobbyists usually bring developer-experience improvements, and I had read of some people successfully using a tool called WebREPL to deploy code to an ESP32 over wifi. Peripheral support also seemed to be extremely good. Now, I’ve used Python a bit in the past (it runs the lighting in my wardrobe, for example, and also the pantry door), and it’s… OK. I don’t really understand why so many people think it essential for machine learning work, and my personal opinion is that significant whitespace is pure evil, but lots of people get along with it so it can’t be too bad.

After a little more research, it became apparent that an IDE called Thonny (link) was the tool of choice for MicroPython development, mainly because it supports deployment over WebREPL. I spent a bit of time trying to replicate this capability using IntelliJ IDEA (my tool of choice), but it proved to be too much effort for my then-extant levels of motivation - which were fairly low, as I’d hoped to be writing some actual firmware by this point.

![](/images/posts/dangle-thonny.png)

After satisfying myself that I could, at last, send code from Thonny to the TinyPICO over-the-air, I wrote a little bit of code to flash the onboard LED on and off, and then started thinking about how to talk to the TMC2208. At this point, the PCBs arrived in the post.

## [](#development "Permalink")Development

With PCBs, components, first-draft printed parts and a vague idea of how to approach the firmware, there now began many, many months of iterative kerfuffle. Some of this was highly educational. It all took a lot longer than expected. For the sanity of the reader, I’ll try to boil this period down to the key discoveries.

*   The mains PCBs were good, and did what was expected of them as soon as I populated the boards and powered them up (using a 3D-printed box to allow me to switch the motor/lamp supplies separately with a degree of safety). Great.
*   The control PCBs were more fiddly. They arrived with the surface-mount parts already in place (including that fiddly TMC2208), leaving me to place the through-hole parts by hand. Most of these were easy, apart from the TinyPICO; I had hoped to be able to place blobs of solder under the part and then join it to the PCB using a hot-air gun (basically, a poor-man’s BGA), but the untimely demise of my hot air gun meant that I actually had to solder 20 short pieces of tinned-copper wire to both the part and the board to serve as headers. This was surprisingly fiddly, as the pieces of wire tended to drop out of the holes when you heated the opposite side of the assembly. I developed a technique of cutting the wires long, soldering one end, and then holding the other with a pair of tweezers whilst I soldered the other end, which worked well but was quite time-consuming.
*   Another problem with the control PCBs was that the TinyPICO didn’t seem to want to talk to the TMC2208 over a serial connection. I could send simple pulses on the STEP and DIR pins, which gives limited control of the motor, and the motor would indeed step appropriately (something of a relief). However, more sophisticated control of the driver for things like setting MicroPlyer parameters, reading error codes and tweaking current limits can only be achieved via a serial link, which initially proved spectacularly uncommunicative. My initial suspicion was that I was sending the wrong checksums, as the motor controller datasheet didn’t go into a lot of detail on exactly how to calculate these. There was some C pseudocode for checksum generation, but it’s always possible that I’d translated this into MicroPython incorrectly. Luckily, Trinamic provide a handy spreadsheet with (among other things) a checksum calculator; once I’d found this, I could feel happy that I’d got the checksums right, but still further confused that I still couldn’t talk to the controller. Eventually, after much probing with the oscilloscope and noticing that the transmitted serial voltages looked a bit weak at the controller end of the connection, I realised that a resistor was in the wrong place: the TMC2208 uses a single pin for both transmit and receive, so if you’re attaching this to two separate UART pins it’s good practice to put a 1k resistor in the receive line. I’d put it in the transmit line by mistake, which was attenuating the signal. After some fine work with a microscope and a scalpel, I moved the resistor to the right place and data began to flow. I’d have to repeat this procedure on each of the control boards.
*   With more nuanced control of the motor now working, I could start tuning the motion parameters. Quite rapidly, this led to the realisation that a push-fit drum wasn’t going to cut it: the motor shaft gets a bit warm in operation, and printable plastics have a fairly low melting point, so after half an hour of testing the drum would start to slip on the shaft. Amazon were happy to sell me some appropriately-sized motor shaft adaptors in aluminium (at least I assume that they were happy: at the markup they were charging, they should have been), which fixed securely onto the shaft with a grub screw and then could be screwed into the (redesigned) drum.
*   The limit switch mechanism needed a few tweaks, including (critically) the application of grease to the little push rod that goes between the lever and the microswitch. The mounting points for the lever also needed some adjustment, to make sure they didn’t pop out if pushed too hard.
*   While implementing the limit switch logic (MicroPython has interrupt handlers: hooray!), it became apparent that getting code to the TinyPICO over the air was a little bit flaky. Transfers would sometimes abort part-way, needing a reset of the device, and very occasionally they’d leave it in an inconsistent state that had to be overwritten over the USB-C connection. Not too troublesome while everything was in parts on the bench, but… worrying.
*   Speaking of parts… getting some of them together proved fiddly. The limit switch parts need to be assembled with pliers, because I can’t get my hands into the tiny gap between the casing and the bulkhead. Sliding the PCBs into their guide slots _usually_ worked well, but sliding them out again could result in bent pins if the two PCBs skewed relative to each other. Which they were likely to do, as the mains PCB has some fairly stiff wires attached to it, which apply noticeable torque. Getting these wires to stay where they’re meant to be is also non-trivial, especially when trying to close up the unit (they tended to get caught on things you can’t quite see and don’t have enough fingers to poke back into place). Another good argument for not putting the PCBs in the wrong half of the box, really.
*   The TinyPICO has a little LED to show when it’s charging. When it’s running from a 5V supply, it just shows that it has power, which is not particularly helpful. I must have imagined reading that there was a PCB trace on the TinyPICO that could be cut to disable this, but there isn’t. Tiny slivers of electrical tape provided a partial solution, but the best fix turned out to be a dab of Sugru.
*   With all the parts fitted together, I rigged up a temporary mounting rig in the shed so that I could develop the firmware some more. The first order of business was to get a web server running, so that commands could be sent to the Danglepoise remotely. This wasn’t particularly hard, but did reveal a couple more code deployment issues, one minor, one less so. The tedious-but-not-particularly-significant one is that using a library in MicroPython means remembering to copy the file to the target device manually (and getting the name right). This is a one-off activity, so it’s merely clunky, but it’s not very polished. A bigger problem is that running a web server _really_ impedes the performance of the WebREPL: file transfer failures became even more common, and it was also frequently impossible to halt the device so that new code could be executed. This basically rendered it impossible to deploy over-the-air, meaning a revision to the casing so that I could get access to the TinyPICO to plug in the USB cable. Disappointing. The ESP32 really does seem to be lacking some quality-of-life features.
*   Talking of the casing, revisions to this started to take quite a lot of time: it’s a tall part, and I wanted a reasonably fine finish, so it ended up taking around 12 hours per print. I probably got through about 2.5kg of filament over the course of the project, mainly on the casings. Incidentally, I used PETG for the casing, as it has a _slightly_ higher melting point and is somewhat impact-resistant compared to PLA.
*   Now onto the biggest mechanical problem: persuading the cable to stay in the right place. Under tension, the cable stays neatly and tidily coiled around the drum. If, however, you even think about letting it go slack at any point, it will jump off the drum and wind itself around the nearest obstruction (usually the motor shaft). You may not discover this until you next move the motor, at which point it will seize up and probably make some very unpleasant noises. Assembling the casing is a two-handed process, so the “proper” technique (developed after _many_ issues with immovable winches) is to put something heavy on the cable, drape it off the end of the workbench, and then be very very careful to only move the chassis and casing in such a way as to maintain the tension in the cable. This is, to put it mildly, a faff. Some kind of brake mechanism acting directly on the cable would be a much better idea, as well as being potentially lighter, quieter and less current-thirsty than the solenoid brake on the motor shaft. Something to think about for next time.
*   When it came to actually attaching a unit to the ceiling, a couple of things became apparent. Firstly, there was nowhere near enough clearance to get the actual mains cables on the supply side to lay flat. If they don’t lay flat, there’s no way to get the interlocking fingers to engage, and so no way to attach the unit to the ceiling. The best place to discover this is definitely not at the top of a step ladder, where it gets surprisingly warm (thermal stratification in action!). The second discovery was that the “easy to use” push-fit mains connectors I’d chosen were anything but: they’re surprisingly tall, require quite a lot of force and are prone to losing the little actuator-lever mouldings that are the only safe way of disconnecting them. A redesign of the printable parts addressed the first discovery, but not the latter, which remains awkward.
*   RCBOs are generally a good idea, but don’t like sharing a neutral, for what turn out to be perfectly obvious reasons when you actually stop and think about them. Some small (supply-side) electrical adjustments were necessary before I could power up the lamps.
*   I got quite a long way into the development process before melting my first unit. Eeek. It wasn’t a _catastrophic_ melting, but it was worrying. By this point, I was happy to leave the units powered up and waiting for commands. They could be driven up and down, and after moving, would release the solenoids and enter a low-power state. That is, they’d do that _most_ of the time, but not always. It turned out that every now and then, for reasons that are probably due to the accumulation of floating-point errors, the motion-control algorithm would fail to converge to a zero-velocity state. This would leave the solenoid powered up. Leaving the solenoid powered up for too long causes meltiness. Not having a temperature sensor near to the solenoid was probably a mistake; the ones on the control board weren’t very sensitive to the temperature of the brake, so I didn’t really have a good reading on how hot it actually got in operation. In retrospect, the fact that the solenoid had high-temperature-rated wiring was probably a clue. A revised belt-and-braces run-time accumulation algorithm was added to the firmware, ensuring that the solenoid could never be energised for more than five minutes without having a chance to cool down.
*   The solenoid also, it should be noted, makes quite a loud clacking noise when changing state. The firmware thus tries to avoid doing so too often, which is of course in tension with the need to keep it cool. Again, I think that better braking arrangements would be something to look at if I were tackling this again.
*   We found some nice light bulbs in Heal’s.

Apart from these mechanical discoveries, most of the rest of the development process consisted of gradually refining the firmware. It ended up being around 700 lines of MicroPython (not including libraries), with a few mildly-interesting features;

*   PID motor velocity control, with asymmetric up/down acceleration limits (we can accelerate the lamps upward at 0.5G, and drop them at 1G, up to the speed limit of the motor).
*   Odometric position control, referenced to the limit switch. The units wind the lamps up until the limit is hit at power-up, and then keep track of where they think they are based on a velocity x time integration function. This works surprisingly well, though errors do eventually creep in, so after 20 cycles they wait until an upward movement is requested and then deliberately drive all the way to the limit switch again, re-calibrating the odometry.
*   PWM control of the brake driver, in an attempt to reduce the actuation noise. It helped a _bit_.
*   Multiple motion-control regimes: “manual” (which just goes where it’s put), freewheel (useful for un-tangling things, or getting the drum to the right position to access the grub screw that holds it onto the shaft), and two more useful ones:
    *   Function mode, which tries to move the lamp to a position determined by a mathematical function passed in as a request parameter. There are two variables provided to the function, one for time since entry to this mode, and one for the current unit ID. The upshot of this is that you can pass in something like `-500+(200*math.sin((math.pi*(n+1)/3)+2*math.pi*t/1000/40))`, and get a nice rippling sine-wave effect.
    *   Seek mode, which is where the units spend most of their time. A position is specified (in millimetres, with down being negative), and then either an acceleration or a time budget provided. Given a time budget, the control algorithms will then move the lamp with the minimum possible acceleration needed to move from where it is to where it needs to be in the given time. If the movement can’t be made in the given time, it’ll go as fast as it can (up to the acceleration/velocity limits) and just take longer. This involved some quite enjoyable GCSE-level maths.
*   The units subscribe to an MQTT topic, over which commands can be delivered (simultaneously, though all commands allow a delay based on unit ID so that a pleasing ripple effect can be achieved). They report telemetry back on a separate topic, which is how I know that they’ve collectively travelled 1,930m as of this writing.
*   The TinyPICO’s Dotstar RGB LED is used to provide a status indicator: white while the unit is booting, a blue flash to show when an MQTT command is received, yellow whenever the solenoid is active (added after the melting incident), and flashing red when an error occurs or a thermal cutout is triggered. These states are also reported on the telemetry topic.
*   Auxiliary functions exist for setting the cable length and height offset, as these are not the same for each unit. Values are persisted to NVRAM, so they only need setting once. These values are used to ensure that the cable is never over-extended, and to make sure the lamps can be positioned relative to a common reference height even though they’re attached to the ceiling at different altitudes.
*   MicroPython doesn’t really do multi-tasking, so the HTTP and MQTT servers take variable chunks of time out of the main control loop’s time budget. In other words, the control loop can’t rely on being isochronous, and has to time itself and adjust velocity/position estimates accordingly. This isn’t a feature, it just made all the PID code a bit more fiddly.

The most recent version of the firmware was uploaded to the devices around two months ago (I know I’ve waffled on about this enough already, but… deployment should not require a step-ladder!). Since then, the units have been through a couple of power cuts, but have otherwise been powered up continuously. They have behaved extremely well, now that I’ve exorcised the gremlins listed above; they smoothly and un-fussily descend on command, usually to appreciative noises from any guests that we happen to be showing off to. I’ve integrated the MQTT topic with our home control software (which definitely needs another blog post at some point), so anyone in the house can drive the Danglepoise from their phone or from the nice Clipsal wall-switches in the dining room.

They look quite nice over the new table, too.

![](/images/posts/dangle-install.jpg) ![](/images/posts/dangle-hung.jpg)

I’m still experimenting with different positions, speeds, and combinations of lamps; there are lots of options, and they’re fun to play with. I’ve built some pre-set patterns into the control software, but being able to fine-tune the lighting based on what we’re doing at the table, whether it’s extended or not, and how many people are seated is surprisingly good fun. At some point, I’ll probably build a proper UI for it so that each lamp can be simply dragged into position on your phone… or possibly even a physical control panel using motorised sliders… hmmm, now there’s a project…

Overall, I’m pleased with how the Danglepoise turned out. I learned a lot, which was fun, and they achieved the desired effect that I was reaching for at the outset. I do have a slight urge to tackle some of the problems encountered above, but it can wait for a while. A few people who’ve seen it have been kind enough to suggest that there might be a market for such a light fitting; I shall have to do more research into this. The idea of a Kickstarter has been mooted. If you think that the world is quite silly enough without such extravagance, do reach out on Mastodon and let me know.

[](https://mastodon.social/@draazon "Say Hi on Mastodon")[](https://github.com/gbsallery "See my GitHub profile")[](https://www.linkedin.com/in/gbsallery/ "Connect on LinkedIn")[](email "Send an email")

[Home](https://sallery.co.uk)

Powered by [SvelteKit](https://kit.svelte.dev/). Icons by [Iconoir](https://iconoir.com/).

[](https://mastodon.social/@draazon "Say Hi on Mastodon")[](https://github.com/gbsallery "See my GitHub profile")[](https://www.linkedin.com/in/gbsallery/ "Connect on LinkedIn")[](email "Send an email")

[](/rss.xml "Subscribe to my RSS Feed")

.theme-toggle { display: none !important; }

Auto

{ \_\_sveltekit\_1hd1li1 = { base: new URL(".", location).pathname.slice(0, -1) }; const element = document.currentScript.parentElement; const data = \[null,{"type":"data","data":{post:{title:"The Danglepoise",slug:"danglepoise",coverImage:"/images/posts/dangle-cover.jpg",hideImage:true,date:"2025-04-23T17:00:00.000Z",excerpt:"Gratuitously complicated lighting",tags:\["Home Automation","Projects"\],html:"\\u003Ciframe width=\\"720\\" height=\\"480\\" src=\\"https://www.youtube.com/embed/gyZfWfm3maY?si=hJqylWP8d0U7KFap\\" title=\\"YouTube video player\\" frameborder=\\"0\\" allow=\\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\\" referrerpolicy=\\"strict-origin-when-cross-origin\\" allowfullscreen>\\u003C/iframe> \\u003Ch2 id=\\"motivation\\" data-svelte-h=\\"svelte-5eq4mm\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#motivation\\">\\u003Cspan>\\u003C/span>\\u003C/a>Motivation\\u003C/h2> \\u003Cp data-svelte-h=\\"svelte-1cgbsca\\">In the dying years of the 20th century, the “rise and fall” light fitting became briefly popular. You know the type: a counterweight (or spring) balances out the weight of the lantern so that the lamp can be moved up and down. I’ve always thought that these were rather neat. You can leave them up near the ceiling for general room illumination, lower them a bit to create a more intimate atmosphere, or pull them right down for focused task work. Couple a rise and fall pendant with that other 1970s lighting must-have, the dimmer switch, and you have a really flexible lighting system.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-x4uawf\\">I recently found myself in need of some lighting, and wanted to replicate this neatness. It became rather complicated.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1mrbj3c\\">Why not just buy a rise and fall pendant lamp and a dimmer switch, and have done with it? Three reasons. Firstly, modern decorative lighting seems to operate in a very price-sensitive market, which has driven manufacturers to engineer out costs everywhere that they can. This generally results in a certain flimsiness in a large number of domestic light fittings. That works pretty well for something that you can simply install and forget; the disconcerting wobbliness will bother you for a few minutes while you install the fitting, and is then irrelevant until you come to remove it. For something that is expected to move reliably and safely, though, wobbliness and flimsiness make me unhappy.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1a4tw6q\\">This first problem could be avoided by looking at antique rise and fall fittings: these are generally more solid. However, finding one in good condition is reasonably difficult, and finding five in good condition \\u003Cem>that match\\u003C/em> is nigh on impossible. Five, you say? Ah yes. Following some recent renovations, we’ve ended up with a reasonably long dining table, ideal for entertaining or for a big family game of \\u003Ca href=\\"https://kingdomdeath.com/\\" rel=\\"nofollow\\">Kingdom Death : Monster\\u003C/a> (caution: not suitable for families). Lighting this adequately needs, I reckon, about five lights in a row. So the antique approach is out.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-63p4gt\\">Thirdly, finally, and possibly most fundamentally: I really like putting electric motors in things. It’s not that I’m a fan of pointless complication (although… actually that’s probably a whole other post!). It’s just that having something move automatically is just inherently more satisfying than having to move that thing yourself. Or at least I think so.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-f6755j\\">Having convinced myself that there’s nothing on the market that would satisfy my (admittedly niche) requirements, I did what any sensible person would do: I gave up and tried to ignore it. I failed. This post is an attempt to document my \\u003Cem>persistent\\u003C/em> failure to ignore the urge to make lights go up and down with motors.\\u003C/p> \\u003Ch2 id=\\"research\\" data-svelte-h=\\"svelte-1h69bcl\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#research\\">\\u003Cspan>\\u003C/span>\\u003C/a>Research\\u003C/h2> \\u003Ch3 id=\\"on-slip-rings\\" data-svelte-h=\\"svelte-1tznddi\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#on-slip-rings\\">\\u003Cspan>\\u003C/span>\\u003C/a>On slip rings\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-1by7m2c\\">So, what’s the best way to arrange for a lamp to move up and down? My first thought was to suspend the lamp from some suitable flex, and wind the other end of the flex around a drum attached to a motor. This seems logical, but makes getting power to the lamp somewhat tricky: as the drum turns, we need some way of maintaining electrical connectivity. The solution to this is a “slip ring”, which is basically some circular conductive rings on one side of a spinny thing arranged such that they’re in contact with some… contacts on the other side of the spinny thing. I’d say “stop me if I’m getting too technical”, but to be honest, there’s no stopping me now.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1o5pec8\\">Anyway, slip rings are definitely a thing. There are quite a wide range of them, but we have a couple of extra constraints: not having thought through exactly what sort of lamp we’re going to dangle from this thing, it seemed best to use a conventional mains lamp holder (you can get lots of different types, after all), rather than trying to find \\u003Cem>exactly\\u003C/em> the right low-voltage solution at the outset. So we need to run mains over the slip ring, and furthermore, we’d really like the lamp not to flicker when it moves. That means that we need \\u003Cem>quite a good\\u003C/em> slip ring.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1bb6xws\\">In my searches for slip rings, I found three main types: moderately-priced low-voltage slip rings, cheap mains-rated slip rings for vacuum cleaners (the ones with self-rewinding cables, presumably), and \\u003Cem>really\\u003C/em> expensive high-quality slip rings. These last seem to be used mainly by defense companies: tank turrets(!), seeker heads on missiles, that sort of thing. I hadn’t set a budget for this project yet, but when potential suppliers are oriented toward the heavier end of the military-industrial complex, it’s time for a re-think.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1ywqa4m\\">I re-thought.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1aj8urx\\">If I can’t spin the cable around, I can’t really wind it up. If I can’t wind the cable, I’m probably going to need to wind something else in order to turn the rotational movement of a motor into linear movement to make the lamp rise and fall. That’s not so hard, but then what do I do with the flex, which is still going to be necessary in order to provide power to the lamp? I \\u003Cem>could\\u003C/em> just leave it loose, forming a big loop when the lamp is at the top of its motion, but that will a) look pants and b) tend to push the lamp off-axis (also looking pants). So we need a way to make sure that the flex fills a more compact space when it doesn’t have much distance to cover, but still allows extension when the lamp falls. I came up with these (some of which printed better than others):\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-bias.jpg\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Cp data-svelte-h=\\"svelte-wgmwy0\\">The lamp fitting is suspended from a steel cable. This seemed like a good choice for something that can be wound: strong, flexible, and readily available (in my case, from the very helpful \\u003Ca href=\\"https://tecni.uk/\\" rel=\\"nofollow\\">TECNI\\u003C/a> in Somerset). I settled for a cable 1.5mm in diameter, which has a Minimum Breaking Load of 130kg - probably a bit much, for these purposes, but easier to get hold of than anything thinner. The world-shaking innovation, here, is the pairs of little plastic clips. These thread onto the cable (the steel one) and then clip onto the flex. Get this: the orientation of the flex-clip relative to the cable loop is offset by either +90º or -90º! Radical. The upshot of this is that the flex adopts a pleasing zig-zag configuration as the cable retracts.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1wvf3mw\\">I prototyped this using a plywood mount and a hand-pulled cable, and convinced myself that it works. I had a photo of it working, but I’ve lost it, so here’s a short clip of the finished product doing some zig-zagging:\\u003C/p> \\u003Ciframe width=\\"560\\" height=\\"315\\" src=\\"https://www.youtube.com/embed/nk\_7HGiQfsw?si=fCXa\_MzZnT\_lJOkl\\" title=\\"YouTube video player\\" frameborder=\\"0\\" allow=\\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\\" referrerpolicy=\\"strict-origin-when-cross-origin\\" allowfullscreen>\\u003C/iframe> \\u003Ch3 id=\\"rude-mechanicals\\" data-svelte-h=\\"svelte-75biny\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#rude-mechanicals\\">\\u003Cspan>\\u003C/span>\\u003C/a>Rude Mechanicals\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-goi05j\\">OK, that’s the dangly bit out of the way. Next to think a bit harder about the whole moving-up-and-down-under-electronic control part. As mentioned above, motors are good. Of course, there are lots of different types of electric motor, with various sizes and capabilities, so before doing any proper design work, I probably ought to choose one. It’s worth noting that these lamps probably don’t need to move particularly fast, and despite the cable’s strength, aren’t intended to be particularly heavy. So I shouldn’t need a really big motor - that’s good, as we’re going to be attaching the whole assembly to the ceiling at some point (more on this later), so we don’t want anything too heavy.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1savg5n\\">Small is good, then. Except, not too small; we can always trade speed for torque using a gearbox, but that’s noise and complexity that I don’t really want to deal with. So it would be nice to have a motor with enough torque to directly drive the cable-winding drum. I’d also like to be able to position the lamp reasonably accurately. High torque, relatively low speed, precise control? It sounds like we’re in stepper-motor territory. For those rare readers who aren’t particularly into electric motors (I’m trying not to judge), stepper motors are the kind of motors usually used in 3D printers. They have two (or more) separate coils, arranged in such a way that energising them in a particular sequence causes the motor to rotate through a single “step”. Reversing the sequence makes them take a step in the opposite direction. Steps are usually fairly small, of the order of a degree or less, so it takes lots of steps to rotate through 360º. This makes them really good at precise positioning, not so great at really high-speed operation, and pretty high-torque.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-t8p4xp\\">Stepper motors also have another interesting property: they’re good at holding a position. One coil will be energised at every possible position, providing a “holding torque” which resists the motion of the shaft. This sounds pretty useful for our application, as we want the lamps to stay where they’re put, but it also means that they use very nearly as much power at standstill as they do when they’re spinning. That seems… inelegant. Wasteful. Not fun. So we need something more. Some kind of brake? Yeah, that’d do it. Such things are indeed available, but are not necessarily available for the size of stepper motor you want (and you can get steppers in almost any size). I selected a motor and brake assembly that seemed about right, which was promptly discontinued by the manufacturer half way through the project.\\u003C/p> \\u003Ch3 id=\\"is-there-an-app-for-that\\" data-svelte-h=\\"svelte-1vtmlcb\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#is-there-an-app-for-that\\">\\u003Cspan>\\u003C/span>\\u003C/a>Is there an app for that?\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-nnx91k\\">Heroic in my ignorance of the finer points of mechanical design, I deferred further thought of how everything was going to fit together until later on. The last key piece to nail down (not literally: that’s still a mechanical concern) was the electronics, and more specifically what kind of microcontroller to use. I have for the longest time been a fan of the \\u003Ca href=\\"https://www.electricimp.com/\\" rel=\\"nofollow\\">Electric Imp\\u003C/a> platform - indeed it formed the basis of my major commercial hardware project, the \\u003Ca href=\\"https://www.linkedin.com/pulse/kiwi-power-launches-third-generation-hardware-platform-gavin-sallery/\\" rel=\\"nofollow\\">Fruit\\u003C/a>, several hundred of which are still in use 7 years later. However, the company behind it has changed hands a number of times, which makes it look a bit questionable from a longevity point of view, and in any case lots of my fellow techies told me at the time that we’d have been better off using an ESP32. I can see the superficial similarities: they’re both powerful embedded microcontrollers with wifi support. Electric Imp go rather further in terms of their security model and ease-of-use, but ESP32s are more popular, and cheaper. I gave in, and decided to build the electronics around a \\u003Ca href=\\"https://www.tinypico.com/\\" rel=\\"nofollow\\">TinyPICO\\u003C/a>, which is a particularly well-designed variation on the ESP32 theme.\\u003C/p> \\u003Ch2 id=\\"design\\" data-svelte-h=\\"svelte-1d1v208\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#design\\">\\u003Cspan>\\u003C/span>\\u003C/a>Design\\u003C/h2> \\u003Cp data-svelte-h=\\"svelte-kbsxkl\\">Off we go then. We’ve got the ability to dangle, a stepper-and-brake widget, and a microcontroller. Where to start? On the somewhat-arrogant assumption that I’d be able to eventually make the firmware work eventually, I decided to start with the electronics. Except, of course, it would be silly to try to design the electronics without knowing how much space I’ve got to play with, so I actually started with the rough outlines of the physical design. The key component was clearly the stepper motor, as it’s relatively big and heavy - it would need a rigid mounting point, and some air-flow around it for cooling purposes. It would also need to attach to some kind of winch arrangement to drive the cable. After a bit of spreadsheet-work, I established that a winch drum with a diameter slightly less than that of the motor would give adequate torque and also be able to spool up a few metres of cable without being too wide, which suggested a nice simple stack of brake : motor : drum as the major assembly to design around.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-q925wa\\">I spent a while vacillating on whether I’d need any auxiliary cable management; I considered adding additional rollers so that the cable could exit the finished unit from the absolute centre (purely for aesthetic reasons), but decided in the end that the wear and complexity weren’t worth the hassle. Instead, the cable exit would be centred in one axis and offset on the other, with the cable descending directly from the winch drum without passing over any other load-bearing part. This needed the motor assembly to have one edge just over the centre-line of the enclosure, which immediately implied a cuboid outer box leaving a roughly 140 x 60 x 80mm void for the electronics (and quite a few mechanical details to be worked out later).\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-sketch.jpg\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Ch3 id=\\"electronics\\" data-svelte-h=\\"svelte-8adegn\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#electronics\\">\\u003Cspan>\\u003C/span>\\u003C/a>Electronics\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-14l4ec3\\">With a rough space-budget worked out, it was nearly time to break out KiCad, but first I needed to work out what, exactly, to try to fit into that space. The TinyPICO had already been selected, but that certainly can’t drive a stepper motor directly, and a few other ideas had emerged whilst I’d been kicking the concept around. The electronics, I decided, would have to do the following things:\\u003C/p> \\u003Cul data-svelte-h=\\"svelte-h06hoq\\">\\u003Cli>Have a self-contained mains-rated power supply\\u003C/li> \\u003Cli>Be \\u003Cem>really quite unlikely\\u003C/em> to catch fire\\u003C/li> \\u003Cli>Have a separate power input for the lamp fitting itself (allowing the unit to function as a lamp even if all the worky bits fail - optimistic, eh?)\\u003C/li> \\u003Cli>Be able to switch the lamp supply on and off (no dimming required, though; all the units would be wired to an external C-Bus dimmer channel)\\u003C/li> \\u003Cli>Drive the solenoid brake\\u003C/li> \\u003Cli>Drive the motor itself, ideally smoothly and quietly\\u003C/li> \\u003Cli>Indicate overall status via an LED\\u003C/li> \\u003Cli>Power the TinyPICO\\u003C/li>\\u003C/ul> \\u003Cp data-svelte-h=\\"svelte-1k8vxfm\\">The second of these seemed like the most important, which meant choosing a good mains power supply module and treating it with respect. As always with power supplies, the key factors are voltage and current. Stepper motors aren’t too fussy about voltage, but the solenoid brake is specced for 24 Volts, so 24 Volts is what we will give it. The rest of the electronics would be happier with 5V, so we’ll need a further regulator of some sort. A power budget of around an Amp for the motor, another Amp for the brake (quite high!) and half an Amp for the rest of the electronics (this is generous) works out at 2.5A, or an overall 60 Watts at 24 Volts. Sounds like a job for the straightforwardly-named IRM-60-24, a fully-encapsulated mains power supply from Mean Well.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-bgzr54\\">Because I’m a scaredy-cat when it comes to mains, and also because of the size of the IRM-60-24, I decided to put all the mains-voltage stuff on one PCB, and everything else on a separate one, connected by header pins. The only other components to fit onto the mains board were thus a relay to allow the lamp supply to be switched, and a polyfuse to protect the relay in case of a short-circuit in the lamp flex. It was quite straightforward to knock this together in KiCad, then lay out a suitable two-layer PCB. Gratifyingly, this part of the design needed no further refinement… unlike almost everything else.\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-psu.jpg\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Cp data-svelte-h=\\"svelte-13dvjp9\\">The control board was a little more involved. In theory, you can drive a stepper motor with nothing more than a handful of MOSFETS and a lookup table, but that needs quite precise timing control (which I wasn’t sure about achieving, given that the ESP32 was going to have quite a lot of other stuff going on), and is in any case fairly crude. The state-of-the-art for stepper motor control involves chopper algorithms that either scale the voltage presented to the motor coils in order to reduce operating noise, or very rapidly react to velocity and load in order to damp out resonances in the motor. Microstepping is also common, allowing ultra-fine positional control, which helps to avoid jerkiness at low speeds. These techniques all sound \\u003Cem>horribly\\u003C/em> analogue, so I started looking for a dedicated motor-control chip to take care of it all for me.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-mubb1g\\">The TMC2208 from Trinamic appeared to fit the bill: it has a lot of trademarked features such as MicroPlyer™ and StealthChop2™, not to mention the probably-helpful-sounding SpreadCycle™. These tick all the “fancy control algorithm” boxes, and the part can drive up to 2A per coil at voltages up to 36V, whilst needing few external parts. It has a handy UART interface. The only slight down-side is that it’s only available as a QFN part: these are quite fiddly to hand-assemble, particularly if your hot-air gun is on the wonk (as mine is), so it probably meant having someone else assemble the board, and also using a 4-layer PCB for thermal reasons. Not the end of the world, but to convince myself that this part would indeed do the trick, I ordered a development kit.\\u003C/p> \\u003Ciframe width=\\"560\\" height=\\"315\\" src=\\"https://www.youtube.com/embed/ufn\_wNM53ns?si=A8KU5YB-AY0-ujSj\\" title=\\"YouTube video player\\" frameborder=\\"0\\" allow=\\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\\" referrerpolicy=\\"strict-origin-when-cross-origin\\" allowfullscreen>\\u003C/iframe> \\u003Cp data-svelte-h=\\"svelte-1i60rja\\">In summary: yes, the TMC2208 can definitely drive the stepper motor I had in mind. Excellent. That was fun. Now to finish off the Bill of Materials for the control board. We’d need a power supply for the low-voltage side of the TMC2208 and the TinyPICO (converting the 24V we get from the mains board down to 5V), and also a driver for the solenoid brake (and indeed for the lamp-supply relay over on the other board). I picked the BTS7090 for this, which is almost certainly overkill but, being an automotive part, seemed designed to be quite tolerant of various thermal and power-supply abuses. Oh, we also needed a limit switch, to determine when the cable had been wound up to the top of its travel.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-i14jjv\\">After quite some time spent poring over datasheets, I convinced myself that I’d come up with a workable schematic. That led to the pleasantly zen task of routing all the tracks; quite satisfying, but I’m \\u003Cem>sure\\u003C/em> I was told back in the 1990s that this would be a fully-automated activity by now… anyway, after the usual feeling that I’d missed something important, but not being able to find out what it was, I sent the designs to the almost improbably helpful \\u003Ca href=\\"https://jlcpcb.com/\\" rel=\\"nofollow\\">JLCPCB\\u003C/a> for manufacturing (and partial assembly of the control board). Design-for-Manufacturing is a vast and complex topic, which I largely ignored for this project - I could certainly have made life easier by choosing more readily-available parts, but for a proof-of-concept such as this, it’s probably not a good use of time.\\u003C/p> \\u003Ch3 id=\\"mechanical\\" data-svelte-h=\\"svelte-1711hpb\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#mechanical\\">\\u003Cspan>\\u003C/span>\\u003C/a>Mechanical\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-kjgvgv\\">I’ve been trying to find an interesting angle to use when writing about mechanical design, but the best I can do is 1.5º - that’s the draft angle applied to the edge of the chassis, to ensure that it’s possible to remove it from the casing. It’s not actually that interesting. What was more interesting was the sheer complexity of the design I ended up with; I’ve been working with 3D modelling and 3D printing for several years now, but this was by far the most complicated design I’ve attempted. As is, I think, often the case, a lot of the complexity came from a desire for outward simplicity: I really wanted the body of the main unit to be visually simple, and as compact as possible. This meant trying to pack the internal components together quite tightly, and minimising the number of features that would be visible on the bottom or sides of the unit. Whether I was successful in this will become more apparent later on (spoiler: not really, in my opinion), but let’s walk through the initial design first to understand where the gremlins were hiding.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-13tues7\\">From the rough block diagram above, it’s clear that we have three main parts that need to be held in relation to each other, and also protected from pokey fingers. These are the mains PCB, the control PCB and the motor. Whatever we end up doing about a winch will be attached to the motor shaft, so that doesn’t really need too much thought. It would also be a good thing if all the parts stay firmly attached to the ceiling during use: the motor and brake assembly weighs just under 1kg, so I’m quite keen to avoid it falling on anyone’s head. However, it also needs to be possible to remove the unit for maintenance (and inevitable debugging).\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-zs177w\\">My thinking converged on attaching the motor to a rigid chassis, that would interlock with a mounting plate that would be screwed to the ceiling. A latch would be provided to ensure that these two parts couldn’t accidentally cease to be interlocked. The chassis would also allow us to use screws to attach an outer casing to the chassis, without these being visible once the unit was mounted. Neat. It was here that I made my first big mistake: because the casing would be quite deep, I thought it would be a good idea to have the PCBs simply slot into it from above. These could then be secured by the chassis, which could remain quite thin - and also wouldn’t have to have any protuberances on its lower surface. This appealed to me, on the basis of being easy to print without supports.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-a518tl\\">In retrospect, I should have attached the PCBs to the chassis, not the casing. It would have vastly simplified the process of assembly, and made the workings much easier to debug. That would have been much more useful than the saving in plastic achieved by having a thin chassis. A useful lesson for next time.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1nb5592\\">Anyway, this discussion would be much easier to follow with pictures, so let’s see some:\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-float.png\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Cp data-svelte-h=\\"svelte-1ayhkdc\\">These are the main parts. Oh, I should probably point out that I used the \\u003Cem>excellent\\u003C/em> OnShape for all this: it’s an absolute pleasure to use, compared to all the other CAD systems I’ve tried. I know I’m only scratching the surface of its capabilities, but just getting the basics absolutely right makes it infinitely less frustrating than, say, Fusion 360. Without it, this process would have felt a lot like \\u003Cem>work\\u003C/em>, rather than something I’m doing for fun. Anyway, those parts look rather lost, just floating in space, so here’s an early version of the chassis:\\u003C/p> \\u003Ch3 id=\\"early-chassis\\" data-svelte-h=\\"svelte-1puldsx\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#early-chassis\\">\\u003Cspan>\\u003C/span>\\u003C/a>Early chassis\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-we8orh\\">The finger-type arrangement in the middle is intended to interlock with the mounting plate, which looks like this:\\u003C/p> \\u003Ch3 id=\\"early-mounting-plate\\" data-svelte-h=\\"svelte-1a0stai\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#early-mounting-plate\\">\\u003Cspan>\\u003C/span>\\u003C/a>Early mounting plate\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-y9rra4\\">The mounting plate attaches to the ceiling via the screw holes (I provided several, as you never know what you’re going to hit), and can be lined up neatly using the alignment notches. The lambda-shaped clip on the chassis engages with the mounting plate, making sure that the two parts can’t be separated unless you depress the clip with a suitable tool. The rest of the features are mainly an attempt at cable management, which would later undergo heavy revision so I won’t waste time on them now.\\u003C/p> \\u003Ch4 id=\\"on-winches\\" data-svelte-h=\\"svelte-1mqjmu6\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#on-winches\\">\\u003Cspan>\\u003C/span>\\u003C/a>On winches\\u003C/h4> \\u003Cp data-svelte-h=\\"svelte-4deim4\\">There’s surprisingly little material available on the Internet on the subject of winch design, so I had to tackle things largely from first principles. As such, I made an interesting series of mistakes, and would take a fundamentally different approach if I were to tackle this design again. The first challenge was to securely attach the cable to the drum. Tight bends are bad for braided cables, so I started by forming a cylinder and then providing a hole in this through which the cable would be led to an attachment point inside the cylinder. The end of the cable would be formed into a loop using a crimp-on ferrule, and then slipped over a cunningly-shaped mounting post that would hold it in position. The post doesn’t have to be massively strong, as there would always be a few turns of cable on the drum in use, and the friction between these turns and the drum itself would provide the holding force rather than the post itself - but even so, I tried to make it as solid as possible.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1vdrxzj\\">Another concern was to try to make the cable wind neatly onto the drum, particularly to avoid it all bunching up on top of itself. Received wisdom seems to be that this is best tackled in the first layer by shaping grooves into the drum for the cable to spiral into. I wasn’t sure how effective this would be, but spent a fun afternoon on it anyway, coming up with a design that subtracted a swept helical tube from the surface of the cylinder to form a nice spiral groove (with appropriate lead-in and lead-out). Add some flanges at either end of the drum to prevent the cable slipping off, and we’re pretty much done:\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-drum.png\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Ch4 id=\\"other-mechanical-bits\\" data-svelte-h=\\"svelte-1j1fhaf\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#other-mechanical-bits\\">\\u003Cspan>\\u003C/span>\\u003C/a>Other mechanical bits\\u003C/h4> \\u003Cp data-svelte-h=\\"svelte-127l3tl\\">As mentioned previously, we need to know when the lamp fitting has been winched to the top of its travel, to provide a reference point from which to calculate distances, and also to stop the motor smashing the lamp into the main unit with catastrophic results. This is one of the parts that actually iterated pretty rapidly between mechanical and electronic design, but I’ll discuss it here to avoid jumbling up the narrative too much. Basically, the idea was that the cable would exit the casing through a narrow slot, aligned to be tangential to the edge of the drum. The area surrounding the slot would be hinged, such that if anything larger than the cable impacted this area it would pivot in such a way as to depress a microswitch on the PCB. As the cable slot is on a centre-line of the casing and the control PCB is all the way over on the edge, this necessitated a lever, pusher and switch arrangement that ends up reminding me vaguely of the hammer, stirrup and anvil of the human ear:\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-limit.png\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Cp data-svelte-h=\\"svelte-1cobpii\\">Fitting this into the casing involved a bit of fiddling around with the internal bulkhead (which was there to make sure that the steel cable cannot come into contact with any mains-voltage parts, as well as providing rigidity), but apart from that the casing design was, as a first attempt, reasonably straightforward. Honest.\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-assembly.png\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Ch3 id=\\"early-casing\\" data-svelte-h=\\"svelte-1b02c9i\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#early-casing\\">\\u003Cspan>\\u003C/span>\\u003C/a>Early casing\\u003C/h3> \\u003Cp data-svelte-h=\\"svelte-pjblk4\\">The flex exits from the centre of the bottom face, secured internally by a strain-relief clamp, and the casing as a whole (including the PCBs) is attached to the chassis using brass screw-thread inserts. These are very easy to use (just heat them up with a soldering iron and push them in), and provide a secure mechanical connection; I’ll be using them again in future.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-abmy1x\\">With that, \\u003Cem>in theory\\u003C/em>, the mechanical design was done. In practice… read on. But first, let’s turn to firmware.\\u003C/p> \\u003Ch2 id=\\"firmware\\" data-svelte-h=\\"svelte-vujhel\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#firmware\\">\\u003Cspan>\\u003C/span>\\u003C/a>Firmware\\u003C/h2> \\u003Cp data-svelte-h=\\"svelte-q8ajgi\\">It turns out that those who assured me that the ESP32 is as capable a platform for embedded development as Electric Imp were… just. plain. wrong. Comparatively speaking, it’s a dog. Don’t get me wrong, it’s a very capable device, and all the pearl-clutching about its potential security vulnerabilities is \\u003Cem>probably\\u003C/em> spurious, and of course it’s very cheap, but… the developer experience is about as pleasant as trying to prune a rose bush using only a nail file: do-able, but it’s going to hurt.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1oaycpp\\">The fundamental difficulty with developing for the ESP32 is the fabled Gulf of Execution. In simple terms, it takes too bloody long to get feedback after making a change, because deploying new code is something that you really have think about (rather than being incidental and transparent, as it should be). I must admit that I hadn’t done a lot of reading into the specifics of building and deploying code on this platform, which was a mistake. I had naively assumed that things had improved in the decade or so since Electric Imp hit the market, and that people wouldn’t be putting up with having to plug a serial cable into a device that already has on-board WiFi, just to program it. How wrong I was.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1z0xcju\\">I’ll return to this topic (as it is irritating, and I don’t like being reasonable about things that obviously ought to be better), but first a brief digression on languages. There are lots of languages that will target the Xtensa CPU cores used by the ESP32, including, intriguingly, Rust. I like Rust. It’s a bit of a head-scratcher at times, but once you’ve got that head around the borrow-checker, it gives you lots of lovely compile-time guarantees; you can be pretty confident that if your code compiles, it will not only run but probably do what you expect, which is a genuinely confidence-inspiring property. So, my starting point for developing the firmware for the Danglepoise was to set up the toolchain for cross-compilation of Rust from a Mac to an ESP32. This was pretty straightforward.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1awlbgj\\">What was less obvious was the level of support for the various ESP32 peripherals (including, critically, WiFi). Documentation for this was, at the time that I started looking at it, fairly uneven (I know it’s improved since). Further confusion emerged from not knowing whether it was best to go for a bare-metal implementation (\\u003Ccode>#!\[no\_std\]\\u003C/code>, in Rust-speak), or whether to take the resource hit of using the Rust runtime. This is a fairly nuanced decision, and it’s unfortunate that prospective Rust embedded developers have to grapple with it before they’ve had much of a chance to build familiarity with the trade-offs.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1lftmf1\\">In any case, after experimenting with a few different approaches, I ended up being able to get WiFi up and running on a bare-metal ESP32. However, finding higher-level libraries (such as an HTTP server, for example!) that would work without the standard library was deeply frustrating. Again, this has probably improved a lot in the last couple of years, but in any case none of the tooling seemed really set up for deploying new code over-the-air, which I considered to be a show-stopper.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1xjdc0b\\">In the course of reading quite a few pages on the ESP32, it became apparent that there were a lot more people using MicroPython than were using Rust. Large numbers of hobbyists usually bring developer-experience improvements, and I had read of some people successfully using a tool called WebREPL to deploy code to an ESP32 over wifi. Peripheral support also seemed to be extremely good. Now, I’ve used Python a bit in the past (it runs the lighting in my wardrobe, for example, and also the pantry door), and it’s… OK. I don’t really understand why so many people think it essential for machine learning work, and my personal opinion is that significant whitespace is pure evil, but lots of people get along with it so it can’t be too bad.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-rnjo5m\\">After a little more research, it became apparent that an IDE called Thonny (link) was the tool of choice for MicroPython development, mainly because it supports deployment over WebREPL. I spent a bit of time trying to replicate this capability using IntelliJ IDEA (my tool of choice), but it proved to be too much effort for my then-extant levels of motivation - which were fairly low, as I’d hoped to be writing some actual firmware by this point.\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-thonny.png\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Cp data-svelte-h=\\"svelte-ifiy9l\\">After satisfying myself that I could, at last, send code from Thonny to the TinyPICO over-the-air, I wrote a little bit of code to flash the onboard LED on and off, and then started thinking about how to talk to the TMC2208. At this point, the PCBs arrived in the post.\\u003C/p> \\u003Ch2 id=\\"development\\" data-svelte-h=\\"svelte-1rso9vh\\">\\u003Ca class=\\"heading-link\\" title=\\"Permalink\\" aria-hidden=\\"true\\" href=\\"#development\\">\\u003Cspan>\\u003C/span>\\u003C/a>Development\\u003C/h2> \\u003Cp data-svelte-h=\\"svelte-7wkg3b\\">With PCBs, components, first-draft printed parts and a vague idea of how to approach the firmware, there now began many, many months of iterative kerfuffle. Some of this was highly educational. It all took a lot longer than expected. For the sanity of the reader, I’ll try to boil this period down to the key discoveries.\\u003C/p> \\u003Cul data-svelte-h=\\"svelte-1j2bh8a\\">\\u003Cli>The mains PCBs were good, and did what was expected of them as soon as I populated the boards and powered them up (using a 3D-printed box to allow me to switch the motor/lamp supplies separately with a degree of safety). Great.\\u003C/li> \\u003Cli>The control PCBs were more fiddly. They arrived with the surface-mount parts already in place (including that fiddly TMC2208), leaving me to place the through-hole parts by hand. Most of these were easy, apart from the TinyPICO; I had hoped to be able to place blobs of solder under the part and then join it to the PCB using a hot-air gun (basically, a poor-man’s BGA), but the untimely demise of my hot air gun meant that I actually had to solder 20 short pieces of tinned-copper wire to both the part and the board to serve as headers. This was surprisingly fiddly, as the pieces of wire tended to drop out of the holes when you heated the opposite side of the assembly. I developed a technique of cutting the wires long, soldering one end, and then holding the other with a pair of tweezers whilst I soldered the other end, which worked well but was quite time-consuming.\\u003C/li> \\u003Cli>Another problem with the control PCBs was that the TinyPICO didn’t seem to want to talk to the TMC2208 over a serial connection. I could send simple pulses on the STEP and DIR pins, which gives limited control of the motor, and the motor would indeed step appropriately (something of a relief). However, more sophisticated control of the driver for things like setting MicroPlyer parameters, reading error codes and tweaking current limits can only be achieved via a serial link, which initially proved spectacularly uncommunicative. My initial suspicion was that I was sending the wrong checksums, as the motor controller datasheet didn’t go into a lot of detail on exactly how to calculate these. There was some C pseudocode for checksum generation, but it’s always possible that I’d translated this into MicroPython incorrectly. Luckily, Trinamic provide a handy spreadsheet with (among other things) a checksum calculator; once I’d found this, I could feel happy that I’d got the checksums right, but still further confused that I still couldn’t talk to the controller. Eventually, after much probing with the oscilloscope and noticing that the transmitted serial voltages looked a bit weak at the controller end of the connection, I realised that a resistor was in the wrong place: the TMC2208 uses a single pin for both transmit and receive, so if you’re attaching this to two separate UART pins it’s good practice to put a 1k resistor in the receive line. I’d put it in the transmit line by mistake, which was attenuating the signal. After some fine work with a microscope and a scalpel, I moved the resistor to the right place and data began to flow. I’d have to repeat this procedure on each of the control boards.\\u003C/li> \\u003Cli>With more nuanced control of the motor now working, I could start tuning the motion parameters. Quite rapidly, this led to the realisation that a push-fit drum wasn’t going to cut it: the motor shaft gets a bit warm in operation, and printable plastics have a fairly low melting point, so after half an hour of testing the drum would start to slip on the shaft. Amazon were happy to sell me some appropriately-sized motor shaft adaptors in aluminium (at least I assume that they were happy: at the markup they were charging, they should have been), which fixed securely onto the shaft with a grub screw and then could be screwed into the (redesigned) drum.\\u003C/li> \\u003Cli>The limit switch mechanism needed a few tweaks, including (critically) the application of grease to the little push rod that goes between the lever and the microswitch. The mounting points for the lever also needed some adjustment, to make sure they didn’t pop out if pushed too hard.\\u003C/li> \\u003Cli>While implementing the limit switch logic (MicroPython has interrupt handlers: hooray!), it became apparent that getting code to the TinyPICO over the air was a little bit flaky. Transfers would sometimes abort part-way, needing a reset of the device, and very occasionally they’d leave it in an inconsistent state that had to be overwritten over the USB-C connection. Not too troublesome while everything was in parts on the bench, but… worrying.\\u003C/li> \\u003Cli>Speaking of parts… getting some of them together proved fiddly. The limit switch parts need to be assembled with pliers, because I can’t get my hands into the tiny gap between the casing and the bulkhead. Sliding the PCBs into their guide slots \\u003Cem>usually\\u003C/em> worked well, but sliding them out again could result in bent pins if the two PCBs skewed relative to each other. Which they were likely to do, as the mains PCB has some fairly stiff wires attached to it, which apply noticeable torque. Getting these wires to stay where they’re meant to be is also non-trivial, especially when trying to close up the unit (they tended to get caught on things you can’t quite see and don’t have enough fingers to poke back into place). Another good argument for not putting the PCBs in the wrong half of the box, really.\\u003C/li> \\u003Cli>The TinyPICO has a little LED to show when it’s charging. When it’s running from a 5V supply, it just shows that it has power, which is not particularly helpful. I must have imagined reading that there was a PCB trace on the TinyPICO that could be cut to disable this, but there isn’t. Tiny slivers of electrical tape provided a partial solution, but the best fix turned out to be a dab of Sugru.\\u003C/li> \\u003Cli>With all the parts fitted together, I rigged up a temporary mounting rig in the shed so that I could develop the firmware some more. The first order of business was to get a web server running, so that commands could be sent to the Danglepoise remotely. This wasn’t particularly hard, but did reveal a couple more code deployment issues, one minor, one less so. The tedious-but-not-particularly-significant one is that using a library in MicroPython means remembering to copy the file to the target device manually (and getting the name right). This is a one-off activity, so it’s merely clunky, but it’s not very polished. A bigger problem is that running a web server \\u003Cem>really\\u003C/em> impedes the performance of the WebREPL: file transfer failures became even more common, and it was also frequently impossible to halt the device so that new code could be executed. This basically rendered it impossible to deploy over-the-air, meaning a revision to the casing so that I could get access to the TinyPICO to plug in the USB cable. Disappointing. The ESP32 really does seem to be lacking some quality-of-life features.\\u003C/li> \\u003Cli>Talking of the casing, revisions to this started to take quite a lot of time: it’s a tall part, and I wanted a reasonably fine finish, so it ended up taking around 12 hours per print. I probably got through about 2.5kg of filament over the course of the project, mainly on the casings. Incidentally, I used PETG for the casing, as it has a \\u003Cem>slightly\\u003C/em> higher melting point and is somewhat impact-resistant compared to PLA.\\u003C/li> \\u003Cli>Now onto the biggest mechanical problem: persuading the cable to stay in the right place. Under tension, the cable stays neatly and tidily coiled around the drum. If, however, you even think about letting it go slack at any point, it will jump off the drum and wind itself around the nearest obstruction (usually the motor shaft). You may not discover this until you next move the motor, at which point it will seize up and probably make some very unpleasant noises. Assembling the casing is a two-handed process, so the “proper” technique (developed after \\u003Cem>many\\u003C/em> issues with immovable winches) is to put something heavy on the cable, drape it off the end of the workbench, and then be very very careful to only move the chassis and casing in such a way as to maintain the tension in the cable. This is, to put it mildly, a faff. Some kind of brake mechanism acting directly on the cable would be a much better idea, as well as being potentially lighter, quieter and less current-thirsty than the solenoid brake on the motor shaft. Something to think about for next time.\\u003C/li> \\u003Cli>When it came to actually attaching a unit to the ceiling, a couple of things became apparent. Firstly, there was nowhere near enough clearance to get the actual mains cables on the supply side to lay flat. If they don’t lay flat, there’s no way to get the interlocking fingers to engage, and so no way to attach the unit to the ceiling. The best place to discover this is definitely not at the top of a step ladder, where it gets surprisingly warm (thermal stratification in action!). The second discovery was that the “easy to use” push-fit mains connectors I’d chosen were anything but: they’re surprisingly tall, require quite a lot of force and are prone to losing the little actuator-lever mouldings that are the only safe way of disconnecting them. A redesign of the printable parts addressed the first discovery, but not the latter, which remains awkward.\\u003C/li> \\u003Cli>RCBOs are generally a good idea, but don’t like sharing a neutral, for what turn out to be perfectly obvious reasons when you actually stop and think about them. Some small (supply-side) electrical adjustments were necessary before I could power up the lamps.\\u003C/li> \\u003Cli>I got quite a long way into the development process before melting my first unit. Eeek. It wasn’t a \\u003Cem>catastrophic\\u003C/em> melting, but it was worrying. By this point, I was happy to leave the units powered up and waiting for commands. They could be driven up and down, and after moving, would release the solenoids and enter a low-power state. That is, they’d do that \\u003Cem>most\\u003C/em> of the time, but not always. It turned out that every now and then, for reasons that are probably due to the accumulation of floating-point errors, the motion-control algorithm would fail to converge to a zero-velocity state. This would leave the solenoid powered up. Leaving the solenoid powered up for too long causes meltiness. Not having a temperature sensor near to the solenoid was probably a mistake; the ones on the control board weren’t very sensitive to the temperature of the brake, so I didn’t really have a good reading on how hot it actually got in operation. In retrospect, the fact that the solenoid had high-temperature-rated wiring was probably a clue. A revised belt-and-braces run-time accumulation algorithm was added to the firmware, ensuring that the solenoid could never be energised for more than five minutes without having a chance to cool down.\\u003C/li> \\u003Cli>The solenoid also, it should be noted, makes quite a loud clacking noise when changing state. The firmware thus tries to avoid doing so too often, which is of course in tension with the need to keep it cool. Again, I think that better braking arrangements would be something to look at if I were tackling this again.\\u003C/li> \\u003Cli>We found some nice light bulbs in Heal’s.\\u003C/li>\\u003C/ul> \\u003Cp data-svelte-h=\\"svelte-15tl7it\\">Apart from these mechanical discoveries, most of the rest of the development process consisted of gradually refining the firmware. It ended up being around 700 lines of MicroPython (not including libraries), with a few mildly-interesting features;\\u003C/p> \\u003Cul data-svelte-h=\\"svelte-1uidwze\\">\\u003Cli>PID motor velocity control, with asymmetric up/down acceleration limits (we can accelerate the lamps upward at 0.5G, and drop them at 1G, up to the speed limit of the motor).\\u003C/li> \\u003Cli>Odometric position control, referenced to the limit switch. The units wind the lamps up until the limit is hit at power-up, and then keep track of where they think they are based on a velocity x time integration function. This works surprisingly well, though errors do eventually creep in, so after 20 cycles they wait until an upward movement is requested and then deliberately drive all the way to the limit switch again, re-calibrating the odometry.\\u003C/li> \\u003Cli>PWM control of the brake driver, in an attempt to reduce the actuation noise. It helped a \\u003Cem>bit\\u003C/em>.\\u003C/li> \\u003Cli>Multiple motion-control regimes: “manual” (which just goes where it’s put), freewheel (useful for un-tangling things, or getting the drum to the right position to access the grub screw that holds it onto the shaft), and two more useful ones:\\n\\u003Cul>\\u003Cli>Function mode, which tries to move the lamp to a position determined by a mathematical function passed in as a request parameter. There are two variables provided to the function, one for time since entry to this mode, and one for the current unit ID. The upshot of this is that you can pass in something like \\u003Ccode>-500+(200\*math.sin((math.pi\*(n+1)/3)+2\*math.pi\*t/1000/40))\\u003C/code>, and get a nice rippling sine-wave effect.\\u003C/li> \\u003Cli>Seek mode, which is where the units spend most of their time. A position is specified (in millimetres, with down being negative), and then either an acceleration or a time budget provided. Given a time budget, the control algorithms will then move the lamp with the minimum possible acceleration needed to move from where it is to where it needs to be in the given time. If the movement can’t be made in the given time, it’ll go as fast as it can (up to the acceleration/velocity limits) and just take longer. This involved some quite enjoyable GCSE-level maths.\\u003C/li>\\u003C/ul>\\u003C/li> \\u003Cli>The units subscribe to an MQTT topic, over which commands can be delivered (simultaneously, though all commands allow a delay based on unit ID so that a pleasing ripple effect can be achieved). They report telemetry back on a separate topic, which is how I know that they’ve collectively travelled 1,930m as of this writing.\\u003C/li> \\u003Cli>The TinyPICO’s Dotstar RGB LED is used to provide a status indicator: white while the unit is booting, a blue flash to show when an MQTT command is received, yellow whenever the solenoid is active (added after the melting incident), and flashing red when an error occurs or a thermal cutout is triggered. These states are also reported on the telemetry topic.\\u003C/li> \\u003Cli>Auxiliary functions exist for setting the cable length and height offset, as these are not the same for each unit. Values are persisted to NVRAM, so they only need setting once. These values are used to ensure that the cable is never over-extended, and to make sure the lamps can be positioned relative to a common reference height even though they’re attached to the ceiling at different altitudes.\\u003C/li> \\u003Cli>MicroPython doesn’t really do multi-tasking, so the HTTP and MQTT servers take variable chunks of time out of the main control loop’s time budget. In other words, the control loop can’t rely on being isochronous, and has to time itself and adjust velocity/position estimates accordingly. This isn’t a feature, it just made all the PID code a bit more fiddly.\\u003C/li>\\u003C/ul> \\u003Cp data-svelte-h=\\"svelte-15r5zl4\\">The most recent version of the firmware was uploaded to the devices around two months ago (I know I’ve waffled on about this enough already, but… deployment should not require a step-ladder!). Since then, the units have been through a couple of power cuts, but have otherwise been powered up continuously. They have behaved extremely well, now that I’ve exorcised the gremlins listed above; they smoothly and un-fussily descend on command, usually to appreciative noises from any guests that we happen to be showing off to. I’ve integrated the MQTT topic with our home control software (which definitely needs another blog post at some point), so anyone in the house can drive the Danglepoise from their phone or from the nice Clipsal wall-switches in the dining room.\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-1hx6oab\\">They look quite nice over the new table, too.\\u003C/p> \\u003Cimg src=\\"/images/posts/dangle-install.jpg\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Cimg src=\\"/images/posts/dangle-hung.jpg\\" loading=\\"lazy\\" decoding=\\"async\\" class=\\"svelte-1ykl0dj\\"> \\u003Ciframe width=\\"720\\" height=\\"480\\" src=\\"https://www.youtube.com/embed/9KLN\_rjoC-c?si=vqnYUlWdZlVG-bPQ\\" title=\\"YouTube video player\\" frameborder=\\"0\\" allow=\\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\\" referrerpolicy=\\"strict-origin-when-cross-origin\\" allowfullscreen>\\u003C/iframe> \\u003Cp>\\u003C/p> \\u003Ciframe width=\\"720\\" height=\\"480\\" src=\\"https://www.youtube.com/embed/2yg1l-j4NbU?si=4J8kfBrXLKnhSVg3\\" title=\\"YouTube video player\\" frameborder=\\"0\\" allow=\\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\\" referrerpolicy=\\"strict-origin-when-cross-origin\\" allowfullscreen>\\u003C/iframe> \\u003Cp data-svelte-h=\\"svelte-qtnsru\\">I’m still experimenting with different positions, speeds, and combinations of lamps; there are lots of options, and they’re fun to play with. I’ve built some pre-set patterns into the control software, but being able to fine-tune the lighting based on what we’re doing at the table, whether it’s extended or not, and how many people are seated is surprisingly good fun. At some point, I’ll probably build a proper UI for it so that each lamp can be simply dragged into position on your phone… or possibly even a physical control panel using motorised sliders… hmmm, now there’s a project…\\u003C/p> \\u003Cp data-svelte-h=\\"svelte-rzbrnr\\">Overall, I’m pleased with how the Danglepoise turned out. I learned a lot, which was fun, and they achieved the desired effect that I was reaching for at the outset. I do have a slight urge to tackle some of the problems encountered above, but it can wait for a while. A few people who’ve seen it have been kind enough to suggest that there might be a market for such a light fitting; I shall have to do more research into this. The idea of a Kickstarter has been mooted. If you think that the world is quite silly enough without such extravagance, do reach out on Mastodon and let me know.\\u003C/p> \\u003Cdiv class=\\"socials svelte-t4kqcq\\">\\u003Ca href=\\"https://mastodon.social/@draazon\\" target=\\"\_blank\\" rel=\\"me noreferrer\\" title=\\"Say Hi on Mastodon\\" class=\\"svelte-t4kqcq\\">\\u003Csvg clip-rule=\\"evenodd\\" fill-rule=\\"evenodd\\" stroke-linejoin=\\"round\\" stroke-miterlimit=\\"2\\" viewBox=\\"0 0 192 192\\" xmlns=\\"http://www.w3.org/2000/svg\\">\\u003Cpath clip-rule=\\"evenodd\\" d=\\"m2004.3 228h-.57c-19.87.163-38.97 2.491-50.13 7.601-.5.213-24.58 10.78-24.58 46.99 0 7.394-.14 16.236.09 25.612.4 16.438 2 32.742 7.21 45.957 5.67 14.406 15.47 25.335 32.04 29.72 14.11 3.737 26.23 4.503 35.99 3.967h.01c18.41-1.021 28.71-6.695 28.71-6.695a6.018 6.018 0 0 0 3.16-5.558l-.56-12.178a5.984 5.984 0 0 0 -2.56-4.646 5.995 5.995 0 0 0 -5.24-.804s-11.04 3.471-23.45 3.047c-4.87-.167-9.84-.357-14.18-1.544-3.91-1.069-7.14-3.148-8.76-7.347 5.59.951 13.45 2.021 22.27 2.425 10.49.481 20.33-.592 30.33-1.785 12.37-1.477 23.76-6.688 31.4-13.091 5.8-4.865 9.47-10.509 10.5-15.801v-.001c3.23-16.623 3.05-40.428 3.04-41.319-.01-36.286-24.23-46.801-24.58-46.951-11.14-5.105-30.25-7.436-50.14-7.599zm59.9 93.58.09-.471c3.1-15.948 2.73-38.451 2.73-38.451v-.067c0-27.633-17.49-36.04-17.49-36.04-.01-.008-.03-.016-.05-.024-10.05-4.616-27.33-6.379-45.26-6.527h-.41c-17.93.148-35.2 1.911-45.25 6.527l-.06.024s-17.48 8.407-17.48 36.04c0 7.308-.15 16.047.09 25.314v.004c.36 14.96 1.64 29.826 6.37 41.852 4.27 10.836 11.49 19.221 23.95 22.519 12.65 3.349 23.51 4.066 32.26 3.585 9.61-.533 16.56-2.512 20.36-3.891l-.04-.739c-5.11 1.018-12.33 2.033-20 1.771-16.29-.559-32.69-3.029-35.34-23.016a40.2 40.2 0 0 1 -.35-5.4 6 6 0 0 1 2.3-4.719 5.998 5.998 0 0 1 5.13-1.109s12.59 3.066 28.55 3.798c9.81.45 19.01-.598 28.36-1.713 9.88-1.18 19.01-5.258 25.11-10.372 3.36-2.814 5.83-5.834 6.43-8.895zm-54.2-36.244c.68-2.603 3.99-12.807 14.27-12.807 10.68 0 10.54 12.137 10.54 12.137v34.224c0 3.311 2.69 6 6 6s6-2.689 6-6v-34.406s-.68-23.955-22.54-23.955c-10 0-16.43 5.292-20.4 10.778-4.07-5.273-10.62-10.293-20.78-10.293-6.92 0-11.53 2.138-14.68 4.857-6.67 5.747-6.86 14.826-6.81 16.949l.02.455s-.01-.161-.02-.455v-.052 36.342c0 3.311 2.69 6 6 6s6-2.689 6-6v-36.342c0-.169-.01-.338-.02-.507 0 0-.5-4.577 2.66-7.298 1.45-1.252 3.66-1.949 6.85-1.949 10.65 0 14.18 9.844 14.91 12.386v20.233c0 3.311 2.69 6 6 6s6-2.689 6-6z\\" fill-rule=\\"evenodd\\" stroke-linejoin=\\"round\\" stroke-miterlimit=\\"2\\" transform=\\"translate(-1908 -212)\\">\\u003C/path>\\u003C/svg>\\u003C/a> \\u003Ca href=\\"https://github.com/gbsallery\\" target=\\"\_blank\\" rel=\\"noopener noreferrer\\" title=\\"See my GitHub profile\\" class=\\"svelte-t4kqcq\\">\\u003Csvg width=\\"100%\\" height=\\"100%\\" stroke-width=\\"1.5\\" viewBox=\\"0 0 24 24\\" fill=\\"none\\" xmlns=\\"http://www.w3.org/2000/svg\\">\\u003Cpath d=\\"M16 22.0268V19.1568C16.0375 18.68 15.9731 18.2006 15.811 17.7506C15.6489 17.3006 15.3929 16.8902 15.06 16.5468C18.2 16.1968 21.5 15.0068 21.5 9.54679C21.4997 8.15062 20.9627 6.80799 20 5.79679C20.4558 4.5753 20.4236 3.22514 19.91 2.02679C19.91 2.02679 18.73 1.67679 16 3.50679C13.708 2.88561 11.292 2.88561 8.99999 3.50679C6.26999 1.67679 5.08999 2.02679 5.08999 2.02679C4.57636 3.22514 4.54413 4.5753 4.99999 5.79679C4.03011 6.81549 3.49251 8.17026 3.49999 9.57679C3.49999 14.9968 6.79998 16.1868 9.93998 16.5768C9.61098 16.9168 9.35725 17.3222 9.19529 17.7667C9.03334 18.2112 8.96679 18.6849 8.99999 19.1568V22.0268\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003Cpath d=\\"M9 20.0267C6 20.9999 3.5 20.0267 2 17.0267\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003C/svg>\\u003C/a> \\u003Ca href=\\"https://www.linkedin.com/in/gbsallery/\\" target=\\"\_blank\\" rel=\\"noopener noreferrer\\" title=\\"Connect on LinkedIn\\" class=\\"svelte-t4kqcq\\">\\u003Csvg width=\\"100%\\" height=\\"100%\\" stroke-width=\\"1.5\\" viewBox=\\"0 0 24 24\\" fill=\\"none\\" xmlns=\\"http://www.w3.org/2000/svg\\">\\u003Cpath d=\\"M21 8V16C21 18.7614 18.7614 21 16 21H8C5.23858 21 3 18.7614 3 16V8C3 5.23858 5.23858 3 8 3H16C18.7614 3 21 5.23858 21 8Z\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003Cpath d=\\"M7 17V13.5V10\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003Cpath d=\\"M11 17V13.75M11 10V13.75M11 13.75C11 10 17 10 17 13.75V17\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003Cpath d=\\"M7 7.01L7.01 6.99889\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003C/svg>\\u003C/a> \\u003Ca href=\\"email\\" rel=\\"noopener noreferrer\\" title=\\"Send an email\\" class=\\"svelte-t4kqcq\\">\\u003Csvg width=\\"100%\\" height=\\"100%\\" stroke-width=\\"1.5\\" viewBox=\\"0 0 24 24\\" fill=\\"none\\" xmlns=\\"http://www.w3.org/2000/svg\\">\\u003Cpath d=\\"M7 9L12 12.5L17 9\\" stroke=\\"currentColor\\" stroke-linecap=\\"round\\" stroke-linejoin=\\"round\\">\\u003C/path>\\u003Cpath d=\\"M2 17V7C2 5.89543 2.89543 5 4 5H20C21.1046 5 22 5.89543 22 7V17C22 18.1046 21.1046 19 20 19H4C2.89543 19 2 18.1046 2 17Z\\" stroke=\\"currentColor\\" stroke-width=\\"1.5\\">\\u003C/path>\\u003C/svg>\\u003C/a>\\u003C/div> \\u003Cp data-svelte-h=\\"svelte-1nt7oph\\">\\u003Ca href=\\"https://sallery.co.uk\\" rel=\\"nofollow\\">Home\\u003C/a>\\u003C/p>",readingTime:"41 min read",relatedPosts:\[\]}},"uses":{"url":1}},null\]; Promise.all(\[ import("./\_app/immutable/entry/start.B9FNdROt.js"), import("./\_app/immutable/entry/app.DL-0qmVB.js") \]).then((\[kit, app\]) => { kit.start(app, element, { node\_ids: \[0, 2, 5\], data, form: null, error: null }); }); }

---

# Reference Huffman coding

*Source: <https://www.nayuki.io/page/reference-huffman-coding>*
*Published: 2025-04-23T09:05:20.000Z*

# [Project Nayuki](/)

## Navigation

*   [Recent](/recent-pages/)
*   [Programming](/category/programming)
*   [Math](/category/math)
*   [Random](/page/unsigned-int-considered-harmful-for-java "Page: Unsigned int considered harmful for Java")

*   [About/Contact](/page/about)
*   [GitHub](https://github.com/nayuki)

* * *

# ![](/res/page-icon/64/reference-huffman-coding.png) Reference Huffman coding

This project is a clear implementation of Huffman coding, suitable as a reference for educational purposes. It is provided separately in Java, Python, and C++, and is open source (MIT License).

The code can be used for study, and as a solid basis for modification and extension. Consequently, the codebase optimizes for readability and avoids fancy logic, and does not target the best speed/memory/performance.

## Source code ![](/res/common/download-icon.svg)

The files in this project are available in Git repositories:

Web host

Browse files

Download package

**GitHub (primary)**

**[Browse files ![](/res/common/github-icon.svg)](https://github.com/nayuki/Reference-Huffman-coding)** 

[Download ZIP](https://github.com/nayuki/Reference-Huffman-coding/archive/master.zip)

GitLab (mirror)

[Browse files](https://gitlab.com/Nayuki/Reference-Huffman-coding)

[Download ZIP](https://gitlab.com/Nayuki/Reference-Huffman-coding/-/archive/master/Reference-Huffman-coding-master.zip)

## Overview

Huffman encoding takes a sequence (stream) of symbols as input and gives a sequence of bits as output. The intent is to produce a short output for the given input. Each input yields a different output, so the process can be reversed, and the output can be decoded to give back the original input.

In this software, a symbol is a non-negative integer. The symbol limit is one plus the highest allowed symbol. For example, a symbol limit of 4 means that the set of allowed symbols is {0, 1, 2, 3}.

### Submodules

[![Submodule dependency graph](/res/reference-huffman-coding/submodule-dependency-graph.svg)](/res/reference-huffman-coding/submodule-dependency-graph.svg)

Sample applications

Two pairs of command-line programs fully demonstrate how this software package can be used to encode and decode data using Huffman coding. One pair of programs is the classes [`HuffmanCompress`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/HuffmanCompress.java?ts=4) and [`HuffmanDecompress`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/HuffmanDecompress.java?ts=4), which implement static Huffman coding. The other pair of programs is the classes [`AdaptiveHuffmanCompress`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/AdaptiveHuffmanCompress.java?ts=4) and [`AdaptiveHuffmanDecompress`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/AdaptiveHuffmanDecompress.java?ts=4), which implement adaptive/dynamic Huffman coding.

Encoder/decoder

The classes [`HuffmanEncoder`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/HuffmanEncoder.java?ts=4) and [`HuffmanDecoder`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/HuffmanDecoder.java?ts=4) implement the basic algorithms for encoding and decoding a Huffman-coded stream. The code tree must be set before encoding or decoding. The code tree can be changed after encoding or decoding each symbol, as long as the encoder and decoder have the same code tree at the same position in the symbol stream. At any given time, the encoder must not attempt to encode a symbol that is not in the code tree.

[![Code tree model](/res/reference-huffman-coding/code-tree-model.svg)](/res/reference-huffman-coding/code-tree-model.svg)

Huffman code tree

The class [`CodeTree`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/CodeTree.java?ts=4), along with [`Node`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/Node.java?ts=4), [`InternalNode`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/InternalNode.java?ts=4), and [`Leaf`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/Leaf.java?ts=4), represent a Huffman code tree. The leaves represent symbols. The path to a leaf represents the bit string of its Huffman code.

Frequency table

The class [`FrequencyTable`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/FrequencyTable.java?ts=4) wraps over a simple integer array to count symbol frequencies. It is also responsible for generating a Huffman code tree that is optimal for its current array of frequencies (but not necessarily canonical).

Canonical codes

The class [`CanonicalCode`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/CanonicalCode.java?ts=4) converts an arbitrary `CodeTree` to a [canonical code](https://en.wikipedia.org/wiki/Canonical_Huffman_code "Wikipedia: Canonical Huffman code"). It can then generate a `CodeTree` for the canonical code.

Bitwise I/O streams

The classes [`BitInputStream`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/BitInputStream.java?ts=4) and [`BitOutputStream`](https://github.com/nayuki/Huffman-Coding/blob/master/java/src/BitOutputStream.java?ts=4) are bit-oriented I/O streams, analogous to the standard bytewise I/O streams. However, since they use an underlying bytewise I/O stream, the bit stream’s total length is always a multiple of 8 bits.

Test suite

A JUnit [test suite](https://github.com/nayuki/Reference-Huffman-coding/tree/master/java/test) checks that compressing and decompressing an arbitrary byte sequence will give back the same byte sequence. This is done on short, simple sequences and on longer random sequences. The test suite checks the 4 main programs mentioned above (`HuffmanCompress`, etc.).

Other languages

The Python and C++ versions of this library were ported from the Java version. They contain all the core functionality provided by the Java version, but not some of the extended features or verbose documentation comments. The API naming and semantics follow the Java version, unless the target language has a more idiomatic way of doing things (e.g. underscore names and native bigint in Python). All language versions encode and decode exactly the same data. For example, it is acceptable to encode a file using HuffmanCompress.java and then decode it using huffman-decompress.py.

## Limitations

*   The code is optimized for understandability, not performance. For example, the Java `CodeTree` uses memory grossly inefficiently to store the code bit string for each symbol. It uses `ArrayList<Integer>` at a cost of at least 4 bytes per represented bit, instead of packing bits into a primitive integral array type such as `byte[]`.
    
*   `CodeTree`, `FrequencyTable`, and `CanonicalCode` explicitly take a symbol limit as a parameter. This is not strictly required, but the alternative is to use sparse tables, which is more difficult to understand.
    
*   A couple of methods use recursion to traverse a whole code tree. When using such a method on a deep tree, a `StackOverflowError` may be thrown.
    
*   All the Huffman-related code only work with alphabets with up to `Integer.MAX_VALUE` (i.e. 231 − 1) symbols in the Java version, and up to `UINT32_MAX` (i.e. 232 − 1) symbols in the C++ version.
    
*   `FrequencyTable` can only track each symbol’s frequency up to `Integer.MAX_VALUE` in Java and `UINT32_MAX` in C++. Trying to increment a symbol’s frequency beyond this limit raises an exception. However, using frequencies larger than 231 should be rare in practice.
    

## Suggestions

Here are some suggestions on how to use, modify, or extend this software:

*   Extract an interface from the bitwise I/O streams and create other concrete implementation classes.
    
*   Improve the speed of Huffman encoding and decoding. One advanced suggestion is to treat the Huffman decoder as a finite-state machine (FSM) and decode a whole byte per iteration.
    
*   Layer another encoding scheme on top of Huffman coding, such as RLE, LZW, n\-gram models, DCT with quantization, etc. This is essentially how real-world compressed data formats are structured.
    

## More info

*   [Wikipedia: Huffman coding](https://en.wikipedia.org/wiki/Huffman_coding)

Categories: [Programming](/category/programming), [Java](/category/java), [Python](/category/python), [C++](/category/cpp)

Last updated: [2018-06-30](/recent-pages/)

* * *

## Related / browse

*   [Reference arithmetic coding](/page/reference-arithmetic-coding)
*   [Simple DEFLATE decompressor](/page/simple-deflate-decompressor)
*   [Sliding window minimum/maximum algorithm](/page/sliding-window-minimum-maximum-algorithm)
*   [Nintendo 64 over S-video](/page/nintendo-64-over-svideo)
*   [Transcription of Chasse – Instrumental solo](/page/transcription-of-chasse-instrumental-solo)

* * *

## Sidebar

### Recent

[![](/res/page-icon/64/pixel-is-a-unit-of-length-and-area.png)](/page/pixel-is-a-unit-of-length-and-area)

[Pixel is a unit of length and area](/page/pixel-is-a-unit-of-length-and-area)

[![](/res/page-icon/64/hamming-error-correcting-codes.png)](/page/hamming-error-correcting-codes)

[Hamming error-correcting codes](/page/hamming-error-correcting-codes)

[![](/res/page-icon/64/fastcgi-library.png)](/page/fastcgi-library)

[FastCGI library](/page/fastcgi-library)

[![](/res/page-icon/64/calculate-gcd-javascript.png)](/page/calculate-gcd-javascript)

[Calculate GCD (JavaScript)](/page/calculate-gcd-javascript)

[![](/res/page-icon/64/rollercoaster-tycoon-saved-games.png)](/page/rollercoaster-tycoon-saved-games)

[RollerCoaster Tycoon saved games](/page/rollercoaster-tycoon-saved-games)

[(more)](/recent-pages/ "Recent pages")

### Random

[![](/res/page-icon/64/self-encrypted-cache-structure.png)](/page/self-encrypted-cache-structure)

[Self-encrypted cache structure](/page/self-encrypted-cache-structure)

[![](/res/page-icon/64/gif89a-specification-html.png)](/page/gif89a-specification-html)

[GIF89a specification (HTML)](/page/gif89a-specification-html)

[![](/res/page-icon/64/fast-md5-hash-implementation-in-x86-assembly.png)](/page/fast-md5-hash-implementation-in-x86-assembly)

[Fast MD5 hash implementation in x86 assembly](/page/fast-md5-hash-implementation-in-x86-assembly)

[(more)](/page/ "All pages")

### RSS feed

[![](/res/style/rss-feed.svg)](/rss20.xml)

[Subscribe for updates](/rss20.xml)

* * *

**Feedback:** Question/comment? [Contact me](/page/about#contact)

[Copyright © 2025 Project Nayuki](/page/about#copyright "Copyright information")

window.dataLayer=window.dataLayer||\[\]; function gtag(){dataLayer.push(arguments);} gtag("js",new Date()); gtag("config","UA-23532931-1");

---

